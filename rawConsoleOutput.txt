> # most general model
> model1 <- lm(M~M1*M2*M3*M4*W+ I(M1^2)+ I(M2^2)+ I(M3^2)+ I(M4^2))
> summary(model1)

Call:
lm(formula = M ~ M1 * M2 * M3 * M4 * W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-144.24  -54.00  -15.01   46.60  254.17 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)
(Intercept)    3.627e+04  4.744e+04   0.765    0.457
M1            -4.251e+01  3.921e+01  -1.084    0.297
M2            -4.977e+01  7.109e+01  -0.700    0.495
M3            -3.976e+01  5.174e+01  -0.768    0.455
M4            -3.078e+01  5.871e+01  -0.524    0.608
W             -1.594e+03  2.295e+03  -0.695    0.499
I(M1^2)        8.645e-04  1.487e-03   0.582    0.570
I(M2^2)        1.059e-03  2.018e-03   0.525    0.608
I(M3^2)        1.117e-03  2.384e-03   0.469    0.647
I(M4^2)        3.210e-03  2.271e-03   1.413    0.179
M1:M2          5.740e-02  5.729e-02   1.002    0.333
M1:M3          4.753e-02  5.045e-02   0.942    0.362
M2:M3          6.544e-02  5.926e-02   1.104    0.288
M1:M4          4.797e-02  4.940e-02   0.971    0.348
M2:M4          2.071e-02  7.425e-02   0.279    0.784
M3:M4          2.322e-02  5.084e-02   0.457    0.655
M1:W           2.416e+00  2.109e+00   1.146    0.271
M2:W           1.889e+00  3.390e+00   0.557    0.586
M3:W           1.944e+00  2.620e+00   0.742    0.470
M4:W           9.498e-01  2.910e+00   0.326    0.749
M1:M2:M3      -6.843e-05  4.646e-05  -1.473    0.163
M1:M2:M4      -4.483e-05  6.153e-05  -0.729    0.478
M1:M3:M4      -4.384e-05  4.776e-05  -0.918    0.374
M2:M3:M4      -3.160e-05  5.781e-05  -0.547    0.593
M1:M2:W       -2.822e-03  2.912e-03  -0.969    0.349
M1:M3:W       -2.753e-03  2.874e-03  -0.958    0.354
M2:M3:W       -2.863e-03  3.073e-03  -0.932    0.367
M1:M4:W       -2.446e-03  2.567e-03  -0.953    0.357
M2:M4:W       -1.298e-04  3.915e-03  -0.033    0.974
M3:M4:W       -8.125e-04  2.845e-03  -0.286    0.779
M1:M2:M3:M4    4.791e-08  4.497e-08   1.065    0.305
M1:M2:M3:W     3.492e-06  2.629e-06   1.328    0.205
M1:M2:M4:W     1.907e-06  3.214e-06   0.594    0.562
M1:M3:M4:W     2.205e-06  2.842e-06   0.776    0.451
M2:M3:M4:W     7.716e-07  3.209e-06   0.240    0.813
M1:M2:M3:M4:W -2.156e-09  2.581e-09  -0.835    0.418

Residual standard error: 165.8 on 14 degrees of freedom
Multiple R-squared:  0.9331,    Adjusted R-squared:  0.7658 
F-statistic: 5.577 on 35 and 14 DF,  p-value: 0.0006537

> par(mfrow=c(2,2))  # display 4 plots  in 2 rows, 2  columns
> plot(model1)
Warning messages:
1: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
2: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
> par(mfrow = c(1, 1)) #return plot layout to default
> 
> # the five-way interaction M1:M2:M3:M4:Wis not significant -- remove it
> model2 <- update(model1,~.-M1:M2:M3:M4:W)
> summary(model2)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M1:M2:M4:W + 
    M1:M3:M4:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-158.776  -61.941   -8.846   45.232  248.919 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept)  4.120e+03  2.745e+04   0.150    0.883
M1          -1.726e+01  2.471e+01  -0.698    0.496
M2          -5.045e+00  4.628e+01  -0.109    0.915
M3          -1.141e+01  3.865e+01  -0.295    0.772
M4           8.621e+00  3.459e+01   0.249    0.807
W            1.682e+02  8.939e+02   0.188    0.853
I(M1^2)      9.094e-04  1.471e-03   0.618    0.546
I(M2^2)      5.591e-04  1.908e-03   0.293    0.774
I(M3^2)      7.603e-04  2.322e-03   0.327    0.748
I(M4^2)      2.852e-03  2.208e-03   1.292    0.216
M1:M2        1.867e-02  3.329e-02   0.561    0.583
M1:M3        2.638e-02  4.319e-02   0.611    0.551
M2:M3        2.507e-02  3.394e-02   0.739    0.471
M1:M4        1.488e-02  2.922e-02   0.509    0.618
M2:M4       -2.532e-02  4.925e-02  -0.514    0.615
M3:M4       -1.188e-02  2.833e-02  -0.419    0.681
M1:W         8.678e-01  9.947e-01   0.872    0.397
M2:W        -4.149e-01  1.951e+00  -0.213    0.834
M3:W         1.968e-01  1.562e+00   0.126    0.901
M4:W        -1.179e+00  1.391e+00  -0.847    0.410
M1:M2:M3    -3.432e-05  2.193e-05  -1.565    0.138
M1:M2:M4    -3.195e-06  3.570e-05  -0.089    0.930
M1:M3:M4    -1.568e-05  3.348e-05  -0.468    0.646
M2:M3:M4     1.097e-05  2.699e-05   0.406    0.690
M1:M2:W     -6.701e-04  1.344e-03  -0.498    0.625
M1:M3:W     -1.292e-03  2.257e-03  -0.573    0.575
M2:M3:W     -5.804e-04  1.391e-03  -0.417    0.682
M1:M4:W     -5.183e-04  1.113e-03  -0.466    0.648
M2:M4:W      2.294e-03  2.601e-03   0.882    0.392
M3:M4:W      1.291e-03  1.309e-03   0.986    0.340
M1:M2:M3:M4  1.145e-08  1.068e-08   1.072    0.301
M1:M2:M3:W   1.462e-06  9.933e-07   1.472    0.162
M1:M2:M4:W  -4.105e-07  1.604e-06  -0.256    0.801
M1:M3:M4:W   4.092e-07  1.840e-06   0.222    0.827
M2:M3:M4:W  -1.620e-06  1.434e-06  -1.129    0.277

Residual standard error: 164.1 on 15 degrees of freedom
Multiple R-squared:  0.9297,    Adjusted R-squared:  0.7705 
F-statistic: 5.838 on 34 and 15 DF,  p-value: 0.0003478

> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~Removal of 4-Way Interactions~~~~~~~~~~~~~~
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> 
> model3 <- update(model2,~.-M1:M3:M4:W)
> summary(model3)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M1:M2:M4:W + 
    M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-158.22  -64.69   -7.64   44.17  239.65 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept)  4.672e+03  2.651e+04   0.176    0.862
M1          -1.485e+01  2.153e+01  -0.690    0.500
M2          -1.223e+01  3.214e+01  -0.381    0.709
M3          -7.116e+00  3.248e+01  -0.219    0.829
M4           6.734e+00  3.253e+01   0.207    0.839
W            1.416e+02  8.591e+02   0.165    0.871
I(M1^2)      7.125e-04  1.139e-03   0.626    0.540
I(M2^2)      4.671e-04  1.806e-03   0.259    0.799
I(M3^2)      7.279e-04  2.247e-03   0.324    0.750
I(M4^2)      2.801e-03  2.129e-03   1.315    0.207
M1:M2        2.328e-02  2.525e-02   0.922    0.370
M1:M3        1.840e-02  2.334e-02   0.788    0.442
M2:M3        2.768e-02  3.089e-02   0.896    0.383
M1:M4        1.371e-02  2.787e-02   0.492    0.629
M2:M4       -1.684e-02  3.021e-02  -0.557    0.585
M3:M4       -1.491e-02  2.409e-02  -0.619    0.545
M1:W         7.229e-01  7.290e-01   0.992    0.336
M2:W        -4.721e-02  1.005e+00  -0.047    0.963
M3:W        -1.782e-02  1.191e+00  -0.015    0.988
M4:W        -1.079e+00  1.278e+00  -0.845    0.411
M1:M2:M3    -3.355e-05  2.100e-05  -1.598    0.130
M1:M2:M4    -8.621e-06  2.528e-05  -0.341    0.738
M1:M3:M4    -8.750e-06  1.189e-05  -0.736    0.472
M2:M3:M4     7.220e-06  2.044e-05   0.353    0.729
M1:M2:W     -8.756e-04  9.471e-04  -0.925    0.369
M1:M3:W     -8.462e-04  1.004e-03  -0.843    0.412
M2:M3:W     -7.323e-04  1.175e-03  -0.623    0.542
M1:M4:W     -4.271e-04  1.004e-03  -0.425    0.676
M2:M4:W      1.819e-03  1.439e-03   1.264    0.224
M3:M4:W      1.454e-03  1.052e-03   1.382    0.186
M1:M2:M3:M4  1.160e-08  1.034e-08   1.122    0.278
M1:M2:M3:W   1.405e-06  9.300e-07   1.510    0.150
M1:M2:M4:W  -1.243e-07  9.286e-07  -0.134    0.895
M2:M3:M4:W  -1.390e-06  9.649e-07  -1.440    0.169

Residual standard error: 159.2 on 16 degrees of freedom
Multiple R-squared:  0.9295,    Adjusted R-squared:  0.7841 
F-statistic: 6.394 on 33 and 16 DF,  p-value: 0.0001355

> evaluateModel(model3)
[1] 33.03275
> 
> model4 <- update(model3,~.-M1:M2:M4:W)
> summary(model4)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-158.034  -64.387   -6.747   42.924  239.740 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept)  5.831e+03  2.432e+04   0.240    0.813
M1          -1.608e+01  1.888e+01  -0.852    0.406
M2          -1.385e+01  2.891e+01  -0.479    0.638
M3          -5.534e+00  2.936e+01  -0.188    0.853
M4           3.688e+00  2.256e+01   0.164    0.872
W            1.001e+02  7.777e+02   0.129    0.899
I(M1^2)      6.613e-04  1.041e-03   0.635    0.534
I(M2^2)      5.008e-04  1.736e-03   0.288    0.776
I(M3^2)      7.892e-04  2.136e-03   0.370    0.716
I(M4^2)      2.826e-03  2.059e-03   1.373    0.188
M1:M2        2.510e-02  2.063e-02   1.217    0.240
M1:M3        1.684e-02  1.963e-02   0.858    0.403
M2:M3        2.656e-02  2.886e-02   0.920    0.370
M1:M4        1.684e-02  1.477e-02   1.140    0.270
M2:M4       -1.403e-02  2.113e-02  -0.664    0.516
M3:M4       -1.464e-02  2.331e-02  -0.628    0.538
M1:W         7.629e-01  6.455e-01   1.182    0.254
M2:W         9.999e-03  8.824e-01   0.011    0.991
M3:W        -9.300e-02  1.020e+00  -0.091    0.928
M4:W        -9.546e-01  8.508e-01  -1.122    0.277
M1:M2:M3    -3.263e-05  1.927e-05  -1.693    0.109
M1:M2:M4    -1.165e-05  1.098e-05  -1.061    0.304
M1:M3:M4    -9.054e-06  1.133e-05  -0.799    0.435
M2:M3:M4     7.018e-06  1.979e-05   0.355    0.727
M1:M2:W     -9.405e-04  7.897e-04  -1.191    0.250
M1:M3:W     -7.561e-04  7.226e-04  -1.046    0.310
M2:M3:W     -6.737e-04  1.058e-03  -0.637    0.533
M1:M4:W     -5.518e-04  3.614e-04  -1.527    0.145
M2:M4:W      1.707e-03  1.138e-03   1.501    0.152
M3:M4:W      1.443e-03  1.018e-03   1.417    0.174
M1:M2:M3:M4  1.196e-08  9.695e-09   1.233    0.234
M1:M2:M3:W   1.343e-06  7.824e-07   1.716    0.104
M2:M3:M4:W  -1.392e-06  9.364e-07  -1.487    0.155

Residual standard error: 154.5 on 17 degrees of freedom
Multiple R-squared:  0.9294,    Adjusted R-squared:  0.7966 
F-statistic: 6.997 on 32 and 17 DF,  p-value: 4.987e-05

> evaluateModel(model4)
[1] 32.89415
> 
> model5 <- update(model4,~.-M1:M2:M3:M4)
> anova(model5, model4)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     18 442162                           
2     17 405840  1     36322 1.5215 0.2342
> summary(model5)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-198.464  -60.805   -9.029   52.830  234.488 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -1.705e+04  1.596e+04  -1.068    0.299
M1          -8.645e-01  1.450e+01  -0.060    0.953
M2           9.267e+00  2.233e+01   0.415    0.683
M3           1.857e+01  2.223e+01   0.835    0.415
M4           2.310e+01  1.639e+01   1.409    0.176
W            5.816e+02  6.824e+02   0.852    0.405
I(M1^2)      8.526e-04  1.045e-03   0.816    0.425
I(M2^2)      7.390e-04  1.750e-03   0.422    0.678
I(M3^2)     -5.560e-05  2.052e-03  -0.027    0.979
I(M4^2)      1.714e-03  1.878e-03   0.913    0.373
M1:M2        7.365e-03  1.501e-02   0.491    0.630
M1:M3        1.948e-03  1.569e-02   0.124    0.903
M2:M3        8.223e-05  1.957e-02   0.004    0.997
M1:M4        2.074e-03  8.773e-03   0.236    0.816
M2:M4       -2.624e-02  1.894e-02  -1.385    0.183
M3:M4       -3.107e-02  1.941e-02  -1.601    0.127
M1:W         4.194e-01  5.907e-01   0.710    0.487
M2:W        -3.642e-01  8.405e-01  -0.433    0.670
M3:W        -6.239e-01  9.377e-01  -0.665    0.514
M4:W        -1.072e+00  8.576e-01  -1.250    0.227
M1:M2:M3    -1.423e-05  1.238e-05  -1.150    0.265
M1:M2:M4     2.040e-07  5.386e-06   0.038    0.970
M1:M3:M4     2.978e-06  5.842e-06   0.510    0.616
M2:M3:M4     2.218e-05  1.573e-05   1.409    0.176
M1:M2:W     -5.787e-04  7.437e-04  -0.778    0.447
M1:M3:W     -4.968e-04  7.013e-04  -0.708    0.488
M2:M3:W     -7.222e-05  9.523e-04  -0.076    0.940
M1:M4:W     -3.311e-04  3.184e-04  -1.040    0.312
M2:M4:W      1.350e-03  1.116e-03   1.209    0.242
M3:M4:W      1.499e-03  1.031e-03   1.454    0.163
M1:M2:M3:W   9.298e-07  7.174e-07   1.296    0.211
M2:M3:M4:W  -1.260e-06  9.436e-07  -1.335    0.199

Residual standard error: 156.7 on 18 degrees of freedom
Multiple R-squared:  0.9231,    Adjusted R-squared:  0.7907 
F-statistic: 6.972 on 31 and 18 DF,  p-value: 3.46e-05

> evaluateModel(model5)
[1] 25.38585
> 
> model6 <- update(model5,~.-M1:M2:M3:W)
> anova(model5,model6)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     18 442162                           
2     19 483422 -1    -41261 1.6797 0.2113
> anova(model1, model6)
Analysis of Variance Table

Model 1: M ~ M1 * M2 * M3 * M4 * W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2)
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     14 384878                           
2     19 483422 -5    -98544 0.7169 0.6213
> summary(model6)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-201.272  -54.762   -7.417   45.434  270.109 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -1.755e+04  1.624e+04  -1.081    0.293
M1           8.814e+00  1.265e+01   0.697    0.494
M2           1.653e+01  2.200e+01   0.751    0.462
M3           1.912e+01  2.262e+01   0.845    0.408
M4           1.038e+01  1.336e+01   0.777    0.447
W            6.938e+02  6.889e+02   1.007    0.327
I(M1^2)      5.734e-04  1.040e-03   0.551    0.588
I(M2^2)     -6.176e-04  1.428e-03  -0.433    0.670
I(M3^2)     -3.632e-04  2.074e-03  -0.175    0.863
I(M4^2)      1.003e-03  1.828e-03   0.549    0.590
M1:M2       -8.329e-03  9.024e-03  -0.923    0.368
M1:M3       -7.107e-03  1.430e-02  -0.497    0.625
M2:M3       -7.141e-03  1.910e-02  -0.374    0.713
M1:M4        2.862e-03  8.907e-03   0.321    0.751
M2:M4       -1.366e-02  1.655e-02  -0.825    0.420
M3:M4       -1.742e-02  1.659e-02  -1.050    0.307
M1:W        -2.317e-01  3.163e-01  -0.733    0.473
M2:W        -6.793e-01  8.188e-01  -0.830    0.417
M3:W        -8.500e-01  9.376e-01  -0.907    0.376
M4:W        -3.890e-01  6.889e-01  -0.565    0.579
M1:M2:M3     1.099e-06  3.697e-06   0.297    0.770
M1:M2:M4     1.712e-06  5.352e-06   0.320    0.753
M1:M3:M4     5.571e-07  5.634e-06   0.099    0.922
M2:M3:M4     1.108e-05  1.343e-05   0.824    0.420
M1:M2:W      3.353e-04  2.405e-04   1.394    0.179
M1:M3:W      2.109e-04  4.479e-04   0.471    0.643
M2:M3:W      3.766e-04  9.029e-04   0.417    0.681
M1:M4:W     -3.442e-04  3.239e-04  -1.063    0.301
M2:M4:W      5.619e-04  9.526e-04   0.590    0.562
M3:M4:W      8.897e-04  9.341e-04   0.952    0.353
M2:M3:M4:W  -5.890e-07  8.030e-07  -0.734    0.472

Residual standard error: 159.5 on 19 degrees of freedom
Multiple R-squared:  0.9159,    Adjusted R-squared:  0.7832 
F-statistic: 6.901 on 30 and 19 DF,  p-value: 2.574e-05

> evaluateModel(model6)
[1] 24.51948
> 
> model7 <- update(model6,~.-M2:M3:M4:W)
> anova(model6,model7)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     19 483422                          
2     20 497111 -1    -13689 0.538 0.4722
> summary(model7)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-216.50  -64.19   -7.49   47.95  272.55 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -6.866e+03  7.090e+03  -0.968    0.344
M1           6.242e+00  1.201e+01   0.520    0.609
M2           6.227e+00  1.674e+01   0.372    0.714
M3           6.753e+00  1.491e+01   0.453    0.655
M4           2.500e+00  7.859e+00   0.318    0.754
W            2.122e+02  2.061e+02   1.029    0.316
I(M1^2)      2.757e-04  9.468e-04   0.291    0.774
I(M2^2)     -8.470e-04  1.377e-03  -0.615    0.545
I(M3^2)     -5.473e-04  2.035e-03  -0.269    0.791
I(M4^2)      4.288e-04  1.632e-03   0.263    0.795
M1:M2       -6.158e-03  8.426e-03  -0.731    0.473
M1:M3       -4.804e-03  1.379e-02  -0.348    0.731
M2:M3        3.557e-03  1.218e-02   0.292    0.773
M1:M4        3.817e-03  8.709e-03   0.438    0.666
M2:M4       -4.839e-03  1.124e-02  -0.430    0.671
M3:M4       -7.145e-03  8.792e-03  -0.813    0.426
M1:W        -2.234e-01  3.124e-01  -0.715    0.483
M2:W        -1.819e-01  4.536e-01  -0.401    0.693
M3:W        -2.544e-01  4.632e-01  -0.549    0.589
M4:W         7.674e-02  2.639e-01   0.291    0.774
M1:M2:M3    -7.195e-08  3.297e-06  -0.022    0.983
M1:M2:M4     9.904e-07  5.199e-06   0.190    0.851
M1:M3:M4     1.038e-08  5.519e-06   0.002    0.999
M2:M3:M4     2.111e-06  5.509e-06   0.383    0.706
M1:M2:W      3.454e-04  2.373e-04   1.456    0.161
M1:M3:W      2.062e-04  4.427e-04   0.466    0.646
M2:M3:W     -2.105e-04  4.129e-04  -0.510    0.616
M1:M4:W     -3.381e-04  3.201e-04  -1.057    0.303
M2:M4:W      4.681e-05  6.361e-04   0.074    0.942
M3:M4:W      2.989e-04  4.677e-04   0.639    0.530

Residual standard error: 157.7 on 20 degrees of freedom
Multiple R-squared:  0.9136,    Adjusted R-squared:  0.7882 
F-statistic: 7.289 on 29 and 20 DF,  p-value: 1.166e-05

> evaluateModel(model7)
[1] 23.25871
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~Removal of 3-Way Interactions~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> 
> model8 <- update(model7,~.-M2:M4:W)
> summary(model8)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-217.585  -62.139   -8.273   50.214  273.019 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -6.878e+03  6.918e+03  -0.994    0.331
M1           6.024e+00  1.136e+01   0.530    0.602
M2           6.052e+00  1.617e+01   0.374    0.712
M3           7.122e+00  1.370e+01   0.520    0.609
M4           2.494e+00  7.671e+00   0.325    0.748
W            2.153e+02  1.969e+02   1.094    0.286
I(M1^2)      2.736e-04  9.237e-04   0.296    0.770
I(M2^2)     -8.573e-04  1.337e-03  -0.641    0.528
I(M3^2)     -6.351e-04  1.609e-03  -0.395    0.697
I(M4^2)      3.803e-04  1.458e-03   0.261    0.797
M1:M2       -6.186e-03  8.216e-03  -0.753    0.460
M1:M3       -4.338e-03  1.195e-02  -0.363    0.720
M2:M3        3.212e-03  1.098e-02   0.293    0.773
M1:M4        3.749e-03  8.451e-03   0.444    0.662
M2:M4       -4.257e-03  7.796e-03  -0.546    0.591
M3:M4       -7.503e-03  7.154e-03  -1.049    0.306
M1:W        -2.239e-01  3.049e-01  -0.734    0.471
M2:W        -1.684e-01  4.051e-01  -0.416    0.682
M3:W        -2.751e-01  3.593e-01  -0.766    0.452
M4:W         7.720e-02  2.575e-01   0.300    0.767
M1:M2:M3    -1.076e-07  3.183e-06  -0.034    0.973
M1:M2:M4     9.544e-07  5.052e-06   0.189    0.852
M1:M3:M4    -1.117e-07  5.138e-06  -0.022    0.983
M2:M3:M4     2.251e-06  5.047e-06   0.446    0.660
M1:M2:W      3.529e-04  2.093e-04   1.686    0.107
M1:M3:W      1.863e-04  3.421e-04   0.545    0.592
M2:M3:W     -1.915e-04  3.143e-04  -0.609    0.549
M1:M4:W     -3.215e-04  2.212e-04  -1.454    0.161
M3:M4:W      3.263e-04  2.769e-04   1.178    0.252

Residual standard error: 153.9 on 21 degrees of freedom
Multiple R-squared:  0.9135,    Adjusted R-squared:  0.7983 
F-statistic: 7.925 on 28 and 21 DF,  p-value: 4.025e-06

> evaluateModel(model8) #accuracy went down here.
[1] 23.58468
> 
> model9 <- update(model8,~.-M1:M3:M4)
> anova(model8,model9)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     21 497246                          
2     22 497257 -1   -11.192 5e-04 0.9829
> summary(model9)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-217.554  -62.220   -8.306   50.733  273.022 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.821e+03  6.253e+03  -1.091   0.2871  
M1           6.179e+00  8.651e+00   0.714   0.4826  
M2           5.742e+00  7.412e+00   0.775   0.4468  
M3           7.181e+00  1.312e+01   0.547   0.5898  
M4           2.463e+00  7.366e+00   0.334   0.7412  
W            2.136e+02  1.762e+02   1.212   0.2383  
I(M1^2)      2.674e-04  8.587e-04   0.311   0.7584  
I(M2^2)     -8.574e-04  1.306e-03  -0.656   0.5184  
I(M3^2)     -6.316e-04  1.564e-03  -0.404   0.6903  
I(M4^2)      3.833e-04  1.418e-03   0.270   0.7894  
M1:M2       -6.090e-03  6.764e-03  -0.900   0.3776  
M1:M3       -4.538e-03  7.467e-03  -0.608   0.5496  
M2:M3        3.368e-03  8.135e-03   0.414   0.6829  
M1:M4        3.665e-03  7.345e-03   0.499   0.6228  
M2:M4       -4.110e-03  3.778e-03  -1.088   0.2885  
M3:M4       -7.533e-03  6.851e-03  -1.100   0.2834  
M1:W        -2.280e-01  2.326e-01  -0.980   0.3376  
M2:W        -1.614e-01  2.398e-01  -0.673   0.5079  
M3:W        -2.759e-01  3.487e-01  -0.791   0.4372  
M4:W         7.865e-02  2.429e-01   0.324   0.7492  
M1:M2:M3    -1.196e-07  3.062e-06  -0.039   0.9692  
M1:M2:M4     9.137e-07  4.585e-06   0.199   0.8439  
M2:M3:M4     2.177e-06  3.657e-06   0.595   0.5577  
M1:M2:W      3.513e-04  1.922e-04   1.828   0.0812 .
M1:M3:W      1.913e-04  2.459e-04   0.778   0.4448  
M2:M3:W     -1.949e-04  2.657e-04  -0.733   0.4710  
M1:M4:W     -3.215e-04  2.161e-04  -1.488   0.1510  
M3:M4:W      3.245e-04  2.592e-04   1.252   0.2237  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 150.3 on 22 degrees of freedom
Multiple R-squared:  0.9135,    Adjusted R-squared:  0.8074 
F-statistic: 8.609 on 27 and 22 DF,  p-value: 1.332e-06

> 
> par(mfrow=c(2,2))  # display 4 plots  in 2 rows, 2  columns
> plot(model9)
Warning messages:
1: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
2: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
> par(mfrow = c(1, 1)) #return plot layout to default
> 
> model10 <- update(model9,~.-M1:M2:M3 )
> anova(model9,model10)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + 
    M1:M4:W + M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     22 497257                           
2     23 497292 -1   -34.502 0.0015 0.9692
> summary(model10)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-217.136  -62.923   -7.911   51.035  273.455 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.950e+03  5.190e+03  -1.339   0.1936  
M1           6.244e+00  8.302e+00   0.752   0.4596  
M2           5.853e+00  6.689e+00   0.875   0.3905  
M3           7.503e+00  9.991e+00   0.751   0.4603  
M4           2.246e+00  4.720e+00   0.476   0.6387  
W            2.168e+02  1.527e+02   1.420   0.1689  
I(M1^2)      2.698e-04  8.377e-04   0.322   0.7503  
I(M2^2)     -8.597e-04  1.276e-03  -0.674   0.5073  
I(M3^2)     -6.086e-04  1.418e-03  -0.429   0.6717  
I(M4^2)      4.046e-04  1.280e-03   0.316   0.7548  
M1:M2       -6.117e-03  6.582e-03  -0.929   0.3624  
M1:M3       -4.780e-03  4.066e-03  -1.176   0.2518  
M2:M3        3.179e-03  6.403e-03   0.496   0.6243  
M1:M4        3.832e-03  5.834e-03   0.657   0.5178  
M2:M4       -4.023e-03  2.993e-03  -1.344   0.1920  
M3:M4       -7.569e-03  6.640e-03  -1.140   0.2660  
M1:W        -2.302e-01  2.209e-01  -1.042   0.3083  
M2:W        -1.631e-01  2.308e-01  -0.706   0.4870  
M3:W        -2.828e-01  2.951e-01  -0.958   0.3479  
M4:W         8.387e-02  1.985e-01   0.423   0.6766  
M1:M2:M4     8.178e-07  3.788e-06   0.216   0.8310  
M2:M3:M4     2.195e-06  3.547e-06   0.619   0.5421  
M1:M2:W      3.511e-04  1.879e-04   1.869   0.0745 .
M1:M3:W      1.964e-04  2.050e-04   0.958   0.3481  
M2:M3:W     -1.941e-04  2.592e-04  -0.749   0.4614  
M1:M4:W     -3.237e-04  2.045e-04  -1.583   0.1272  
M3:M4:W      3.234e-04  2.518e-04   1.284   0.2119  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147 on 23 degrees of freedom
Multiple R-squared:  0.9135,    Adjusted R-squared:  0.8158 
F-statistic: 9.346 on 26 and 23 DF,  p-value: 4.236e-07

> 
> model11 <- update(model10,~.-M1:M2:M4 )
> anova(model10, model11)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M4 + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + 
    M1:M4:W + M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     23 497292                           
2     24 498300 -1   -1007.9 0.0466  0.831
> summary(model11)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-221.88  -68.32  -10.94   51.27  274.15 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.881e+03  5.076e+03  -1.355   0.1879  
M1           4.680e+00  3.975e+00   1.177   0.2506  
M2           5.472e+00  6.322e+00   0.866   0.3953  
M3           9.105e+00  6.553e+00   1.390   0.1774  
M4           2.300e+00  4.619e+00   0.498   0.6230  
W            2.204e+02  1.487e+02   1.482   0.1513  
I(M1^2)      2.668e-04  8.208e-04   0.325   0.7480  
I(M2^2)     -8.910e-04  1.242e-03  -0.717   0.4802  
I(M3^2)     -6.681e-04  1.363e-03  -0.490   0.6284  
I(M4^2)      3.665e-04  1.243e-03   0.295   0.7706  
M1:M2       -4.797e-03  2.396e-03  -2.003   0.0566 .
M1:M3       -4.924e-03  3.930e-03  -1.253   0.2223  
M2:M3        2.294e-03  4.821e-03   0.476   0.6385  
M1:M4        4.871e-03  3.235e-03   1.506   0.1452  
M2:M4       -3.878e-03  2.858e-03  -1.357   0.1875  
M3:M4       -8.534e-03  4.813e-03  -1.773   0.0889 .
M1:W        -1.987e-01  1.627e-01  -1.221   0.2339  
M2:W        -1.547e-01  2.230e-01  -0.694   0.4945  
M3:W        -3.211e-01  2.310e-01  -1.390   0.1773  
M4:W         7.268e-02  1.878e-01   0.387   0.7021  
M2:M3:M4     2.849e-06  1.815e-06   1.569   0.1296  
M1:M2:W      3.273e-04  1.491e-04   2.195   0.0380 *
M1:M3:W      2.000e-04  2.002e-04   0.999   0.3279  
M2:M3:W     -1.779e-04  2.430e-04  -0.732   0.4713  
M1:M4:W     -3.240e-04  2.004e-04  -1.617   0.1189  
M3:M4:W      3.343e-04  2.417e-04   1.383   0.1794  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.1 on 24 degrees of freedom
Multiple R-squared:  0.9134,    Adjusted R-squared:  0.8231 
F-statistic: 10.12 on 25 and 24 DF,  p-value: 1.323e-07

> 
> #testing adding back in terms that caused adjusted RS to go down.
> model12a<-update(model11, ~.+M1:M2:M3:M4)
> anova(model11, model12a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W + M1:M2:M3:M4
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     24 498300                          
2     23 496853  1    1446.4 0.067 0.7981
> summary(model12a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W + M1:M2:M3:M4)

Residuals:
     Min       1Q   Median       3Q      Max 
-216.656  -67.357   -6.159   54.546  274.385 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.572e+03  5.314e+03  -1.237   0.2287  
M1           6.604e+00  8.466e+00   0.780   0.4434  
M2           4.566e+00  7.338e+00   0.622   0.5399  
M3           8.240e+00  7.474e+00   1.103   0.2816  
M4           7.683e-01  7.566e+00   0.102   0.9200  
W            2.126e+02  1.547e+02   1.374   0.1826  
I(M1^2)      2.482e-04  8.403e-04   0.295   0.7704  
I(M2^2)     -8.926e-04  1.267e-03  -0.704   0.4883  
I(M3^2)     -5.119e-04  1.516e-03  -0.338   0.7386  
I(M4^2)      5.048e-04  1.376e-03   0.367   0.7170  
M1:M2       -5.498e-03  3.647e-03  -1.508   0.1453  
M1:M3       -5.918e-03  5.552e-03  -1.066   0.2975  
M2:M3        3.658e-03  7.209e-03   0.507   0.6167  
M1:M4        4.550e-03  3.524e-03   1.291   0.2095  
M2:M4       -2.707e-03  5.383e-03  -0.503   0.6198  
M3:M4       -7.291e-03  6.869e-03  -1.061   0.2995  
M1:W        -2.488e-01  2.549e-01  -0.976   0.3393  
M2:W        -1.389e-01  2.354e-01  -0.590   0.5608  
M3:W        -3.036e-01  2.451e-01  -1.239   0.2279  
M4:W         1.138e-01  2.488e-01   0.457   0.6518  
M2:M3:M4     1.514e-06  5.478e-06   0.276   0.7847  
M1:M2:W      3.457e-04  1.678e-04   2.060   0.0509 .
M1:M3:W      2.301e-04  2.352e-04   0.979   0.3379  
M2:M3:W     -2.083e-04  2.743e-04  -0.759   0.4554  
M1:M4:W     -3.357e-04  2.093e-04  -1.604   0.1224  
M3:M4:W      3.119e-04  2.614e-04   1.193   0.2450  
M1:M2:M3:M4  3.552e-10  1.373e-09   0.259   0.7981  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147 on 23 degrees of freedom
Multiple R-squared:  0.9136,    Adjusted R-squared:  0.816 
F-statistic: 9.355 on 26 and 23 DF,  p-value: 4.197e-07

> 
> model12b<-update(model11, ~.+M1:M2:M3:W)
> anova(model11, model12b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     24 498300                           
2     23 496878  1    1421.6 0.0658 0.7998
> summary(model12b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-215.638  -70.420   -6.956   51.817  274.722 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.146e+03  5.281e+03  -1.353   0.1891  
M1           5.519e+00  5.209e+00   1.060   0.3003  
M2           5.708e+00  6.514e+00   0.876   0.3899  
M3           9.142e+00  6.686e+00   1.367   0.1847  
M4           1.316e+00  6.076e+00   0.217   0.8305  
W            2.114e+02  1.557e+02   1.358   0.1876  
I(M1^2)      2.809e-04  8.390e-04   0.335   0.7409  
I(M2^2)     -8.435e-04  1.281e-03  -0.659   0.5167  
I(M3^2)     -5.236e-04  1.500e-03  -0.349   0.7302  
I(M4^2)      4.928e-04  1.360e-03   0.362   0.7203  
M1:M2       -5.215e-03  2.936e-03  -1.776   0.0890 .
M1:M3       -5.470e-03  4.538e-03  -1.205   0.2403  
M2:M3        2.528e-03  5.002e-03   0.505   0.6180  
M1:M4        5.043e-03  3.368e-03   1.497   0.1479  
M2:M4       -3.603e-03  3.107e-03  -1.160   0.2580  
M3:M4       -8.174e-03  5.107e-03  -1.601   0.1231  
M1:W        -2.055e-01  1.681e-01  -1.223   0.2339  
M2:W        -1.377e-01  2.369e-01  -0.581   0.5667  
M3:W        -2.997e-01  2.500e-01  -1.199   0.2429  
M4:W         1.005e-01  2.201e-01   0.457   0.6522  
M2:M3:M4     2.581e-06  2.125e-06   1.214   0.2369  
M1:M2:W      3.115e-04  1.640e-04   1.899   0.0701 .
M1:M3:W      1.919e-04  2.066e-04   0.929   0.3627  
M2:M3:W     -2.209e-04  2.994e-04  -0.738   0.4680  
M1:M4:W     -3.312e-04  2.063e-04  -1.605   0.1221  
M3:M4:W      3.236e-04  2.501e-04   1.294   0.2084  
M1:M2:M3:W   3.357e-08  1.309e-07   0.257   0.7998  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147 on 23 degrees of freedom
Multiple R-squared:  0.9136,    Adjusted R-squared:  0.8159 
F-statistic: 9.355 on 26 and 23 DF,  p-value: 4.2e-07

> 
> model12c<-update(model11, ~.+M2:M3:M4:W)
> anova(model11, model12c)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     24 498300                           
2     23 494125  1      4175 0.1943 0.6635
> summary(model12c)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M3:M4:W + M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-222.73  -64.14   -8.08   57.15  274.41 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -1.034e+04  9.394e+03  -1.101   0.2824  
M1           4.599e+00  4.048e+00   1.136   0.2676  
M2           7.361e+00  7.727e+00   0.953   0.3507  
M3           1.491e+01  1.477e+01   1.010   0.3230  
M4           5.501e+00  8.649e+00   0.636   0.5310  
W            3.960e+02  4.261e+02   0.929   0.3623  
I(M1^2)      3.438e-04  8.530e-04   0.403   0.6906  
I(M2^2)     -8.526e-04  1.267e-03  -0.673   0.5076  
I(M3^2)     -1.004e-03  1.582e-03  -0.635   0.5319  
I(M4^2)      3.344e-04  1.266e-03   0.264   0.7940  
M1:M2       -5.044e-03  2.500e-03  -2.017   0.0555 .
M1:M3       -3.951e-03  4.567e-03  -0.865   0.3958  
M2:M3       -2.359e-03  1.164e-02  -0.203   0.8412  
M1:M4        3.960e-03  3.885e-03   1.019   0.3187  
M2:M4       -4.511e-03  3.242e-03  -1.391   0.1775  
M3:M4       -1.390e-02  1.312e-02  -1.059   0.3004  
M1:W        -2.016e-01  1.657e-01  -1.217   0.2359  
M2:W        -2.568e-01  3.241e-01  -0.792   0.4363  
M3:W        -6.154e-01  7.078e-01  -0.869   0.3936  
M4:W        -1.032e-01  4.423e-01  -0.233   0.8176  
M2:M3:M4     6.572e-06  8.646e-06   0.760   0.4549  
M1:M2:W      3.435e-04  1.561e-04   2.201   0.0380 *
M1:M3:W      1.262e-04  2.635e-04   0.479   0.6364  
M2:M3:W      1.025e-04  6.824e-04   0.150   0.8819  
M1:M4:W     -2.561e-04  2.556e-04  -1.002   0.3268  
M3:M4:W      6.561e-04  7.704e-04   0.852   0.4032  
M2:M3:M4:W  -2.120e-07  4.809e-07  -0.441   0.6635  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 146.6 on 23 degrees of freedom
Multiple R-squared:  0.9141,    Adjusted R-squared:  0.817 
F-statistic: 9.412 on 26 and 23 DF,  p-value: 3.962e-07

> 
> model13<-update(model11, ~.-M2:M3:W)
> anova(model11, model13)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M1:M4:W + M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     24 498300                           
2     25 509424 -1    -11124 0.5358 0.4713
> summary(model13)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M1:M4:W + M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-219.63  -72.19   -0.29   49.96  288.65 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.954e+03  4.814e+03  -1.652   0.1110  
M1           3.574e+00  3.642e+00   0.981   0.3359  
M2           8.602e+00  4.614e+00   1.864   0.0741 .
M3           9.903e+00  6.401e+00   1.547   0.1344  
M4           2.044e+00  4.563e+00   0.448   0.6581  
W            2.449e+02  1.436e+02   1.706   0.1005  
I(M1^2)      2.916e-04  8.124e-04   0.359   0.7226  
I(M2^2)     -9.161e-04  1.230e-03  -0.745   0.4635  
I(M3^2)     -7.873e-04  1.340e-03  -0.587   0.5622  
I(M4^2)      5.174e-04  1.214e-03   0.426   0.6736  
M1:M2       -4.113e-03  2.185e-03  -1.882   0.0715 .
M1:M3       -4.055e-03  3.711e-03  -1.093   0.2850  
M2:M3       -8.194e-04  2.249e-03  -0.364   0.7186  
M1:M4        4.145e-03  3.051e-03   1.359   0.1864  
M2:M4       -4.868e-03  2.495e-03  -1.951   0.0623 .
M3:M4       -7.233e-03  4.431e-03  -1.632   0.1151  
M1:W        -1.506e-01  1.475e-01  -1.021   0.3170  
M2:W        -2.759e-01  1.479e-01  -1.865   0.0740 .
M3:W        -3.302e-01  2.285e-01  -1.445   0.1610  
M4:W         1.119e-01  1.783e-01   0.628   0.5359  
M2:M3:M4     3.344e-06  1.669e-06   2.004   0.0560 .
M1:M2:W      2.720e-04  1.273e-04   2.136   0.0426 *
M1:M3:W      1.460e-04  1.844e-04   0.792   0.4360  
M1:M4:W     -2.526e-04  1.734e-04  -1.457   0.1576  
M3:M4:W      2.100e-04  1.704e-04   1.232   0.2293  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 142.7 on 25 degrees of freedom
Multiple R-squared:  0.9114,    Adjusted R-squared:  0.8264 
F-statistic: 10.72 on 24 and 25 DF,  p-value: 5.01e-08

> 
> model14<-update(model13, ~.-M1:M3:W)
> anova(model13, model14)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M3:W + M1:M4:W + M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M4:W + M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     25 509424                           
2     26 522197 -1    -12773 0.6268  0.436
> summary(model14)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M4:W + M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-223.47  -76.81   -7.34   55.69  291.73 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -7.468e+03  4.741e+03  -1.575 0.127290    
M1           2.606e+00  3.406e+00   0.765 0.451076    
M2           1.006e+01  4.202e+00   2.393 0.024232 *  
M3           7.050e+00  5.253e+00   1.342 0.191138    
M4           3.042e+00  4.354e+00   0.699 0.490912    
W            2.276e+02  1.409e+02   1.616 0.118226    
I(M1^2)      2.299e-04  8.029e-04   0.286 0.776848    
I(M2^2)     -1.289e-03  1.129e-03  -1.142 0.263787    
I(M3^2)     -5.043e-04  1.283e-03  -0.393 0.697399    
I(M4^2)      6.445e-04  1.195e-03   0.540 0.594131    
M1:M2       -4.998e-03  1.864e-03  -2.681 0.012563 *  
M1:M3       -1.246e-03  1.083e-03  -1.151 0.260227    
M2:M3       -7.450e-04  2.230e-03  -0.334 0.741029    
M1:M4        3.405e-03  2.883e-03   1.181 0.248318    
M2:M4       -4.439e-03  2.418e-03  -1.836 0.077801 .  
M3:M4       -7.837e-03  4.333e-03  -1.809 0.082076 .  
M1:W        -1.045e-01  1.345e-01  -0.777 0.444223    
M2:W        -3.494e-01  1.143e-01  -3.056 0.005132 ** 
M3:W        -2.056e-01  1.646e-01  -1.249 0.222692    
M4:W         5.875e-02  1.640e-01   0.358 0.723030    
M2:M3:M4     3.150e-06  1.639e-06   1.922 0.065615 .  
M1:M2:W      3.425e-04  9.042e-05   3.787 0.000812 ***
M1:M4:W     -2.297e-04  1.697e-04  -1.353 0.187616    
M3:M4:W      2.365e-04  1.658e-04   1.426 0.165667    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 141.7 on 26 degrees of freedom
Multiple R-squared:  0.9092,    Adjusted R-squared:  0.8289 
F-statistic: 11.32 on 23 and 26 DF,  p-value: 1.927e-08

> 
> #removal of term causes RS to go down
> #~~~~~Possible branch here~~~~~
> model15<-update(model14, ~.-M3:M4:W)
> anova(model14, model15)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M4:W + M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     26 522197                           
2     27 563059 -1    -40861 2.0345 0.1657
> summary(model15)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-209.20  -90.11   -9.27   60.97  289.00 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.992e+03  4.144e+03  -0.963   0.3439   
M1           5.195e+00  2.938e+00   1.768   0.0883 . 
M2           7.735e+00  3.948e+00   1.959   0.0605 . 
M3           1.786e+00  3.809e+00   0.469   0.6428   
M4           1.395e-01  3.922e+00   0.036   0.9719   
W            1.145e+02  1.186e+02   0.965   0.3431   
I(M1^2)     -2.586e-04  7.399e-04  -0.349   0.7295   
I(M2^2)     -1.244e-03  1.149e-03  -1.083   0.2886   
I(M3^2)     -1.304e-05  1.259e-03  -0.010   0.9918   
I(M4^2)      9.757e-04  1.194e-03   0.817   0.4210   
M1:M2       -4.403e-03  1.851e-03  -2.379   0.0247 * 
M1:M3       -8.529e-04  1.067e-03  -0.799   0.4310   
M2:M3       -5.247e-05  2.218e-03  -0.024   0.9813   
M1:M4        1.153e-03  2.458e-03   0.469   0.6428   
M2:M4       -3.101e-03  2.271e-03  -1.366   0.1832   
M3:M4       -3.734e-03  3.302e-03  -1.131   0.2681   
M1:W        -2.218e-01  1.085e-01  -2.043   0.0509 . 
M2:W        -2.990e-01  1.108e-01  -2.699   0.0119 * 
M3:W         7.725e-03  6.998e-02   0.110   0.9129   
M4:W         1.491e-01  1.541e-01   0.967   0.3420   
M2:M3:M4     2.290e-06  1.553e-06   1.475   0.1518   
M1:M2:W      3.166e-04  9.027e-05   3.508   0.0016 **
M1:M4:W     -9.048e-05  1.415e-04  -0.640   0.5279   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.4 on 27 degrees of freedom
Multiple R-squared:  0.9021,    Adjusted R-squared:  0.8223 
F-statistic: 11.31 on 22 and 27 DF,  p-value: 1.376e-08

> 
> model16<-update(model15, ~.-M1:M4:W)
> anova(model16, model15)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W + M1:M4:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     28 571587                          
2     27 563059  1    8528.6 0.409 0.5279
> summary(model16)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-210.06  -67.83   -8.89   57.05  296.11 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -5.233e+03  3.622e+03  -1.445 0.159573    
M1           6.314e+00  2.334e+00   2.705 0.011491 *  
M2           7.462e+00  3.883e+00   1.922 0.064896 .  
M3           1.615e+00  3.759e+00   0.430 0.670817    
M4           2.209e+00  2.191e+00   1.008 0.321913    
W            1.619e+02  9.164e+01   1.767 0.088204 .  
I(M1^2)     -3.298e-04  7.237e-04  -0.456 0.652100    
I(M2^2)     -9.952e-04  1.070e-03  -0.930 0.360235    
I(M3^2)      8.754e-05  1.236e-03   0.071 0.944033    
I(M4^2)      8.724e-04  1.171e-03   0.745 0.462327    
M1:M2       -4.064e-03  1.755e-03  -2.316 0.028100 *  
M1:M3       -7.644e-04  1.047e-03  -0.730 0.471259    
M2:M3       -4.389e-04  2.112e-03  -0.208 0.836851    
M1:M4       -3.130e-04  8.780e-04  -0.356 0.724145    
M2:M4       -3.422e-03  2.191e-03  -1.562 0.129565    
M3:M4       -3.862e-03  3.261e-03  -1.184 0.246244    
M1:W        -2.696e-01  7.776e-02  -3.467 0.001716 ** 
M2:W        -2.728e-01  1.018e-01  -2.679 0.012232 *  
M3:W         2.006e-02  6.655e-02   0.301 0.765282    
M4:W         5.476e-02  4.424e-02   1.238 0.226037    
M2:M3:M4     2.471e-06  1.511e-06   1.636 0.113074    
M1:M2:W      2.836e-04  7.319e-05   3.874 0.000588 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 142.9 on 28 degrees of freedom
Multiple R-squared:  0.9006,    Adjusted R-squared:  0.8261 
F-statistic: 12.08 on 21 and 28 DF,  p-value: 4.648e-09

> 
> model17<-update(model16, ~.-M2:M3:M4)
> anova(model16, model17)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M2:M3:M4 + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     28 571587                           
2     29 626212 -1    -54624 2.6759 0.1131
> summary(model17)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-256.624  -77.802   -1.539   60.189  313.671 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -1.659e+02  1.930e+03  -0.086  0.93211   
M1           6.832e+00  2.378e+00   2.872  0.00754 **
M2           2.869e+00  2.759e+00   1.040  0.30701   
M3          -3.596e+00  2.052e+00  -1.752  0.09029 . 
M4          -3.887e-01  1.552e+00  -0.250  0.80403   
W            6.154e+01  7.002e+01   0.879  0.38668   
I(M1^2)     -3.940e-04  7.432e-04  -0.530  0.60008   
I(M2^2)     -7.060e-04  1.085e-03  -0.651  0.52045   
I(M3^2)     -2.287e-04  1.255e-03  -0.182  0.85674   
I(M4^2)     -1.038e-04  1.036e-03  -0.100  0.92085   
M1:M2       -3.683e-03  1.789e-03  -2.059  0.04860 * 
M1:M3       -4.857e-04  1.062e-03  -0.457  0.65091   
M2:M3        2.044e-03  1.510e-03   1.354  0.18626   
M1:M4       -7.578e-04  8.586e-04  -0.883  0.38474   
M2:M4       -3.782e-04  1.190e-03  -0.318  0.75288   
M3:M4        6.183e-04  1.820e-03   0.340  0.73650   
M1:W        -2.643e-01  7.990e-02  -3.307  0.00252 **
M2:W        -1.954e-01  9.276e-02  -2.107  0.04390 * 
M3:W         8.507e-02  5.490e-02   1.549  0.13214   
M4:W         5.851e-02  4.544e-02   1.288  0.20801   
M1:M2:W      2.423e-04  7.067e-05   3.429  0.00184 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 146.9 on 29 degrees of freedom
Multiple R-squared:  0.8911,    Adjusted R-squared:  0.816 
F-statistic: 11.87 on 20 and 29 DF,  p-value: 4.292e-09

> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~Removal of 2-Way Interactions~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch A~~~~~~~~~~~~~~~~~~~~~~~
> #Difference is that I ignore square terms until 2ways are Sig
> model18a<-update(model17, ~.-M2:M4)
> anova(model17, model18a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     29 626212                          
2     30 628393 -1   -2181.6 0.101 0.7529
> summary(model18a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M3:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-259.13  -72.79   -0.52   69.00  318.92 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -6.714e+01  1.876e+03  -0.036  0.97169   
M1           6.927e+00  2.324e+00   2.981  0.00566 **
M2           2.331e+00  2.147e+00   1.086  0.28621   
M3          -3.377e+00  1.904e+00  -1.774  0.08623 . 
M4          -4.085e-01  1.528e+00  -0.267  0.79100   
W            5.652e+01  6.718e+01   0.841  0.40687   
I(M1^2)     -4.441e-04  7.154e-04  -0.621  0.53940   
I(M2^2)     -7.035e-04  1.069e-03  -0.658  0.51546   
I(M3^2)     -1.475e-04  1.211e-03  -0.122  0.90384   
I(M4^2)     -1.277e-04  1.017e-03  -0.125  0.90098   
M1:M2       -3.480e-03  1.646e-03  -2.114  0.04291 * 
M1:M3       -4.066e-04  1.017e-03  -0.400  0.69217   
M2:M3        1.819e-03  1.313e-03   1.385  0.17618   
M1:M4       -9.282e-04  6.605e-04  -1.405  0.17021   
M3:M4        4.782e-04  1.739e-03   0.275  0.78521   
M1:W        -2.627e-01  7.855e-02  -3.345  0.00223 **
M2:W        -1.797e-01  7.720e-02  -2.327  0.02690 * 
M3:W         8.022e-02  5.195e-02   1.544  0.13303   
M4:W         5.856e-02  4.475e-02   1.309  0.20059   
M1:M2:W      2.354e-04  6.618e-05   3.556  0.00127 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.7 on 30 degrees of freedom
Multiple R-squared:  0.8907,    Adjusted R-squared:  0.8215 
F-statistic: 12.87 on 19 and 30 DF,  p-value: 1.219e-09

> 
> par(mfrow=c(2,2))  # display 4 plots  in 2 rows, 2  columns
> plot(model18a)
> 
> model19a<-update(model18a, ~.-M3:M4)
> anova(model18a, model19a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     30 628393                           
2     31 629977 -1   -1583.9 0.0756 0.7852
> summary(model19a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M1:W + 
    M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-249.53  -80.22   -3.51   63.81  327.98 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.029e+01  1.843e+03  -0.016 0.986992    
M1           6.852e+00  2.273e+00   3.014 0.005101 ** 
M2           2.165e+00  2.029e+00   1.067 0.294224    
M3          -3.093e+00  1.576e+00  -1.963 0.058654 .  
M4          -5.925e-01  1.353e+00  -0.438 0.664415    
W            5.480e+01  6.589e+01   0.832 0.411937    
I(M1^2)     -4.104e-04  6.942e-04  -0.591 0.558652    
I(M2^2)     -6.519e-04  1.037e-03  -0.629 0.533976    
I(M3^2)      1.041e-04  7.806e-04   0.133 0.894730    
I(M4^2)      1.299e-04  3.910e-04   0.332 0.741903    
M1:M2       -3.413e-03  1.604e-03  -2.129 0.041335 *  
M1:M3       -5.174e-04  9.197e-04  -0.563 0.577788    
M2:M3        1.762e-03  1.277e-03   1.380 0.177547    
M1:M4       -8.532e-04  5.926e-04  -1.440 0.159954    
M1:W        -2.597e-01  7.660e-02  -3.390 0.001921 ** 
M2:W        -1.726e-01  7.170e-02  -2.407 0.022223 *  
M3:W         7.190e-02  4.158e-02   1.729 0.093749 .  
M4:W         6.326e-02  4.074e-02   1.553 0.130563    
M1:M2:W      2.307e-04  6.304e-05   3.660 0.000931 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 142.6 on 31 degrees of freedom
Multiple R-squared:  0.8905,    Adjusted R-squared:  0.8269 
F-statistic:    14 on 18 and 31 DF,  p-value: 3.283e-10

> 
> model20a<-update(model19a, ~.-M1:M3)
> anova(model19a, model20a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     31 629977                           
2     32 636408 -1   -6431.1 0.3165 0.5778
> summary(model20a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-249.39  -86.55   -1.37   63.59  333.55 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.375e+02  1.761e+03   0.135  0.89358    
M1           6.333e+00  2.055e+00   3.081  0.00422 ** 
M2           2.458e+00  1.939e+00   1.267  0.21414    
M3          -3.366e+00  1.483e+00  -2.270  0.03009 *  
M4          -5.598e-01  1.337e+00  -0.419  0.67821    
W            4.549e+01  6.309e+01   0.721  0.47611    
I(M1^2)     -3.539e-04  6.795e-04  -0.521  0.60605    
I(M2^2)     -5.331e-04  1.004e-03  -0.531  0.59905    
I(M3^2)      8.759e-05  7.717e-04   0.114  0.91034    
I(M4^2)      1.399e-04  3.864e-04   0.362  0.71971    
M1:M2       -3.553e-03  1.567e-03  -2.267  0.03028 *  
M2:M3        1.508e-03  1.182e-03   1.276  0.21114    
M1:M4       -9.367e-04  5.676e-04  -1.650  0.10869    
M1:W        -2.470e-01  7.240e-02  -3.411  0.00177 ** 
M2:W        -1.714e-01  7.090e-02  -2.418  0.02149 *  
M3:W         7.170e-02  4.113e-02   1.743  0.09092 .  
M4:W         6.617e-02  3.997e-02   1.655  0.10766    
M1:M2:W      2.229e-04  6.083e-05   3.664  0.00089 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 141 on 32 degrees of freedom
Multiple R-squared:  0.8893,    Adjusted R-squared:  0.8306 
F-statistic: 15.13 on 17 and 32 DF,  p-value: 9.515e-11

> 
> model21a<-update(model20a, ~.-M2:M3)
> anova(model20a, model21a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     32 636408                           
2     33 668789 -1    -32381 1.6282 0.2111
> summary(model21a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-256.55  -94.29   -4.47   53.45  361.74 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  5.202e+02  1.764e+03   0.295  0.76994   
M1           5.811e+00  2.033e+00   2.858  0.00733 **
M2           2.491e+00  1.958e+00   1.272  0.21217   
M3          -3.616e+00  1.484e+00  -2.436  0.02040 * 
M4          -5.284e-01  1.349e+00  -0.392  0.69786   
W            3.335e+01  6.296e+01   0.530  0.59982   
I(M1^2)     -1.291e-04  6.625e-04  -0.195  0.84671   
I(M2^2)      3.076e-04  7.646e-04   0.402  0.69008   
I(M3^2)      9.092e-04  4.294e-04   2.117  0.04186 * 
I(M4^2)      1.250e-04  3.899e-04   0.321  0.75048   
M1:M2       -3.608e-03  1.581e-03  -2.282  0.02910 * 
M1:M4       -8.878e-04  5.717e-04  -1.553  0.12997   
M1:W        -2.282e-01  7.156e-02  -3.188  0.00313 **
M2:W        -1.681e-01  7.152e-02  -2.350  0.02490 * 
M3:W         8.189e-02  4.073e-02   2.010  0.05263 . 
M4:W         6.449e-02  4.033e-02   1.599  0.11936   
M1:M2:W      2.061e-04  5.996e-05   3.438  0.00160 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 142.4 on 33 degrees of freedom
Multiple R-squared:  0.8837,    Adjusted R-squared:  0.8273 
F-statistic: 15.67 on 16 and 33 DF,  p-value: 4.942e-11

> 
> model22a<-update(model21a, ~.-M1:M4)
> anova(model21a, model22a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     33 668789                           
2     34 717665 -1    -48876 2.4117   0.13
> summary(model22a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-274.95  -63.08   -8.89   71.36  316.55 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  8.849e+02  1.784e+03   0.496  0.62310   
M1           4.504e+00  1.889e+00   2.385  0.02282 * 
M2           3.374e+00  1.912e+00   1.765  0.08652 . 
M3          -3.204e+00  1.490e+00  -2.150  0.03874 * 
M4          -1.023e+00  1.338e+00  -0.764  0.45008   
W            2.263e+01  6.387e+01   0.354  0.72528   
I(M1^2)     -1.079e-04  6.760e-04  -0.160  0.87407   
I(M2^2)      2.045e-04  7.774e-04   0.263  0.79409   
I(M3^2)      7.652e-04  4.279e-04   1.788  0.08266 . 
I(M4^2)     -1.395e-04  3.579e-04  -0.390  0.69920   
M1:M2       -3.785e-03  1.610e-03  -2.351  0.02464 * 
M1:W        -1.924e-01  6.915e-02  -2.783  0.00874 **
M2:W        -1.879e-01  7.182e-02  -2.616  0.01317 * 
M3:W         7.720e-02  4.146e-02   1.862  0.07124 . 
M4:W         6.593e-02  4.115e-02   1.602  0.11836   
M1:M2:W      2.010e-04  6.110e-05   3.290  0.00234 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 145.3 on 34 degrees of freedom
Multiple R-squared:  0.8752,    Adjusted R-squared:  0.8202 
F-statistic:  15.9 on 15 and 34 DF,  p-value: 3.617e-11

> 
> model23a<-update(model22a, ~.-M4:W)
> anova(model22a, model23a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:W + M2:W + M3:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     34 717665                           
2     35 771850 -1    -54185 2.5671 0.1184
> summary(model23a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:W + M2:W + M3:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-272.52  -73.60   -2.08   57.69  340.89 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  7.062e+02  1.820e+03   0.388  0.70038   
M1           4.053e+00  1.909e+00   2.123  0.04092 * 
M2           2.543e+00  1.881e+00   1.352  0.18493   
M3          -3.837e+00  1.469e+00  -2.613  0.01314 * 
M4           7.373e-01  7.814e-01   0.944  0.35182   
W            2.413e+01  6.527e+01   0.370  0.71386   
I(M1^2)     -3.006e-04  6.799e-04  -0.442  0.66110   
I(M2^2)      1.436e-04  7.936e-04   0.181  0.85740   
I(M3^2)      8.188e-04  4.360e-04   1.878  0.06876 . 
I(M4^2)     -4.130e-04  3.216e-04  -1.284  0.20751   
M1:M2       -2.980e-03  1.563e-03  -1.907  0.06482 . 
M1:W        -1.624e-01  6.804e-02  -2.387  0.02252 * 
M2:W        -1.619e-01  7.152e-02  -2.264  0.02986 * 
M3:W         1.080e-01  3.753e-02   2.878  0.00677 **
M1:M2:W      1.773e-04  6.058e-05   2.926  0.00599 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 148.5 on 35 degrees of freedom
Multiple R-squared:  0.8658,    Adjusted R-squared:  0.8121 
F-statistic: 16.13 on 14 and 35 DF,  p-value: 2.818e-11

> 
> model24a<-update(model23a, ~.-M1:M2)
> anova(model23a, model24a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:W + M2:W + M3:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M2:W + M3:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  
1     35 771850                              
2     36 852007 -1    -80158 3.6348 0.06482 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model24a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:W + M2:W + M3:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-287.29  -70.77   -2.07   73.85  335.64 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  2.049e+03  1.739e+03   1.178   0.2464  
M1           2.064e+00  1.656e+00   1.246   0.2208  
M2           1.553e+00  1.872e+00   0.829   0.4124  
M3          -3.686e+00  1.519e+00  -2.426   0.0204 *
M4           8.326e-01  8.078e-01   1.031   0.3095  
W           -4.276e+01  5.702e+01  -0.750   0.4582  
I(M1^2)     -8.941e-04  6.262e-04  -1.428   0.1620  
I(M2^2)     -8.174e-04  6.350e-04  -1.287   0.2063  
I(M3^2)      8.056e-04  4.517e-04   1.784   0.0829 .
I(M4^2)     -4.405e-04  3.328e-04  -1.324   0.1940  
M1:W        -7.578e-02  5.246e-02  -1.444   0.1573  
M2:W        -9.703e-02  6.516e-02  -1.489   0.1451  
M3:W         1.017e-01  3.873e-02   2.625   0.0126 *
M1:M2:W      1.010e-04  4.712e-05   2.143   0.0389 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 153.8 on 36 degrees of freedom
Multiple R-squared:  0.8519,    Adjusted R-squared:  0.7984 
F-statistic: 15.92 on 13 and 36 DF,  p-value: 3.518e-11

> 
> model25a<-update(model24a, ~.-M2:W)
> anova(model24a, model25a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M2:W + M3:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M3:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     36 852007                           
2     37 904493 -1    -52486 2.2177 0.1451
> summary(model25a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:W + M3:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-285.99  -70.30    3.26   66.58  369.32 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  3.410e+03  1.503e+03   2.268   0.0292 *
M1           1.379e+00  1.617e+00   0.853   0.3993  
M2          -8.063e-01  1.015e+00  -0.795   0.4318  
M3          -3.315e+00  1.523e+00  -2.177   0.0360 *
M4           8.897e-01  8.201e-01   1.085   0.2849  
W           -1.005e+02  4.249e+01  -2.365   0.0234 *
I(M1^2)     -4.138e-04  5.455e-04  -0.759   0.4529  
I(M2^2)     -5.526e-05  3.821e-04  -0.145   0.8858  
I(M3^2)      7.441e-04  4.571e-04   1.628   0.1120  
I(M4^2)     -4.405e-04  3.382e-04  -1.302   0.2009  
M1:W        -4.377e-02  4.864e-02  -0.900   0.3740  
M3:W         8.778e-02  3.820e-02   2.298   0.0273 *
M1:M2:W      4.701e-05  3.060e-05   1.536   0.1331  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.4 on 37 degrees of freedom
Multiple R-squared:  0.8427,    Adjusted R-squared:  0.7917 
F-statistic: 16.52 on 12 and 37 DF,  p-value: 2.321e-11

> 
> model26a<-update(model25a, ~.-M1:M2:W)
> anova(model25a, model26a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M3:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     37 904493                           
2     38 962162 -1    -57669 2.3591 0.1331
> summary(model26a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:W + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-255.05  -78.58  -22.00   83.05  366.00 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  4.015e+03  1.476e+03   2.720 0.009793 ** 
M1          -2.198e-01  1.260e+00  -0.174 0.862430    
M2          -1.144e-01  9.251e-01  -0.124 0.902214    
M3          -3.875e+00  1.505e+00  -2.574 0.014077 *  
M4           8.722e-01  8.345e-01   1.045 0.302536    
W           -1.336e+02  3.726e+01  -3.586 0.000944 ***
I(M1^2)      1.926e-04  3.831e-04   0.503 0.618077    
I(M2^2)      2.883e-05  3.849e-04   0.075 0.940683    
I(M3^2)      8.583e-04  4.590e-04   1.870 0.069215 .  
I(M4^2)     -4.275e-04  3.441e-04  -1.242 0.221701    
M1:W         1.832e-02  2.752e-02   0.666 0.509543    
M3:W         1.081e-01  3.647e-02   2.965 0.005204 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 159.1 on 38 degrees of freedom
Multiple R-squared:  0.8327,    Adjusted R-squared:  0.7843 
F-statistic: 17.19 on 11 and 38 DF,  p-value: 1.602e-11

> 
> model27a<-update(model26a, ~.-M1:W)
> anova(model26a, model27a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:W + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     38 962162                           
2     39 973387 -1    -11225 0.4433 0.5095
> summary(model27a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-251.36  -74.90  -25.55   68.25  384.43 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.626e+03  1.346e+03   2.694 0.010355 *  
M1           4.487e-01  7.553e-01   0.594 0.555893    
M2          -7.179e-02  9.163e-01  -0.078 0.937949    
M3          -4.168e+00  1.429e+00  -2.917 0.005832 ** 
M4           9.445e-01  8.215e-01   1.150 0.257238    
W           -1.247e+02  3.455e+01  -3.611 0.000860 ***
I(M1^2)      4.530e-05  3.105e-04   0.146 0.884783    
I(M2^2)      1.108e-05  3.812e-04   0.029 0.976949    
I(M3^2)      8.959e-04  4.523e-04   1.981 0.054690 .  
I(M4^2)     -4.524e-04  3.396e-04  -1.332 0.190550    
M3:W         1.206e-01  3.102e-02   3.889 0.000381 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 158 on 39 degrees of freedom
Multiple R-squared:  0.8308,    Adjusted R-squared:  0.7874 
F-statistic: 19.14 on 10 and 39 DF,  p-value: 4.353e-12

> 
> model28a<-update(model27a, ~.-I(M2^2))
> anova(model27a, model28a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M3:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     39 973387                          
2     40 973408 -1   -21.106 8e-04 0.9769
> summary(model28a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + 
    I(M4^2) + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-251.87  -75.47  -24.15   68.27  383.90 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.616e+03  1.285e+03   2.815 0.007533 ** 
M1           4.363e-01  6.143e-01   0.710 0.481735    
M2          -4.559e-02  1.650e-01  -0.276 0.783688    
M3          -4.177e+00  1.377e+00  -3.034 0.004226 ** 
M4           9.537e-01  7.497e-01   1.272 0.210699    
W           -1.245e+02  3.318e+01  -3.752 0.000556 ***
I(M1^2)      5.053e-05  2.499e-04   0.202 0.840758    
I(M3^2)      9.013e-04  4.066e-04   2.217 0.032404 *  
I(M4^2)     -4.564e-04  3.076e-04  -1.483 0.145781    
M3:W         1.205e-01  2.992e-02   4.026 0.000246 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156 on 40 degrees of freedom
Multiple R-squared:  0.8307,    Adjusted R-squared:  0.7927 
F-statistic: 21.81 on 9 and 40 DF,  p-value: 8.958e-13

> 
> model29a<-update(model28a, ~.-I(M1^2))
> anova(model28a, model29a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + I(M4^2) + M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     40 973408                           
2     41 974404 -1   -995.28 0.0409 0.8408
> summary(model29a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + I(M4^2) + 
    M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-254.87  -72.95  -22.95   71.12  382.58 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.497e+03  1.128e+03   3.101 0.003485 ** 
M1           5.572e-01  1.387e-01   4.017 0.000245 ***
M2          -4.402e-02  1.629e-01  -0.270 0.788283    
M3          -4.115e+00  1.326e+00  -3.103 0.003461 ** 
M4           9.394e-01  7.376e-01   1.274 0.209972    
W           -1.223e+02  3.089e+01  -3.958 0.000294 ***
I(M3^2)      8.869e-04  3.956e-04   2.242 0.030449 *  
I(M4^2)     -4.514e-04  3.031e-04  -1.490 0.143976    
M3:W         1.188e-01  2.846e-02   4.175 0.000152 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 154.2 on 41 degrees of freedom
Multiple R-squared:  0.8306,    Adjusted R-squared:  0.7975 
F-statistic: 25.12 on 8 and 41 DF,  p-value: 1.746e-13

> 
> model30a<-update(model29a, ~.-I(M4^2))
> anova(model29a, model30a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + I(M4^2) + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + M3:W
  Res.Df     RSS Df Sum of Sq     F Pr(>F)
1     41  974404                          
2     42 1027140 -1    -52736 2.219  0.144
> summary(model30a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-304.05  -98.05  -20.65   96.41  398.87 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.967e+03  1.098e+03   3.612 0.000804 ***
M1           5.813e-01  1.397e-01   4.160 0.000154 ***
M2          -5.401e-02  1.651e-01  -0.327 0.745130    
M3          -3.732e+00  1.320e+00  -2.828 0.007149 ** 
M4          -1.395e-01  1.414e-01  -0.987 0.329418    
W           -1.283e+02  3.106e+01  -4.131 0.000168 ***
I(M3^2)      7.162e-04  3.841e-04   1.865 0.069247 .  
M3:W         1.195e-01  2.887e-02   4.140 0.000164 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.4 on 42 degrees of freedom
Multiple R-squared:  0.8214,    Adjusted R-squared:  0.7916 
F-statistic:  27.6 on 7 and 42 DF,  p-value: 9.053e-14

> 
> model31a<-update(model30a, ~.-I(M3^2))
> anova(model30a, model31a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M3^2) + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W
  Res.Df     RSS Df Sum of Sq      F  Pr(>F)  
1     42 1027140                              
2     43 1112159 -1    -85019 3.4764 0.06925 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model31a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-276.70 -105.65  -24.06   89.36  373.47 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) 2092.09277  453.79241   4.610 3.59e-05 ***
M1             0.63013    0.14117   4.464 5.74e-05 ***
M2            -0.04916    0.16972  -0.290 0.773500    
M3            -1.37867    0.39646  -3.477 0.001171 ** 
M4            -0.10260    0.14398  -0.713 0.479955    
W            -81.69907   18.94616  -4.312 9.27e-05 ***
M3:W           0.08101    0.02074   3.906 0.000327 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 160.8 on 43 degrees of freedom
Multiple R-squared:  0.8066,    Adjusted R-squared:  0.7796 
F-statistic: 29.89 on 6 and 43 DF,  p-value: 7.99e-14

> #Conclusion:This method is terrible. Don't do it.
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~Testing Addition of Terms~~~~~~~~~~~~~~~~~~
> 
> model32a<-update(model31a, ~.+M1:M2:M3:M4)
> anova(model31a, model32a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:M4
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1     43 1112159                           
2     42 1105318  1      6841 0.2599 0.6128
> summary(model32a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:M4)

Residuals:
    Min      1Q  Median      3Q     Max 
-286.77  -97.64  -23.21   98.28  379.35 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  2.498e+03  9.192e+02   2.718  0.00950 **
M1           5.753e-01  1.784e-01   3.225  0.00244 **
M2          -1.074e-01  2.058e-01  -0.522  0.60456   
M3          -1.579e+00  5.612e-01  -2.814  0.00741 **
M4          -1.709e-01  1.976e-01  -0.865  0.39200   
W           -9.262e+01  2.870e+01  -3.227  0.00243 **
M3:W         8.877e-02  2.588e-02   3.430  0.00136 **
M1:M2:M3:M4  3.329e-11  6.530e-11   0.510  0.61283   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 162.2 on 42 degrees of freedom
Multiple R-squared:  0.8078,    Adjusted R-squared:  0.7758 
F-statistic: 25.22 on 7 and 42 DF,  p-value: 4.062e-13

> 
> #Added Term is significant
> model33a<-update(model31a, ~.+M1:M2:M3:W)
> anova(model31a, model33a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
  Res.Df     RSS Df Sum of Sq      F  Pr(>F)  
1     43 1112159                              
2     42 1010991  1    101168 4.2029 0.04663 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model33a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-279.96  -78.72  -18.26  101.97  372.29 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.451e+03  7.945e+02   4.344 8.67e-05 ***
M1           2.463e-01  2.315e-01   1.064 0.293515    
M2          -3.975e-01  2.360e-01  -1.685 0.099487 .  
M3          -1.715e+00  4.162e-01  -4.121 0.000174 ***
M4          -1.368e-01  1.399e-01  -0.978 0.333592    
W           -1.053e+02  2.161e+01  -4.874 1.60e-05 ***
M3:W         7.478e-02  2.024e-02   3.695 0.000631 ***
M1:M2:M3:W   1.592e-08  7.763e-09   2.050 0.046632 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 155.1 on 42 degrees of freedom
Multiple R-squared:  0.8242,    Adjusted R-squared:  0.7949 
F-statistic: 28.13 on 7 and 42 DF,  p-value: 6.543e-14

> 
> model34a<-update(model33a, ~.+M2:M3:M4:W)
> anova(model33a, model34a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W + M2:M3:M4:W
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1     42 1010991                           
2     41 1008620  1    2370.1 0.0963 0.7578
> summary(model34a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W + 
    M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-288.29  -76.23  -17.13   99.67  373.26 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.595e+03  9.266e+02   3.880 0.000372 ***
M1           2.815e-01  2.600e-01   1.082 0.285425    
M2          -4.162e-01  2.460e-01  -1.692 0.098288 .  
M3          -1.770e+00  4.561e-01  -3.881 0.000371 ***
M4          -2.271e-01  3.233e-01  -0.702 0.486405    
W           -1.090e+02  2.484e+01  -4.388 7.82e-05 ***
M3:W         7.648e-02  2.118e-02   3.611 0.000824 ***
M1:M2:M3:W   1.382e-08  1.036e-08   1.334 0.189665    
M2:M3:M4:W   3.420e-09  1.102e-08   0.310 0.757836    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.8 on 41 degrees of freedom
Multiple R-squared:  0.8246,    Adjusted R-squared:  0.7904 
F-statistic:  24.1 on 8 and 41 DF,  p-value: 3.472e-13

> 
> model35a<-update(model33a, ~.+M1:M4:W)
> anova(model33a, model35a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4:W + M1:M2:M3:W
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1     42 1010991                           
2     41 1010560  1    430.72 0.0175 0.8955
> summary(model35a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4:W + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-276.56  -81.18  -19.29  103.88  376.07 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.393e+03  9.162e+02   3.704 0.000628 ***
M1           2.917e-01  4.158e-01   0.701 0.486971    
M2          -4.112e-01  2.601e-01  -1.581 0.121606    
M3          -1.761e+00  5.446e-01  -3.233 0.002419 ** 
M4          -7.150e-02  5.142e-01  -0.139 0.890089    
W           -1.045e+02  2.282e+01  -4.579 4.29e-05 ***
M3:W         7.666e-02  2.495e-02   3.073 0.003757 ** 
M1:M4:W     -3.172e-06  2.399e-05  -0.132 0.895478    
M1:M2:M3:W   1.654e-08  9.167e-09   1.804 0.078552 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 157 on 41 degrees of freedom
Multiple R-squared:  0.8243,    Adjusted R-squared:   0.79 
F-statistic: 24.04 on 8 and 41 DF,  p-value: 3.607e-13

> 
> model36a<-update(model33a, ~.+M3:M4:W)
> anova(model33a, model36a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M3:M4:W + M1:M2:M3:W
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1     42 1010991                           
2     41 1005918  1    5072.2 0.2067 0.6517
> summary(model36a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M3:M4:W + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-292.40  -74.96  -13.67   97.91  371.40 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.721e+03  9.982e+02   3.728 0.000583 ***
M1           2.578e-01  2.351e-01   1.097 0.279218    
M2          -3.669e-01  2.476e-01  -1.482 0.146050    
M3          -1.784e+00  4.464e-01  -3.996 0.000262 ***
M4          -3.611e-01  5.130e-01  -0.704 0.485478    
W           -1.100e+02  2.407e+01  -4.568 4.44e-05 ***
M3:W         6.937e-02  2.364e-02   2.934 0.005454 ** 
M3:M4:W      1.081e-05  2.378e-05   0.455 0.651736    
M1:M2:M3:W   1.453e-08  8.410e-09   1.727 0.091623 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.6 on 41 degrees of freedom
Multiple R-squared:  0.8251,    Adjusted R-squared:  0.791 
F-statistic: 24.18 on 8 and 41 DF,  p-value: 3.291e-13

> 
> model37a<-update(model33a, ~.+M2:M3:M4)
> anova(model33a, model37a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M2:M3:M4 + M1:M2:M3:W
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1     42 1010991                           
2     41 1008635  1    2355.2 0.0957 0.7586
> summary(model37a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M2:M3:M4 + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-272.43  -82.03  -21.77  101.77  368.04 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  3.245e+03  1.044e+03   3.107  0.00343 **
M1           2.135e-01  2.569e-01   0.831  0.41086   
M2          -3.648e-01  2.609e-01  -1.398  0.16951   
M3          -1.553e+00  6.711e-01  -2.315  0.02571 * 
M4          -5.372e-02  3.036e-01  -0.177  0.86043   
W           -9.873e+01  3.057e+01  -3.230  0.00244 **
M3:W         6.737e-02  3.150e-02   2.138  0.03849 * 
M2:M3:M4    -5.249e-08  1.696e-07  -0.309  0.75857   
M1:M2:M3:W   1.751e-08  9.383e-09   1.866  0.06925 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.8 on 41 degrees of freedom
Multiple R-squared:  0.8246,    Adjusted R-squared:  0.7904 
F-statistic:  24.1 on 8 and 41 DF,  p-value: 3.473e-13

> 
> #Addition of terms seems significant
> model38a<-update(model33a, ~.+M1:M4)
> anova(model33a, model38a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
  Res.Df     RSS Df Sum of Sq      F  Pr(>F)  
1     42 1010991                              
2     41  919661  1     91329 4.0716 0.05019 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model38a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-240.99  -84.45  -36.74   90.89  358.09 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.577e+03  8.810e+02   2.925 0.005595 ** 
M1           8.444e-01  3.712e-01   2.275 0.028230 *  
M2          -5.363e-01  2.380e-01  -2.254 0.029612 *  
M3          -1.475e+00  4.190e-01  -3.521 0.001069 ** 
M4           7.148e-01  4.432e-01   1.613 0.114410    
W           -8.590e+01  2.298e+01  -3.738 0.000567 ***
M3:W         5.107e-02  2.280e-02   2.240 0.030557 *  
M1:M4       -7.186e-04  3.561e-04  -2.018 0.050186 .  
M1:M2:M3:W   2.286e-08  8.246e-09   2.772 0.008342 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 149.8 on 41 degrees of freedom
Multiple R-squared:  0.8401,    Adjusted R-squared:  0.8089 
F-statistic: 26.92 on 8 and 41 DF,  p-value: 5.513e-14

> 
> #Addition of term seems significant
> model39a<-update(model38a, ~.+M3:W)
> anova(model38a, model39a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq F Pr(>F)
1     41 919661                      
2     41 919661  0         0         
> summary(model39a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-240.99  -84.45  -36.74   90.89  358.09 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.577e+03  8.810e+02   2.925 0.005595 ** 
M1           8.444e-01  3.712e-01   2.275 0.028230 *  
M2          -5.363e-01  2.380e-01  -2.254 0.029612 *  
M3          -1.475e+00  4.190e-01  -3.521 0.001069 ** 
M4           7.148e-01  4.432e-01   1.613 0.114410    
W           -8.590e+01  2.298e+01  -3.738 0.000567 ***
M3:W         5.107e-02  2.280e-02   2.240 0.030557 *  
M1:M4       -7.186e-04  3.561e-04  -2.018 0.050186 .  
M1:M2:M3:W   2.286e-08  8.246e-09   2.772 0.008342 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 149.8 on 41 degrees of freedom
Multiple R-squared:  0.8401,    Adjusted R-squared:  0.8089 
F-statistic: 26.92 on 8 and 41 DF,  p-value: 5.513e-14

> 
> model40a<-update(model39a, ~.+M2:M3)
> anova(model39a, model40a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M2:M3 + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     41 919661                           
2     40 916850  1    2811.9 0.1227  0.728
> summary(model40a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M2:M3 + 
    M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-234.81  -81.59  -32.26   91.56  364.16 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  2.816e+03  1.123e+03   2.508   0.0163 * 
M1           9.074e-01  4.161e-01   2.181   0.0352 * 
M2          -6.950e-01  5.128e-01  -1.355   0.1830   
M3          -1.824e+00  1.082e+00  -1.686   0.0997 . 
M4           7.232e-01  4.486e-01   1.612   0.1148   
W           -9.340e+01  3.159e+01  -2.957   0.0052 **
M3:W         6.184e-02  3.841e-02   1.610   0.1153   
M1:M4       -7.239e-04  3.603e-04  -2.009   0.0513 . 
M2:M3        1.954e-04  5.578e-04   0.350   0.7280   
M1:M2:M3:W   2.003e-08  1.160e-08   1.726   0.0920 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 151.4 on 40 degrees of freedom
Multiple R-squared:  0.8406,    Adjusted R-squared:  0.8047 
F-statistic: 23.43 on 9 and 40 DF,  p-value: 2.813e-13

> 
> model41a<-update(model39a, ~.+M1:M2:M3:M4)
> anova(model39a, model41a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W + M1:M2:M3:M4
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     41 919661                           
2     40 918625  1    1035.9 0.0451 0.8329
> summary(model41a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W + 
    M1:M2:M3:M4)

Residuals:
    Min      1Q  Median      3Q     Max 
-237.16  -85.96  -31.41   96.39  361.45 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  2.601e+03  8.990e+02   2.894  0.00614 **
M1           9.288e-01  5.468e-01   1.699  0.09717 . 
M2          -5.477e-01  2.467e-01  -2.220  0.03213 * 
M3          -1.562e+00  5.872e-01  -2.659  0.01121 * 
M4           7.646e-01  5.060e-01   1.511  0.13862   
W           -8.902e+01  2.749e+01  -3.238  0.00242 **
M3:W         5.564e-02  3.154e-02   1.764  0.08532 . 
M1:M4       -8.039e-04  5.398e-04  -1.489  0.14422   
M1:M2:M3:W   2.125e-08  1.127e-08   1.885  0.06676 . 
M1:M2:M3:M4  2.757e-11  1.298e-10   0.212  0.83288   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 151.5 on 40 degrees of freedom
Multiple R-squared:  0.8403,    Adjusted R-squared:  0.8043 
F-statistic: 23.38 on 9 and 40 DF,  p-value: 2.92e-13

> 
> model42a<-update(model39a, ~.+M2:M3:M4:W)
> anova(model39a, model42a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     41 919661                           
2     40 884938  1     34723 1.5695 0.2175
> summary(model42a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W + 
    M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-243.77  -98.35  -18.45   82.45  358.29 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.939e+03  9.214e+02   3.189 0.002772 ** 
M1           1.154e+00  4.439e-01   2.600 0.012997 *  
M2          -6.520e-01  2.537e-01  -2.570 0.014007 *  
M3          -1.639e+00  4.360e-01  -3.758 0.000547 ***
M4           5.687e-01  4.553e-01   1.249 0.218870    
W           -9.597e+01  2.420e+01  -3.966 0.000294 ***
M3:W         5.174e-02  2.265e-02   2.285 0.027720 *  
M1:M4       -9.138e-04  3.865e-04  -2.364 0.022999 *  
M1:M2:M3:W   1.596e-08  9.866e-09   1.618 0.113492    
M2:M3:M4:W   1.430e-08  1.142e-08   1.253 0.217550    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 148.7 on 40 degrees of freedom
Multiple R-squared:  0.8461,    Adjusted R-squared:  0.8115 
F-statistic: 24.44 on 9 and 40 DF,  p-value: 1.415e-13

> 
> model43a<-update(model39a, ~.+M1:M4:W)
> anova(model39a, model43a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M4:W + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1     41 919661                          
2     40 917506  1    2155.4 0.094 0.7608
> summary(model43a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M4:W + 
    M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-231.30  -84.37  -35.15   83.07  348.93 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.680e+03  9.522e+02   2.814 0.007550 ** 
M1           7.609e-01  4.639e-01   1.640 0.108799    
M2          -5.099e-01  2.556e-01  -1.994 0.052953 .  
M3          -1.362e+00  5.614e-01  -2.427 0.019821 *  
M4           5.943e-01  5.961e-01   0.997 0.324754    
W           -8.721e+01  2.362e+01  -3.691 0.000665 ***
M3:W         4.594e-02  2.849e-02   1.612 0.114731    
M1:M4       -7.433e-04  3.690e-04  -2.014 0.050753 .  
M1:M4:W      7.272e-06  2.372e-05   0.307 0.760781    
M1:M2:M3:W   2.166e-08  9.202e-09   2.354 0.023562 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 151.5 on 40 degrees of freedom
Multiple R-squared:  0.8405,    Adjusted R-squared:  0.8046 
F-statistic: 23.41 on 9 and 40 DF,  p-value: 2.852e-13

> 
> model43a<-update(model39a, ~.+M2:M3:M4)
> anova(model39a, model43a)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M1:M2:M3:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M2:M3:M4 + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     41 919661                           
2     40 909866  1    9795.5 0.4306 0.5154
> summary(model43a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W + M1:M4 + M2:M3:M4 + 
    M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-232.04  -94.48  -31.41   94.29  365.43 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept)  2.904e+03  1.018e+03   2.854  0.00682 **
M1           1.019e+00  4.587e-01   2.221  0.03207 * 
M2          -6.341e-01  2.822e-01  -2.247  0.03022 * 
M3          -1.805e+00  6.565e-01  -2.750  0.00891 **
M4           6.663e-01  4.524e-01   1.473  0.14860   
W           -9.780e+01  2.940e+01  -3.327  0.00189 **
M3:W         6.408e-02  3.033e-02   2.113  0.04093 * 
M1:M4       -8.380e-04  4.022e-04  -2.084  0.04361 * 
M2:M3:M4     1.200e-07  1.829e-07   0.656  0.51543   
M1:M2:M3:W   2.037e-08  9.127e-09   2.232  0.03128 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 150.8 on 40 degrees of freedom
Multiple R-squared:  0.8418,    Adjusted R-squared:  0.8062 
F-statistic: 23.65 on 9 and 40 DF,  p-value: 2.425e-13

> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch B~~~~~~~~~~~~~~~~~~~~~~~
> 
> model18b<-update(model17, ~.-I(M4^2))
> anova(model17, model18b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq    F Pr(>F)
1     29 626212                         
2     30 626429 -1   -216.96 0.01 0.9208
> summary(model18b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-252.60  -82.88   -0.70   59.28  317.33 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -1.450e+02  1.887e+03  -0.077  0.93924   
M1           6.827e+00  2.338e+00   2.920  0.00659 **
M2           2.815e+00  2.660e+00   1.058  0.29851   
M3          -3.492e+00  1.736e+00  -2.011  0.05341 . 
M4          -4.871e-01  1.182e+00  -0.412  0.68331   
W            6.097e+01  6.863e+01   0.888  0.38137   
I(M1^2)     -3.808e-04  7.193e-04  -0.529  0.60043   
I(M2^2)     -6.821e-04  1.041e-03  -0.655  0.51732   
I(M3^2)     -1.502e-04  9.651e-04  -0.156  0.87738   
M1:M2       -3.674e-03  1.757e-03  -2.091  0.04509 * 
M1:M3       -5.235e-04  9.765e-04  -0.536  0.59585   
M2:M3        2.031e-03  1.479e-03   1.373  0.17990   
M1:M4       -7.388e-04  8.235e-04  -0.897  0.37680   
M2:M4       -3.868e-04  1.167e-03  -0.331  0.74258   
M3:M4        4.590e-04  8.714e-04   0.527  0.60228   
M1:W        -2.639e-01  7.850e-02  -3.362  0.00213 **
M2:W        -1.935e-01  8.919e-02  -2.169  0.03812 * 
M3:W         8.209e-02  4.542e-02   1.807  0.08076 . 
M4:W         6.080e-02  3.864e-02   1.573  0.12611   
M1:M2:W      2.412e-04  6.867e-05   3.513  0.00143 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.5 on 30 degrees of freedom
Multiple R-squared:  0.8911,    Adjusted R-squared:  0.8221 
F-statistic: 12.92 on 19 and 30 DF,  p-value: 1.167e-09

> 
> anova(model18a, model18b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq F Pr(>F)
1     30 628393                      
2     30 626429  0    1964.6         
> 
> par(mfrow=c(2,2))  # display 4 plots  in 2 rows, 2  columns
> plot(model18b)
> 
> model19b<-update(model18b, ~.-I(M3^2))
> anova(model18b, model19b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     30 626429                           
2     31 626934 -1   -505.64 0.0242 0.8774
> summary(model19b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-248.37  -82.05   -2.04   64.30  321.45 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -8.200e+01  1.814e+03  -0.045  0.96423    
M1           6.758e+00  2.260e+00   2.990  0.00543 ** 
M2           2.750e+00  2.586e+00   1.063  0.29582    
M3          -3.555e+00  1.660e+00  -2.141  0.04021 *  
M4          -4.353e-01  1.117e+00  -0.390  0.69932    
W            5.825e+01  6.531e+01   0.892  0.37930    
I(M1^2)     -3.594e-04  6.949e-04  -0.517  0.60866    
I(M2^2)     -6.235e-04  9.551e-04  -0.653  0.51872    
M1:M2       -3.624e-03  1.701e-03  -2.131  0.04110 *  
M1:M3       -5.313e-04  9.597e-04  -0.554  0.58381    
M2:M3        1.862e-03  9.899e-04   1.881  0.06941 .  
M1:M4       -7.471e-04  8.087e-04  -0.924  0.36274    
M2:M4       -3.289e-04  1.088e-03  -0.302  0.76453    
M3:M4        3.796e-04  6.955e-04   0.546  0.58908    
M1:W        -2.612e-01  7.539e-02  -3.465  0.00157 ** 
M2:W        -1.900e-01  8.490e-02  -2.237  0.03259 *  
M3:W         8.301e-02  4.433e-02   1.873  0.07058 .  
M4:W         6.013e-02  3.779e-02   1.591  0.12175    
M1:M2:W      2.377e-04  6.391e-05   3.720  0.00079 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 142.2 on 31 degrees of freedom
Multiple R-squared:  0.891,     Adjusted R-squared:  0.8277 
F-statistic: 14.08 on 18 and 31 DF,  p-value: 3.059e-10

> 
> model20b<-update(model19b, ~.-M2:M4)
> anova(model19b, model20b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     31 626934                           
2     32 628781 -1   -1846.8 0.0913 0.7645
> summary(model20b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-252.63  -77.22   -2.24   67.04  324.73 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.177e+01  1.777e+03  -0.012 0.990302    
M1           6.894e+00  2.184e+00   3.156 0.003470 ** 
M2           2.256e+00  1.976e+00   1.142 0.261907    
M3          -3.278e+00  1.362e+00  -2.406 0.022097 *  
M4          -5.098e-01  1.074e+00  -0.475 0.638061    
W            5.498e+01  6.349e+01   0.866 0.392897    
I(M1^2)     -4.190e-04  6.568e-04  -0.638 0.528054    
I(M2^2)     -6.533e-04  9.365e-04  -0.698 0.490449    
M1:M2       -3.457e-03  1.584e-03  -2.182 0.036597 *  
M1:M3       -4.577e-04  9.150e-04  -0.500 0.620332    
M2:M3        1.748e-03  9.022e-04   1.937 0.061556 .  
M1:M4       -9.033e-04  6.129e-04  -1.474 0.150261    
M3:M4        2.587e-04  5.606e-04   0.461 0.647633    
M1:W        -2.614e-01  7.431e-02  -3.517 0.001329 ** 
M2:W        -1.764e-01  7.114e-02  -2.480 0.018576 *  
M3:W         7.704e-02  3.912e-02   1.969 0.057615 .  
M4:W         6.112e-02  3.711e-02   1.647 0.109374    
M1:M2:W      2.330e-04  6.104e-05   3.817 0.000584 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 140.2 on 32 degrees of freedom
Multiple R-squared:  0.8907,    Adjusted R-squared:  0.8326 
F-statistic: 15.33 on 17 and 32 DF,  p-value: 7.928e-11

> 
> model21b<-update(model20b, ~.-M3:M4)
> anova(model20b, model21b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     32 628781                           
2     33 632964 -1   -4183.1 0.2129 0.6476
> summary(model21b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-262.32  -84.98   -0.40   70.26  317.00 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.105e+02  1.708e+03  -0.123 0.902660    
M1           6.717e+00  2.125e+00   3.162 0.003355 ** 
M2           2.214e+00  1.950e+00   1.136 0.264314    
M3          -3.042e+00  1.248e+00  -2.438 0.020332 *  
M4          -3.127e-01  9.730e-01  -0.321 0.749966    
W            5.848e+01  6.228e+01   0.939 0.354537    
I(M1^2)     -4.543e-04  6.445e-04  -0.705 0.485819    
I(M2^2)     -8.008e-04  8.697e-04  -0.921 0.363862    
M1:M2       -3.331e-03  1.542e-03  -2.160 0.038142 *  
M1:M3       -5.259e-04  8.922e-04  -0.589 0.559610    
M2:M3        1.946e-03  7.837e-04   2.483 0.018278 *  
M1:M4       -7.535e-04  5.135e-04  -1.467 0.151742    
M1:W        -2.557e-01  7.242e-02  -3.531 0.001245 ** 
M2:W        -1.719e-01  6.962e-02  -2.470 0.018866 *  
M3:W         7.069e-02  3.618e-02   1.954 0.059222 .  
M4:W         5.761e-02  3.589e-02   1.605 0.117973    
M1:M2:W      2.299e-04  5.994e-05   3.835 0.000536 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 138.5 on 33 degrees of freedom
Multiple R-squared:  0.8899,    Adjusted R-squared:  0.8366 
F-statistic: 16.68 on 16 and 33 DF,  p-value: 2.086e-11

> 
> model22b<-update(model21b, ~.-M1:M3)
> anova(model21b, model22b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M2:M3 + 
    M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     33 632964                           
2     34 639627 -1   -6663.1 0.3474 0.5596
> summary(model22b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-261.98  -93.59    4.84   74.82  322.70 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  6.415e+01  1.628e+03   0.039  0.96879    
M1           6.169e+00  1.892e+00   3.261  0.00253 ** 
M2           2.523e+00  1.860e+00   1.356  0.18400    
M3          -3.343e+00  1.127e+00  -2.967  0.00547 ** 
M4          -2.540e-01  9.585e-01  -0.265  0.79259    
W            4.879e+01  5.949e+01   0.820  0.41781    
I(M1^2)     -3.935e-04  6.301e-04  -0.625  0.53642    
I(M2^2)     -6.751e-04  8.350e-04  -0.808  0.42442    
M1:M2       -3.468e-03  1.510e-03  -2.297  0.02789 *  
M2:M3        1.669e-03  6.210e-04   2.688  0.01106 *  
M1:M4       -8.331e-04  4.906e-04  -1.698  0.09862 .  
M1:W        -2.422e-01  6.804e-02  -3.560  0.00112 ** 
M2:W        -1.707e-01  6.891e-02  -2.477  0.01840 *  
M3:W         7.096e-02  3.582e-02   1.981  0.05576 .  
M4:W         6.012e-02  3.529e-02   1.703  0.09762 .  
M1:M2:W      2.215e-04  5.767e-05   3.841  0.00051 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 137.2 on 34 degrees of freedom
Multiple R-squared:  0.8888,    Adjusted R-squared:  0.8397 
F-statistic: 18.11 on 15 and 34 DF,  p-value: 5.611e-12

> 
> model23b<-update(model22b, ~.-I(M1^2))
> anova(model22b, model23b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M2:M3 + 
    M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M2^2) + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     34 639627                           
2     35 646966 -1   -7338.5 0.3901 0.5364
> summary(model23b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M2^2) + M1:M2 + M2:M3 + 
    M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-249.85  -86.29   -9.33   61.86  318.73 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  3.456e+02  1.550e+03   0.223 0.824869    
M1           5.680e+00  1.707e+00   3.327 0.002071 ** 
M2           2.537e+00  1.844e+00   1.376 0.177684    
M3          -3.266e+00  1.110e+00  -2.942 0.005755 ** 
M4          -3.518e-01  9.374e-01  -0.375 0.709718    
W            3.967e+01  5.716e+01   0.694 0.492306    
I(M2^2)     -4.278e-04  7.287e-04  -0.587 0.560927    
M1:M2       -3.930e-03  1.305e-03  -3.012 0.004796 ** 
M2:M3        1.664e-03  6.155e-04   2.704 0.010508 *  
M1:M4       -8.024e-04  4.839e-04  -1.658 0.106193    
M1:W        -2.327e-01  6.572e-02  -3.541 0.001152 ** 
M2:W        -1.646e-01  6.764e-02  -2.434 0.020168 *  
M3:W         6.705e-02  3.496e-02   1.918 0.063348 .  
M4:W         6.415e-02  3.439e-02   1.865 0.070556 .  
M1:M2:W      2.149e-04  5.619e-05   3.824 0.000518 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 136 on 35 degrees of freedom
Multiple R-squared:  0.8875,    Adjusted R-squared:  0.8425 
F-statistic: 19.72 on 14 and 35 DF,  p-value: 1.476e-12

> 
> model24b<-update(model23b, ~.-I(M2^2))
> anova(model23b, model24b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M2^2) + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     35 646966                           
2     36 653336 -1   -6370.7 0.3446 0.5609
> summary(model24b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-244.72  -79.47  -12.65   68.73  331.50 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.492e+02  1.527e+03   0.163 0.871337    
M1           6.069e+00  1.559e+00   3.892 0.000412 ***
M2           1.967e+00  1.554e+00   1.266 0.213694    
M3          -3.005e+00  1.008e+00  -2.980 0.005133 ** 
M4          -3.214e-01  9.274e-01  -0.347 0.730903    
W            4.249e+01  5.644e+01   0.753 0.456439    
M1:M2       -4.217e-03  1.198e-03  -3.518 0.001196 ** 
M2:M3        1.450e-03  4.913e-04   2.952 0.005528 ** 
M1:M4       -7.699e-04  4.763e-04  -1.616 0.114741    
M1:W        -2.396e-01  6.406e-02  -3.741 0.000637 ***
M2:W        -1.568e-01  6.570e-02  -2.387 0.022382 *  
M3:W         6.668e-02  3.464e-02   1.925 0.062178 .  
M4:W         6.069e-02  3.358e-02   1.808 0.079031 .  
M1:M2:W      2.161e-04  5.564e-05   3.883 0.000423 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 134.7 on 36 degrees of freedom
Multiple R-squared:  0.8864,    Adjusted R-squared:  0.8454 
F-statistic: 21.61 on 13 and 36 DF,  p-value: 3.629e-13

> 
> #testing step here
> model25bb<-step(model24b)
Start:  AIC=501.89
M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
<none>                 653336 501.89
- M1:M4    1     47416 700753 503.39
- M4:W     1     59298 712634 504.24
- M3:W     1     67241 720577 504.79
- M2:M3    1    158142 811479 510.73
- M1:M2:W  1    273650 926987 517.38
> anova(model25bb, model24b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq F Pr(>F)
1     36 653336                      
2     36 653336  0         0         
> summary(model25bb)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-244.72  -79.47  -12.65   68.73  331.50 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.492e+02  1.527e+03   0.163 0.871337    
M1           6.069e+00  1.559e+00   3.892 0.000412 ***
M2           1.967e+00  1.554e+00   1.266 0.213694    
M3          -3.005e+00  1.008e+00  -2.980 0.005133 ** 
M4          -3.214e-01  9.274e-01  -0.347 0.730903    
W            4.249e+01  5.644e+01   0.753 0.456439    
M1:M2       -4.217e-03  1.198e-03  -3.518 0.001196 ** 
M2:M3        1.450e-03  4.913e-04   2.952 0.005528 ** 
M1:M4       -7.699e-04  4.763e-04  -1.616 0.114741    
M1:W        -2.396e-01  6.406e-02  -3.741 0.000637 ***
M2:W        -1.568e-01  6.570e-02  -2.387 0.022382 *  
M3:W         6.668e-02  3.464e-02   1.925 0.062178 .  
M4:W         6.069e-02  3.358e-02   1.808 0.079031 .  
M1:M2:W      2.161e-04  5.564e-05   3.883 0.000423 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 134.7 on 36 degrees of freedom
Multiple R-squared:  0.8864,    Adjusted R-squared:  0.8454 
F-statistic: 21.61 on 13 and 36 DF,  p-value: 3.629e-13

> 
> 
> #decrease in adjusted RS
> model25b<-update(model24b, ~.-M1:M4)
> anova(model24b, model25b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     36 653336                           
2     37 700753 -1    -47416 2.6127 0.1147
> summary(model25b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + 
    M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-254.66  -74.64  -17.59   86.63  300.03 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  9.438e+02  1.497e+03   0.630 0.532366    
M1           4.950e+00  1.427e+00   3.468 0.001345 ** 
M2           2.973e+00  1.455e+00   2.043 0.048186 *  
M3          -2.605e+00  9.985e-01  -2.609 0.013037 *  
M4          -1.520e+00  5.692e-01  -2.670 0.011192 *  
W            2.586e+01  5.669e+01   0.456 0.650919    
M1:M2       -4.385e-03  1.220e-03  -3.595 0.000941 ***
M2:M3        1.168e-03  4.691e-04   2.490 0.017402 *  
M1:W        -2.093e-01  6.256e-02  -3.345 0.001895 ** 
M2:W        -1.844e-01  6.481e-02  -2.845 0.007200 ** 
M3:W         6.279e-02  3.530e-02   1.779 0.083496 .  
M4:W         7.506e-02  3.307e-02   2.269 0.029158 *  
M1:M2:W      2.144e-04  5.683e-05   3.773 0.000565 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 137.6 on 37 degrees of freedom
Multiple R-squared:  0.8782,    Adjusted R-squared:  0.8386 
F-statistic: 22.22 on 12 and 37 DF,  p-value: 2.507e-13

> 
> #decrease in adjusted RS
> model26b<-update(model25b, ~.-M3:W)
> anova(model25b, model26b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + M2:W + M4:W + 
    M1:M2:W
  Res.Df    RSS Df Sum of Sq     F Pr(>F)  
1     37 700753                            
2     38 760676 -1    -59924 3.164 0.0835 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model26b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + 
    M2:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-271.20  -73.25  -16.07   56.52  293.13 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  4.190e+02  1.509e+03   0.278 0.782827    
M1           4.759e+00  1.463e+00   3.253 0.002400 ** 
M2           2.948e+00  1.496e+00   1.971 0.056042 .  
M3          -1.137e+00  5.779e-01  -1.967 0.056488 .  
M4          -1.993e+00  5.173e-01  -3.852 0.000436 ***
W            4.268e+01  5.747e+01   0.743 0.462228    
M1:M2       -4.309e-03  1.253e-03  -3.439 0.001433 ** 
M2:M3        8.264e-04  4.400e-04   1.878 0.068058 .  
M1:W        -2.099e-01  6.431e-02  -3.263 0.002332 ** 
M2:W        -1.719e-01  6.624e-02  -2.595 0.013379 *  
M4:W         1.034e-01  2.981e-02   3.467 0.001322 ** 
M1:M2:W      2.206e-04  5.832e-05   3.782 0.000536 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 141.5 on 38 degrees of freedom
Multiple R-squared:  0.8677,    Adjusted R-squared:  0.8295 
F-statistic: 22.66 on 11 and 38 DF,  p-value: 2.195e-13

> 
> #decrease in adjusted RS
> model27b<-update(model26b, ~.-M2:M3)
> anova(model26b, model27b)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:W + M2:W + M4:W + 
    M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M1:W + M2:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  
1     38 760676                              
2     39 831284 -1    -70607 3.5272 0.06806 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model27b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M1:W + M2:W + 
    M4:W + M1:M2:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-312.328  -85.154   -3.108   41.655  307.345 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.687e+02  1.496e+03  -0.246  0.80663   
M1           3.606e+00  1.370e+00   2.631  0.01211 * 
M2           3.406e+00  1.523e+00   2.237  0.03108 * 
M3          -9.126e-02  1.599e-01  -0.571  0.57144   
M4          -1.708e+00  5.103e-01  -3.346  0.00182 **
W            5.242e+01  5.906e+01   0.888  0.38014   
M1:M2       -3.448e-03  1.203e-03  -2.865  0.00668 **
M1:W        -1.672e-01  6.209e-02  -2.693  0.01038 * 
M2:W        -1.771e-01  6.829e-02  -2.593  0.01331 * 
M4:W         8.844e-02  2.965e-02   2.983  0.00491 **
M1:M2:W      1.941e-04  5.839e-05   3.324  0.00194 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 146 on 39 degrees of freedom
Multiple R-squared:  0.8555,    Adjusted R-squared:  0.8184 
F-statistic: 23.08 on 10 and 39 DF,  p-value: 2.24e-13

> plot(model27b)
> #Conclusion: Terms are significant, but model is highly non-normal
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch C~~~~~~~~~~~~~~~~~~~~~~~
> 
> model18c<-step(model17)
Start:  AIC=513.77
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- I(M4^2)  1       217 626429 511.79
- I(M3^2)  1       716 626928 511.83
- M2:M4    1      2182 628393 511.94
- M3:M4    1      2492 628704 511.97
- M1:M3    1      4514 630726 512.13
- I(M1^2)  1      6068 632280 512.25
- I(M2^2)  1      9139 635350 512.50
- M1:M4    1     16819 643030 513.10
<none>                 626212 513.77
- M4:W     1     35809 662020 514.55
- M2:M3    1     39576 665788 514.84
- M3:W     1     51835 678046 515.75
- M1:M2:W  1    253859 880071 528.79

Step:  AIC=511.79
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + 
    M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- I(M3^2)  1       506 626934 509.83
- M2:M4    1      2294 628723 509.97
- M3:M4    1      5792 632221 510.25
- I(M1^2)  1      5852 632280 510.25
- M1:M3    1      6001 632429 510.27
- I(M2^2)  1      8964 635393 510.50
- M1:M4    1     16805 643234 511.11
<none>                 626429 511.79
- M2:M3    1     39368 665797 512.84
- M4:W     1     51693 678122 513.75
- M3:W     1     68203 694631 514.96
- M1:M2:W  1    257627 884056 527.01

Step:  AIC=509.83
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + 
    M1:M2:W

          Df Sum of Sq    RSS    AIC
- M2:M4    1      1847 628781 507.98
- I(M1^2)  1      5411 632345 508.26
- M3:M4    1      6026 632960 508.31
- M1:M3    1      6198 633133 508.32
- I(M2^2)  1      8617 635552 508.51
- M1:M4    1     17258 644192 509.19
<none>                 626934 509.83
- M4:W     1     51195 678129 511.75
- M3:W     1     70921 697855 513.19
- M2:M3    1     71544 698478 513.23
- M1:M2:W  1    279886 906820 526.28

Step:  AIC=507.98
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- M3:M4    1      4183 632964 506.31
- M1:M3    1      4917 633698 506.37
- I(M1^2)  1      7997 636778 506.61
- I(M2^2)  1      9563 638344 506.73
<none>                 628781 507.98
- M1:M4    1     42690 671471 509.26
- M4:W     1     53292 682073 510.04
- M2:M3    1     73760 702541 511.52
- M3:W     1     76212 704993 511.70
- M1:M2:W  1    286240 915021 524.73

Step:  AIC=506.31
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- M1:M3    1      6663 639627 504.83
- I(M1^2)  1      9531 642495 505.05
- I(M2^2)  1     16261 649225 505.58
<none>                 632964 506.31
- M1:M4    1     41300 674264 507.47
- M4:W     1     49424 682388 508.07
- M3:W     1     73233 706197 509.78
- M2:M3    1    118271 751236 512.87
- M1:M2:W  1    282093 915058 522.74

Step:  AIC=504.83
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + M1:M2 + M2:M3 + 
    M1:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- I(M1^2)  1      7338 646966 503.40
- I(M2^2)  1     12297 651925 503.78
<none>                 639627 504.83
- M1:M4    1     54247 693874 506.90
- M4:W     1     54585 694212 506.93
- M3:W     1     73806 713433 508.29
- M2:M3    1    135888 775516 512.46
- M1:M2:W  1    277504 917131 520.85

Step:  AIC=503.4
M ~ M1 + M2 + M3 + M4 + W + I(M2^2) + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
- I(M2^2)  1      6371 653336 501.89
<none>                 646966 503.40
- M1:M4    1     50833 697798 505.18
- M4:W     1     64307 711273 506.14
- M3:W     1     67974 714939 506.40
- M2:M3    1    135140 782106 510.89
- M1:M2:W  1    270299 917264 518.86

Step:  AIC=501.89
M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W

          Df Sum of Sq    RSS    AIC
<none>                 653336 501.89
- M1:M4    1     47416 700753 503.39
- M4:W     1     59298 712634 504.24
- M3:W     1     67241 720577 504.79
- M2:M3    1    158142 811479 510.73
- M1:M2:W  1    273650 926987 517.38
> anova(model17, model18c)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     29 626212                           
2     36 653336 -7    -27125 0.1795 0.9875
> summary(model18c)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-244.72  -79.47  -12.65   68.73  331.50 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.492e+02  1.527e+03   0.163 0.871337    
M1           6.069e+00  1.559e+00   3.892 0.000412 ***
M2           1.967e+00  1.554e+00   1.266 0.213694    
M3          -3.005e+00  1.008e+00  -2.980 0.005133 ** 
M4          -3.214e-01  9.274e-01  -0.347 0.730903    
W            4.249e+01  5.644e+01   0.753 0.456439    
M1:M2       -4.217e-03  1.198e-03  -3.518 0.001196 ** 
M2:M3        1.450e-03  4.913e-04   2.952 0.005528 ** 
M1:M4       -7.699e-04  4.763e-04  -1.616 0.114741    
M1:W        -2.396e-01  6.406e-02  -3.741 0.000637 ***
M2:W        -1.568e-01  6.570e-02  -2.387 0.022382 *  
M3:W         6.668e-02  3.464e-02   1.925 0.062178 .  
M4:W         6.069e-02  3.358e-02   1.808 0.079031 .  
M1:M2:W      2.161e-04  5.564e-05   3.883 0.000423 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 134.7 on 36 degrees of freedom
Multiple R-squared:  0.8864,    Adjusted R-squared:  0.8454 
F-statistic: 21.61 on 13 and 36 DF,  p-value: 3.629e-13

> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch D~~~~~~~~~~~~~~~~~~~~~~~
> #Method: Do not remove anything that decreases adjusted RS
> 
> model5d<-update(model4, ~.-M2:M3:M4)
> anova(model5d,model4)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + 
    M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     18 408843                           
2     17 405840  1    3002.6 0.1258 0.7272
> summary(model5d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-167.287  -66.083   -3.558   47.663  240.424 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  1.319e+04  1.237e+04   1.067   0.3002  
M1          -1.742e+01  1.805e+01  -0.965   0.3473  
M2          -2.090e+01  2.048e+01  -1.021   0.3210  
M3          -1.394e+01  1.692e+01  -0.824   0.4209  
M4          -3.582e+00  9.177e+00  -0.390   0.7008  
W           -1.198e+02  4.581e+02  -0.262   0.7967  
I(M1^2)      4.897e-04  8.995e-04   0.544   0.5929  
I(M2^2)      2.535e-04  1.551e-03   0.163   0.8720  
I(M3^2)      9.148e-04  2.054e-03   0.445   0.6614  
I(M4^2)      2.801e-03  2.007e-03   1.395   0.1799  
M1:M2        2.699e-02  1.945e-02   1.388   0.1822  
M1:M3        1.844e-02  1.863e-02   0.990   0.3355  
M2:M3        3.445e-02  1.794e-02   1.920   0.0708 .
M1:M4        1.930e-02  1.272e-02   1.517   0.1467  
M2:M4       -7.744e-03  1.121e-02  -0.691   0.4986  
M3:M4       -6.816e-03  7.329e-03  -0.930   0.3646  
M1:W         7.308e-01  6.235e-01   1.172   0.2564  
M2:W         1.952e-01  6.937e-01   0.281   0.7816  
M3:W         1.656e-01  6.953e-01   0.238   0.8145  
M4:W        -7.182e-01  5.156e-01  -1.393   0.1806  
M1:M2:M3    -3.452e-05  1.806e-05  -1.912   0.0720 .
M1:M2:M4    -1.364e-05  9.195e-06  -1.484   0.1552  
M1:M3:M4    -1.127e-05  9.225e-06  -1.221   0.2378  
M1:M2:W     -8.973e-04  7.610e-04  -1.179   0.2537  
M1:M3:W     -7.013e-04  6.885e-04  -1.019   0.3219  
M2:M3:W     -9.201e-04  7.782e-04  -1.182   0.2525  
M1:M4:W     -5.987e-04  3.280e-04  -1.825   0.0846 .
M2:M4:W      1.557e-03  1.030e-03   1.512   0.1479  
M3:M4:W      1.177e-03  6.735e-04   1.748   0.0975 .
M1:M2:M3:M4  1.409e-08  7.412e-09   1.901   0.0734 .
M1:M2:M3:W   1.309e-06  7.577e-07   1.728   0.1011  
M2:M3:M4:W  -1.174e-06  6.878e-07  -1.707   0.1051  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 150.7 on 18 degrees of freedom
Multiple R-squared:  0.9289,    Adjusted R-squared:  0.8065 
F-statistic: 7.587 on 31 and 18 DF,  p-value: 1.852e-05

> 
> model6d<-update(model5d, ~.-M3:W)
> anova(model5d, model6d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M3:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + 
    M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + 
    M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + 
    M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     18 408843                           
2     19 410131 -1   -1288.2 0.0567 0.8145
> summary(model6d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-171.753  -69.337   -2.565   55.721  237.015 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  1.151e+04  9.885e+03   1.164   0.2588  
M1          -1.588e+01  1.643e+01  -0.966   0.3459  
M2          -1.950e+01  1.913e+01  -1.020   0.3207  
M3          -1.065e+01  9.520e+00  -1.118   0.2774  
M4          -4.441e+00  8.227e+00  -0.540   0.5956  
W           -2.938e+01  2.499e+02  -0.118   0.9076  
I(M1^2)      5.085e-04  8.734e-04   0.582   0.5673  
I(M2^2)      1.307e-04  1.426e-03   0.092   0.9279  
I(M3^2)      8.328e-04  1.974e-03   0.422   0.6779  
I(M4^2)      2.786e-03  1.956e-03   1.424   0.1706  
M1:M2        2.525e-02  1.757e-02   1.437   0.1670  
M1:M3        1.644e-02  1.621e-02   1.014   0.3234  
M2:M3        3.185e-02  1.388e-02   2.294   0.0333 *
M1:M4        1.957e-02  1.235e-02   1.584   0.1296  
M2:M4       -6.514e-03  9.702e-03  -0.671   0.5100  
M3:M4       -7.298e-03  6.867e-03  -1.063   0.3012  
M1:W         6.447e-01  4.950e-01   1.302   0.2083  
M2:W         1.177e-01  5.972e-01   0.197   0.8458  
M4:W        -6.934e-01  4.923e-01  -1.409   0.1751  
M1:M2:M3    -3.251e-05  1.557e-05  -2.088   0.0505 .
M1:M2:M4    -1.378e-05  8.946e-06  -1.540   0.1400  
M1:M3:M4    -1.137e-05  8.982e-06  -1.266   0.2207  
M1:M2:W     -7.952e-04  6.130e-04  -1.297   0.2101  
M1:M3:W     -6.045e-04  5.417e-04  -1.116   0.2784  
M2:M3:W     -7.711e-04  4.512e-04  -1.709   0.1038  
M1:M4:W     -5.991e-04  3.198e-04  -1.874   0.0765 .
M2:M4:W      1.500e-03  9.770e-04   1.536   0.1411  
M3:M4:W      1.220e-03  6.329e-04   1.928   0.0690 .
M1:M2:M3:M4  1.416e-08  7.220e-09   1.962   0.0646 .
M1:M2:M3:W   1.200e-06  5.889e-07   2.038   0.0557 .
M2:M3:M4:W  -1.183e-06  6.694e-07  -1.768   0.0932 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 146.9 on 19 degrees of freedom
Multiple R-squared:  0.9287,    Adjusted R-squared:  0.8161 
F-statistic: 8.248 on 30 and 19 DF,  p-value: 6.411e-06

> 
> model7d<-update(model6d, ~.-I(M2^2))
> anova(model6d, model7d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + 
    M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + 
    M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + 
    M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M4:W + 
    M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + 
    M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + 
    M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     19 410131                           
2     20 410312 -1    -181.4 0.0084 0.9279
> summary(model7d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + 
    I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + 
    M1:W + M2:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + 
    M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-175.637  -68.413   -2.691   53.673  234.235 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  1.130e+04  9.391e+03   1.204   0.2428  
M1          -1.586e+01  1.602e+01  -0.990   0.3339  
M2          -1.886e+01  1.734e+01  -1.088   0.2897  
M3          -1.053e+01  9.201e+00  -1.145   0.2659  
M4          -4.461e+00  8.018e+00  -0.556   0.5842  
W           -2.647e+01  2.417e+02  -0.110   0.9139  
I(M1^2)      4.773e-04  7.840e-04   0.609   0.5495  
I(M3^2)      7.814e-04  1.845e-03   0.423   0.6765  
I(M4^2)      2.751e-03  1.870e-03   1.471   0.1568  
M1:M2        2.481e-02  1.649e-02   1.505   0.1480  
M1:M3        1.642e-02  1.580e-02   1.039   0.3113  
M2:M3        3.141e-02  1.271e-02   2.472   0.0226 *
M1:M4        1.953e-02  1.204e-02   1.623   0.1203  
M2:M4       -6.427e-03  9.412e-03  -0.683   0.5026  
M3:M4       -7.233e-03  6.659e-03  -1.086   0.2903  
M1:W         6.382e-01  4.776e-01   1.336   0.1965  
M2:W         1.026e-01  5.595e-01   0.183   0.8564  
M4:W        -6.793e-01  4.559e-01  -1.490   0.1518  
M1:M2:M3    -3.205e-05  1.436e-05  -2.233   0.0372 *
M1:M2:M4    -1.364e-05  8.589e-06  -1.588   0.1280  
M1:M3:M4    -1.135e-05  8.753e-06  -1.297   0.2094  
M1:M2:W     -7.700e-04  5.342e-04  -1.442   0.1649  
M1:M3:W     -6.013e-04  5.271e-04  -1.141   0.2674  
M2:M3:W     -7.579e-04  4.170e-04  -1.818   0.0841 .
M1:M4:W     -5.974e-04  3.112e-04  -1.920   0.0693 .
M2:M4:W      1.476e-03  9.146e-04   1.613   0.1224  
M3:M4:W      1.207e-03  6.012e-04   2.008   0.0584 .
M1:M2:M3:M4  1.402e-08  6.869e-09   2.041   0.0547 .
M1:M2:M3:W   1.180e-06  5.313e-07   2.221   0.0381 *
M2:M3:M4:W  -1.164e-06  6.194e-07  -1.879   0.0749 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 143.2 on 20 degrees of freedom
Multiple R-squared:  0.9287,    Adjusted R-squared:  0.8252 
F-statistic: 8.977 on 29 and 20 DF,  p-value: 2.085e-06

> 
> model8d<-update(model7d, ~.-M2:W)
> anova(model7d, model8d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M2:W + M4:W + 
    M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + 
    M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + 
    M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     20 410312                           
2     21 411002 -1   -689.41 0.0336 0.8564
> summary(model8d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + 
    I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + 
    M1:W + M4:W + M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + 
    M1:M2:M3:W + M2:M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-173.339  -68.608   -8.449   51.754  239.608 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  1.051e+04  8.151e+03   1.290   0.2111  
M1          -1.542e+01  1.547e+01  -0.997   0.3302  
M2          -1.631e+01  1.013e+01  -1.610   0.1224  
M3          -1.115e+01  8.367e+00  -1.332   0.1971  
M4          -4.417e+00  7.828e+00  -0.564   0.5785  
W            1.023e+01  1.322e+02   0.077   0.9391  
I(M1^2)      5.207e-04  7.300e-04   0.713   0.4835  
I(M3^2)      9.085e-04  1.670e-03   0.544   0.5922  
I(M4^2)      2.840e-03  1.763e-03   1.611   0.1222  
M1:M2        2.348e-02  1.445e-02   1.624   0.1192  
M1:M3        1.646e-02  1.543e-02   1.067   0.2983  
M2:M3        3.050e-02  1.141e-02   2.672   0.0143 *
M1:M4        1.962e-02  1.175e-02   1.671   0.1096  
M2:M4       -7.817e-03  5.445e-03  -1.436   0.1658  
M3:M4       -6.344e-03  4.457e-03  -1.423   0.1693  
M1:W         6.256e-01  4.616e-01   1.355   0.1897  
M4:W        -6.881e-01  4.428e-01  -1.554   0.1351  
M1:M2:M3    -3.145e-05  1.365e-05  -2.304   0.0315 *
M1:M2:M4    -1.320e-05  8.065e-06  -1.637   0.1165  
M1:M3:M4    -1.178e-05  8.236e-06  -1.431   0.1672  
M1:M2:W     -7.336e-04  4.844e-04  -1.514   0.1448  
M1:M3:W     -5.801e-04  5.022e-04  -1.155   0.2611  
M2:M3:W     -7.057e-04  2.972e-04  -2.375   0.0272 *
M1:M4:W     -6.132e-04  2.920e-04  -2.099   0.0480 *
M2:M4:W      1.542e-03  8.197e-04   1.881   0.0739 .
M3:M4:W      1.186e-03  5.762e-04   2.058   0.0522 .
M1:M2:M3:M4  1.413e-08  6.683e-09   2.114   0.0466 *
M1:M2:M3:W   1.145e-06  4.851e-07   2.361   0.0280 *
M2:M3:M4:W  -1.181e-06  5.984e-07  -1.973   0.0618 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 139.9 on 21 degrees of freedom
Multiple R-squared:  0.9285,    Adjusted R-squared:  0.8333 
F-statistic: 9.745 on 28 and 21 DF,  p-value: 6.588e-07

> 
> model9d<-update(model8d, ~.-I(M3^2))
> anova(model8d, model9d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M1:M2 + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     21 411002                           
2     22 416793 -1   -5791.8 0.2959 0.5922
> summary(model9d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M4^2) + 
    M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + 
    M1:M2:M3 + M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + 
    M1:M4:W + M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + 
    M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-194.78  -61.03  -14.05   62.90  218.44 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  1.021e+04  8.001e+03   1.277   0.2151  
M1          -1.555e+01  1.521e+01  -1.022   0.3178  
M2          -1.448e+01  9.404e+00  -1.540   0.1378  
M3          -1.190e+01  8.120e+00  -1.465   0.1571  
M4          -3.401e+00  7.479e+00  -0.455   0.6537  
W            4.468e+00  1.297e+02   0.034   0.9728  
I(M1^2)      5.365e-04  7.176e-04   0.748   0.4626  
I(M4^2)      2.147e-03  1.199e-03   1.790   0.0872 .
M1:M2        2.102e-02  1.351e-02   1.556   0.1339  
M1:M3        1.839e-02  1.478e-02   1.245   0.2263  
M2:M3        2.894e-02  1.087e-02   2.662   0.0142 *
M1:M4        1.812e-02  1.123e-02   1.613   0.1209  
M2:M4       -7.256e-03  5.260e-03  -1.379   0.1816  
M3:M4       -5.123e-03  3.788e-03  -1.352   0.1900  
M1:W         5.987e-01  4.515e-01   1.326   0.1985  
M4:W        -6.369e-01  4.257e-01  -1.496   0.1488  
M1:M2:M3    -3.017e-05  1.323e-05  -2.281   0.0326 *
M1:M2:M4    -1.163e-05  7.407e-06  -1.570   0.1307  
M1:M3:M4    -1.198e-05  8.095e-06  -1.480   0.1530  
M1:M2:W     -6.440e-04  4.482e-04  -1.437   0.1648  
M1:M3:W     -6.096e-04  4.912e-04  -1.241   0.2276  
M2:M3:W     -6.331e-04  2.613e-04  -2.423   0.0241 *
M1:M4:W     -5.523e-04  2.655e-04  -2.081   0.0493 *
M2:M4:W      1.319e-03  6.985e-04   1.889   0.0722 .
M3:M4:W      1.158e-03  5.646e-04   2.050   0.0524 .
M1:M2:M3:M4  1.329e-08  6.397e-09   2.077   0.0497 *
M1:M2:M3:W   1.072e-06  4.582e-07   2.338   0.0289 *
M2:M3:M4:W  -1.071e-06  5.544e-07  -1.932   0.0663 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 137.6 on 22 degrees of freedom
Multiple R-squared:  0.9275,    Adjusted R-squared:  0.8386 
F-statistic: 10.43 on 27 and 22 DF,  p-value: 2.269e-07

> 
> #Highest known adjusted RS
> model10d<-step(model9d)
Start:  AIC=507.42
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W

              Df Sum of Sq    RSS    AIC
- I(M1^2)      1     10589 427383 506.67
<none>                     416793 507.42
- I(M4^2)      1     60707 477500 512.21
- M2:M3:M4:W   1     70715 487509 513.25
- M1:M2:M3:M4  1     81741 498534 514.37
- M1:M4:W      1     82022 498815 514.40
- M1:M2:M3:W   1    103593 520386 516.52

Step:  AIC=506.67
M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + 
    M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W

              Df Sum of Sq    RSS    AIC
<none>                     427383 506.67
- I(M4^2)      1     55748 483130 510.80
- M2:M3:M4:W   1     70892 498274 512.34
- M1:M4:W      1     71593 498976 512.41
- M1:M2:M3:M4  1     76008 503391 512.85
- M1:M2:M3:W   1     95932 523314 514.80
> anova(model9d,model10d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + 
    M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1     22 416793                           
2     23 427383 -1    -10589 0.5589 0.4626
> summary(model10d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-208.49  -68.07  -19.81   58.62  243.18 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept)  9.217e+03  7.813e+03   1.180   0.2502  
M1          -1.158e+01  1.412e+01  -0.820   0.4205  
M2          -1.549e+01  9.217e+00  -1.681   0.1064  
M3          -1.157e+01  8.030e+00  -1.441   0.1631  
M4          -2.547e+00  7.320e+00  -0.348   0.7311  
W            3.950e+01  1.197e+02   0.330   0.7444  
I(M4^2)      2.044e-03  1.180e-03   1.732   0.0967 .
M1:M2        2.060e-02  1.337e-02   1.541   0.1370  
M1:M3        1.619e-02  1.434e-02   1.129   0.2704  
M2:M3        2.819e-02  1.072e-02   2.630   0.0150 *
M1:M4        1.560e-02  1.061e-02   1.470   0.1550  
M2:M4       -6.992e-03  5.198e-03  -1.345   0.1917  
M3:M4       -4.587e-03  3.684e-03  -1.245   0.2256  
M1:W         4.793e-01  4.183e-01   1.146   0.2636  
M4:W        -6.489e-01  4.213e-01  -1.540   0.1371  
M1:M2:M3    -2.888e-05  1.299e-05  -2.224   0.0363 *
M1:M2:M4    -1.099e-05  7.287e-06  -1.508   0.1451  
M1:M3:M4    -1.077e-05  7.853e-06  -1.371   0.1836  
M1:M2:W     -6.198e-04  4.427e-04  -1.400   0.1748  
M1:M3:W     -5.335e-04  4.759e-04  -1.121   0.2738  
M2:M3:W     -5.817e-04  2.497e-04  -2.330   0.0289 *
M1:M4:W     -4.894e-04  2.493e-04  -1.963   0.0619 .
M2:M4:W      1.324e-03  6.918e-04   1.915   0.0681 .
M3:M4:W      1.089e-03  5.517e-04   1.974   0.0605 .
M1:M2:M3:M4  1.272e-08  6.291e-09   2.022   0.0549 .
M1:M2:M3:W   1.019e-06  4.484e-07   2.272   0.0327 *
M2:M3:M4:W  -1.073e-06  5.491e-07  -1.953   0.0631 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 136.3 on 23 degrees of freedom
Multiple R-squared:  0.9257,    Adjusted R-squared:  0.8417 
F-statistic: 11.02 on 26 and 23 DF,  p-value: 8.568e-08

> 
> model11d<-update(model10d, ~.-M2:M3:M4:W)
> anova(model10d, model11d)
Analysis of Variance Table

Model 1: M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + 
    M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W + M2:M3:M4:W
Model 2: M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + 
    M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + M1:M2:M4 + 
    M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  
1     23 427383                              
2     24 498274 -1    -70892 3.8151 0.06306 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(model11d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M2:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-200.522  -68.396    1.045   43.491  267.115 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -2.144e+03  5.514e+03  -0.389   0.7009  
M1           3.106e+00  1.263e+01   0.246   0.8078  
M2           4.158e-01  4.563e+00   0.091   0.9282  
M3           8.024e-01  5.216e+00   0.154   0.8790  
M4          -4.190e-01  7.651e+00  -0.055   0.9568  
W            5.342e+01  1.263e+02   0.423   0.6762  
I(M4^2)      7.482e-04  1.031e-03   0.725   0.4752  
M1:M2       -2.622e-04  8.495e-03  -0.031   0.9756  
M1:M3       -1.445e-03  1.178e-02  -0.123   0.9034  
M2:M3        8.819e-03  4.298e-03   2.052   0.0512 .
M1:M4        6.170e-03  9.990e-03   0.618   0.5426  
M2:M4       -4.553e-03  5.333e-03  -0.854   0.4017  
M3:M4       -3.102e-03  3.810e-03  -0.814   0.4235  
M1:W        -1.082e-01  3.073e-01  -0.352   0.7280  
M4:W         7.797e-02  2.088e-01   0.373   0.7121  
M1:M2:M3    -5.110e-06  4.797e-06  -1.065   0.2973  
M1:M2:M4    -1.300e-06  5.641e-06  -0.230   0.8197  
M1:M3:M4    -2.014e-06  6.817e-06  -0.295   0.7702  
M1:M2:W      8.826e-05  2.686e-04   0.329   0.7453  
M1:M3:W      1.079e-04  3.641e-04   0.296   0.7696  
M2:M3:W     -4.668e-04  2.565e-04  -1.820   0.0812 .
M1:M4:W     -3.207e-04  2.472e-04  -1.297   0.2068  
M2:M4:W      1.839e-04  3.921e-04   0.469   0.6432  
M3:M4:W      1.566e-04  2.923e-04   0.536   0.5971  
M1:M2:M3:M4  1.839e-09  3.086e-09   0.596   0.5568  
M1:M2:M3:W   2.089e-07  1.803e-07   1.158   0.2581  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.1 on 24 degrees of freedom
Multiple R-squared:  0.9134,    Adjusted R-squared:  0.8231 
F-statistic: 10.12 on 25 and 24 DF,  p-value: 1.322e-07

> 
> model12d<-update(model11d, ~.-M2:M4:W)
> summary(model12d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-193.079  -62.540    1.874   53.065  268.145 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -1.795e+03  5.378e+03  -0.334   0.7414  
M1           2.427e+00  1.235e+01   0.196   0.8458  
M2           1.414e+00  3.974e+00   0.356   0.7250  
M3          -6.496e-01  4.133e+00  -0.157   0.8764  
M4          -7.802e-01  7.492e+00  -0.104   0.9179  
W            5.467e+01  1.243e+02   0.440   0.6639  
I(M4^2)      7.444e-04  1.015e-03   0.733   0.4702  
M1:M2       -1.730e-03  7.774e-03  -0.222   0.8258  
M1:M3        2.346e-03  8.431e-03   0.278   0.7831  
M2:M3        7.480e-03  3.164e-03   2.364   0.0261 *
M1:M4        5.395e-03  9.697e-03   0.556   0.5829  
M2:M4       -2.606e-03  3.296e-03  -0.791   0.4366  
M3:M4       -3.177e-03  3.747e-03  -0.848   0.4045  
M1:W        -1.126e-01  3.023e-01  -0.372   0.7128  
M4:W         8.232e-02  2.053e-01   0.401   0.6918  
M1:M2:M3    -5.419e-06  4.677e-06  -1.159   0.2576  
M1:M2:M4    -8.568e-07  5.474e-06  -0.157   0.8769  
M1:M3:M4    -3.318e-06  6.127e-06  -0.542   0.5929  
M1:M2:W      1.518e-04  2.283e-04   0.665   0.5120  
M1:M3:W     -3.020e-05  2.110e-04  -0.143   0.8874  
M2:M3:W     -3.816e-04  1.783e-04  -2.141   0.0422 *
M1:M4:W     -2.336e-04  1.606e-04  -1.454   0.1583  
M3:M4:W      2.414e-04  2.260e-04   1.068   0.2957  
M1:M2:M3:M4  2.088e-09  2.992e-09   0.698   0.4917  
M1:M2:M3:W   2.077e-07  1.775e-07   1.170   0.2530  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 141.8 on 25 degrees of freedom
Multiple R-squared:  0.9126,    Adjusted R-squared:  0.8286 
F-statistic: 10.87 on 24 and 25 DF,  p-value: 4.312e-08

> 
> model13d<-update(model12d, ~.-M1:M3:W)
> summary(model13d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:M4 + M1:M3:M4 + M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.479  -63.176   -1.447   51.700  266.894 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -2.175e+03  4.588e+03  -0.474   0.6395  
M1           3.927e+00  6.407e+00   0.613   0.5453  
M2           1.406e+00  3.898e+00   0.361   0.7212  
M3          -6.500e-01  4.054e+00  -0.160   0.8739  
M4          -3.217e-01  6.644e+00  -0.048   0.9618  
W            6.174e+01  1.119e+02   0.552   0.5859  
I(M4^2)      7.120e-04  9.707e-04   0.733   0.4698  
M1:M2       -2.569e-03  5.006e-03  -0.513   0.6121  
M1:M3        1.345e-03  4.618e-03   0.291   0.7732  
M2:M3        7.579e-03  3.028e-03   2.503   0.0189 *
M1:M4        4.375e-03  6.449e-03   0.678   0.5035  
M2:M4       -2.734e-03  3.112e-03  -0.879   0.3877  
M3:M4       -3.235e-03  3.654e-03  -0.885   0.3840  
M1:W        -1.523e-01  1.179e-01  -1.292   0.2078  
M4:W         8.484e-02  2.006e-01   0.423   0.6758  
M1:M2:M3    -4.849e-06  2.407e-06  -2.014   0.0544 .
M1:M2:M4    -2.987e-07  3.768e-06  -0.079   0.9374  
M1:M3:M4    -2.692e-06  4.205e-06  -0.640   0.5277  
M1:M2:W      1.733e-04  1.689e-04   1.026   0.3144  
M2:M3:W     -3.796e-04  1.744e-04  -2.177   0.0387 *
M1:M4:W     -2.300e-04  1.556e-04  -1.478   0.1514  
M3:M4:W      2.327e-04  2.135e-04   1.090   0.2859  
M1:M2:M3:M4  1.751e-09  1.807e-09   0.969   0.3416  
M1:M2:M3:W   1.888e-07  1.165e-07   1.620   0.1172  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 139.1 on 26 degrees of freedom
Multiple R-squared:  0.9125,    Adjusted R-squared:  0.8351 
F-statistic: 11.79 on 23 and 26 DF,  p-value: 1.234e-08

> 
> model14d<-update(model13d, ~.-M1:M2:M4)
> summary(model14d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M3:M4 + M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + M1:M2:M3:M4 + 
    M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.175  -62.876   -1.219   52.251  266.926 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -2.341e+03  4.007e+03  -0.584  0.56394   
M1           4.270e+00  4.638e+00   0.920  0.36546   
M2           1.482e+00  3.709e+00   0.400  0.69261   
M3          -7.594e-01  3.741e+00  -0.203  0.84066   
M4           1.175e-02  5.047e+00   0.002  0.99816   
W            6.432e+01  1.051e+02   0.612  0.54570   
I(M4^2)      7.055e-04  9.493e-04   0.743  0.46379   
M1:M2       -2.872e-03  3.164e-03  -0.908  0.37192   
M1:M3        1.314e-03  4.515e-03   0.291  0.77334   
M2:M3        7.700e-03  2.568e-03   2.998  0.00577 **
M1:M4        4.015e-03  4.496e-03   0.893  0.37982   
M2:M4       -2.913e-03  2.099e-03  -1.388  0.17647   
M3:M4       -3.339e-03  3.347e-03  -0.998  0.32736   
M1:W        -1.560e-01  1.063e-01  -1.468  0.15379   
M4:W         8.043e-02  1.892e-01   0.425  0.67406   
M1:M2:M3    -4.790e-06  2.249e-06  -2.130  0.04243 * 
M1:M3:M4    -2.558e-06  3.783e-06  -0.676  0.50458   
M1:M2:W      1.788e-04  1.507e-04   1.186  0.24578   
M2:M3:W     -3.816e-04  1.694e-04  -2.252  0.03263 * 
M1:M4:W     -2.326e-04  1.494e-04  -1.556  0.13129   
M3:M4:W      2.390e-04  1.943e-04   1.230  0.22925   
M1:M2:M3:M4  1.650e-09  1.260e-09   1.310  0.20133   
M1:M2:M3:W   1.867e-07  1.115e-07   1.675  0.10557   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 136.5 on 27 degrees of freedom
Multiple R-squared:  0.9125,    Adjusted R-squared:  0.8412 
F-statistic: 12.79 on 22 and 27 DF,  p-value: 3.369e-09

> 
> model15d<-update(model14d, ~.-M1:M3:M4)
> summary(model15d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M4:W + M1:M2:M3 + 
    M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.818  -72.771   -7.642   48.647  280.619 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.071e+03  3.821e+03  -0.804  0.42838   
M1           6.319e+00  3.478e+00   1.817  0.07994 . 
M2           4.423e-02  3.010e+00   0.015  0.98838   
M3           9.053e-01  2.790e+00   0.324  0.74800   
M4           1.009e+00  4.780e+00   0.211  0.83441   
W            6.868e+01  1.039e+02   0.661  0.51391   
I(M4^2)      7.504e-04  9.378e-04   0.800  0.43034   
M1:M2       -2.433e-03  3.066e-03  -0.794  0.43409   
M1:M3       -1.149e-03  2.645e-03  -0.434  0.66732   
M2:M3        7.434e-03  2.513e-03   2.958  0.00623 **
M1:M4        1.577e-03  2.662e-03   0.592  0.55835   
M2:M4       -1.921e-03  1.487e-03  -1.292  0.20682   
M3:M4       -4.629e-03  2.725e-03  -1.699  0.10048   
M1:W        -1.770e-01  1.007e-01  -1.758  0.08966 . 
M4:W         8.510e-02  1.872e-01   0.455  0.65290   
M1:M2:M3    -4.149e-06  2.019e-06  -2.055  0.04936 * 
M1:M2:W      1.654e-04  1.480e-04   1.118  0.27311   
M2:M3:W     -3.385e-04  1.554e-04  -2.178  0.03801 * 
M1:M4:W     -1.996e-04  1.399e-04  -1.427  0.16469   
M3:M4:W      1.899e-04  1.784e-04   1.064  0.29642   
M1:M2:M3:M4  9.081e-10  6.135e-10   1.480  0.14998   
M1:M2:M3:W   1.835e-07  1.103e-07   1.663  0.10751   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 135.2 on 28 degrees of freedom
Multiple R-squared:  0.911,     Adjusted R-squared:  0.8442 
F-statistic: 13.65 on 21 and 28 DF,  p-value: 1.098e-09

> 
> model16d<-update(model15d, ~.-M4:W)
> summary(model16d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M1:M4 + M2:M4 + M3:M4 + M1:W + M1:M2:M3 + M1:M2:W + 
    M2:M3:W + M1:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-197.85  -65.64  -11.69   53.17  285.44 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.310e+03  3.732e+03  -0.887  0.38253   
M1           6.258e+00  3.427e+00   1.826  0.07818 . 
M2          -4.614e-01  2.758e+00  -0.167  0.86830   
M3           2.573e-01  2.365e+00   0.109  0.91413   
M4           3.024e+00  1.766e+00   1.713  0.09748 . 
W            9.862e+01  7.923e+01   1.245  0.22321   
I(M4^2)      5.528e-04  8.195e-04   0.675  0.50531   
M1:M2       -2.456e-03  3.023e-03  -0.812  0.42317   
M1:M3       -5.761e-04  2.293e-03  -0.251  0.80342   
M2:M3        7.769e-03  2.370e-03   3.278  0.00272 **
M1:M4        8.922e-04  2.165e-03   0.412  0.68325   
M2:M4       -1.936e-03  1.466e-03  -1.321  0.19694   
M3:M4       -5.344e-03  2.193e-03  -2.437  0.02118 * 
M1:W        -1.950e-01  9.120e-02  -2.138  0.04104 * 
M1:M2:M3    -4.063e-06  1.983e-06  -2.049  0.04961 * 
M1:M2:W      1.959e-04  1.301e-04   1.506  0.14282   
M2:M3:W     -3.349e-04  1.531e-04  -2.188  0.03689 * 
M1:M4:W     -1.741e-04  1.264e-04  -1.377  0.17890   
M3:M4:W      2.389e-04  1.401e-04   1.705  0.09883 . 
M1:M2:M3:M4  9.674e-10  5.912e-10   1.636  0.11255   
M1:M2:M3:W   1.497e-07  8.058e-08   1.858  0.07330 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 133.3 on 29 degrees of freedom
Multiple R-squared:  0.9103,    Adjusted R-squared:  0.8485 
F-statistic: 14.72 on 20 and 29 DF,  p-value: 3.068e-10

> 
> model17d<-update(model16d, ~.-M1:M4)
> summary(model17d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M1:M3 + 
    M2:M3 + M2:M4 + M3:M4 + M1:W + M1:M2:M3 + M1:M2:W + M2:M3:W + 
    M1:M4:W + M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-192.974  -66.050   -7.497   53.968  283.449 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.387e+03  3.676e+03  -0.921  0.36417   
M1           6.249e+00  3.379e+00   1.849  0.07432 . 
M2          -6.587e-01  2.678e+00  -0.246  0.80739   
M3           1.902e-01  2.327e+00   0.082  0.93539   
M4           3.365e+00  1.538e+00   2.188  0.03663 * 
W            1.017e+02  7.778e+01   1.308  0.20089   
I(M4^2)      6.543e-04  7.708e-04   0.849  0.40266   
M1:M2       -1.712e-03  2.391e-03  -0.716  0.47953   
M1:M3       -2.641e-04  2.134e-03  -0.124  0.90237   
M2:M3        7.425e-03  2.188e-03   3.394  0.00195 **
M2:M4       -2.086e-03  1.401e-03  -1.489  0.14686   
M3:M4       -4.913e-03  1.900e-03  -2.585  0.01483 * 
M1:W        -2.028e-01  8.801e-02  -2.304  0.02833 * 
M1:M2:M3    -4.381e-06  1.801e-06  -2.432  0.02117 * 
M1:M2:W      1.644e-04  1.038e-04   1.584  0.12357   
M2:M3:W     -2.905e-04  1.073e-04  -2.709  0.01105 * 
M1:M4:W     -1.281e-04  5.863e-05  -2.185  0.03679 * 
M3:M4:W      1.883e-04  6.661e-05   2.827  0.00828 **
M1:M2:M3:M4  1.096e-09  4.958e-10   2.210  0.03490 * 
M1:M2:M3:W   1.457e-07  7.886e-08   1.847  0.07460 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 131.5 on 30 degrees of freedom
Multiple R-squared:  0.9098,    Adjusted R-squared:  0.8527 
F-statistic: 15.93 on 19 and 30 DF,  p-value: 8.109e-11

> 
> model18d<-update(model17d, ~.-M1:M3)
> summary(model18d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M1:M2 + M2:M3 + 
    M2:M4 + M3:M4 + M1:W + M1:M2:M3 + M1:M2:W + M2:M3:W + M1:M4:W + 
    M3:M4:W + M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-193.017  -65.857   -8.387   54.623  281.421 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.031e+03  2.246e+03  -1.350 0.186925    
M1           5.899e+00  1.814e+00   3.252 0.002762 ** 
M2          -9.120e-01  1.699e+00  -0.537 0.595256    
M3          -3.949e-02  1.380e+00  -0.029 0.977351    
M4           3.459e+00  1.314e+00   2.632 0.013113 *  
W            9.453e+01  5.088e+01   1.858 0.072687 .  
I(M4^2)      6.464e-04  7.558e-04   0.855 0.398994    
M1:M2       -1.554e-03  1.989e-03  -0.781 0.440530    
M2:M3        7.529e-03  1.988e-03   3.787 0.000658 ***
M2:M4       -2.072e-03  1.374e-03  -1.508 0.141618    
M3:M4       -4.986e-03  1.777e-03  -2.806 0.008584 ** 
M1:W        -1.965e-01  7.062e-02  -2.782 0.009111 ** 
M1:M2:M3    -4.480e-06  1.584e-06  -2.828 0.008128 ** 
M1:M2:W      1.685e-04  9.676e-05   1.741 0.091536 .  
M2:M3:W     -2.847e-04  9.486e-05  -3.002 0.005268 ** 
M1:M4:W     -1.317e-04  5.008e-05  -2.631 0.013157 *  
M3:M4:W      1.898e-04  6.452e-05   2.942 0.006127 ** 
M1:M2:M3:M4  1.117e-09  4.573e-10   2.443 0.020473 *  
M1:M2:M3:W   1.389e-07  5.581e-08   2.489 0.018399 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 129.4 on 31 degrees of freedom
Multiple R-squared:  0.9098,    Adjusted R-squared:  0.8574 
F-statistic: 17.36 on 18 and 31 DF,  p-value: 1.908e-11

> 
> model19d<-update(model18d, ~.-M1:M2)
> summary(model19d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M4^2) + M2:M3 + M2:M4 + 
    M3:M4 + M1:W + M1:M2:M3 + M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-187.409  -71.803   -6.397   64.219  290.440 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.532e+03  2.140e+03  -1.183 0.245456    
M1           4.740e+00  1.037e+00   4.569 6.92e-05 ***
M2          -1.165e+00  1.658e+00  -0.703 0.487096    
M3          -3.689e-01  1.306e+00  -0.282 0.779384    
M4           3.725e+00  1.262e+00   2.952 0.005863 ** 
W            8.055e+01  4.734e+01   1.702 0.098515 .  
I(M4^2)      5.691e-04  7.447e-04   0.764 0.450369    
M2:M3        7.590e-03  1.974e-03   3.844 0.000541 ***
M2:M4       -2.649e-03  1.150e-03  -2.303 0.027933 *  
M3:M4       -4.332e-03  1.558e-03  -2.781 0.009005 ** 
M1:W        -1.563e-01  4.817e-02  -3.245 0.002750 ** 
M1:M2:M3    -5.193e-06  1.287e-06  -4.034 0.000318 ***
M1:M2:W      1.069e-04  5.568e-05   1.919 0.063922 .  
M2:M3:W     -2.467e-04  8.095e-05  -3.048 0.004594 ** 
M1:M4:W     -1.133e-04  4.391e-05  -2.580 0.014659 *  
M3:M4:W      1.529e-04  4.363e-05   3.503 0.001381 ** 
M1:M2:M3:M4  1.209e-09  4.392e-10   2.752 0.009673 ** 
M1:M2:M3:W   1.537e-07  5.216e-08   2.948 0.005937 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 128.6 on 32 degrees of freedom
Multiple R-squared:  0.908,     Adjusted R-squared:  0.8591 
F-statistic: 18.58 on 17 and 32 DF,  p-value: 5.746e-12

> 
> model20d<-update(model19d, ~.-I(M4^2))
> summary(model20d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M2:M3 + M2:M4 + M3:M4 + 
    M1:W + M1:M2:M3 + M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-204.774  -72.682   -8.948   55.876  285.036 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.087e+03  2.046e+03  -1.020 0.315148    
M1           4.539e+00  9.971e-01   4.552 6.86e-05 ***
M2          -1.056e+00  1.641e+00  -0.644 0.524264    
M3          -8.576e-01  1.131e+00  -0.758 0.453712    
M4           3.636e+00  1.248e+00   2.913 0.006379 ** 
W            6.906e+01  4.460e+01   1.548 0.131052    
M2:M3        6.620e-03  1.503e-03   4.406 0.000105 ***
M2:M4       -2.096e-03  8.879e-04  -2.360 0.024326 *  
M3:M4       -3.411e-03  9.802e-04  -3.480 0.001432 ** 
M1:W        -1.449e-01  4.550e-02  -3.185 0.003159 ** 
M1:M2:M3    -4.762e-06  1.149e-06  -4.143 0.000224 ***
M1:M2:W      9.339e-05  5.248e-05   1.779 0.084380 .  
M2:M3:W     -2.253e-04  7.546e-05  -2.986 0.005296 ** 
M1:M4:W     -1.127e-04  4.363e-05  -2.584 0.014385 *  
M3:M4:W      1.505e-04  4.325e-05   3.481 0.001429 ** 
M1:M2:M3:M4  1.038e-09  3.761e-10   2.761 0.009335 ** 
M1:M2:M3:W   1.502e-07  5.163e-08   2.910 0.006423 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 127.8 on 33 degrees of freedom
Multiple R-squared:  0.9063,    Adjusted R-squared:  0.8609 
F-statistic: 19.95 on 16 and 33 DF,  p-value: 1.65e-12

> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch E~~~~~~~~~~~~~~~~~~~~~~~
> 
> library(rpart)
> library(rpart.plot)
> treeModel<-rpart(M~M1+M2+M3+M4+W, data=mooseData1)
> summary(treeModel)
Call:
rpart(formula = M ~ M1 + M2 + M3 + M4 + W, data = mooseData1)
  n= 50 

          CP nsplit rel error    xerror      xstd
1 0.64334747      0 1.0000000 1.0658596 0.1476987
2 0.11953330      1 0.3566525 0.5697500 0.1356667
3 0.02607126      2 0.2371192 0.4575037 0.1288592
4 0.01000000      3 0.2110480 0.4536590 0.1331513

Variable importance
 W M1 M3 M4 M2 
22 22 20 18 18 

Node number 1: 50 observations,    complexity param=0.6433475
  mean=1079.3, MSE=115024.8 
  left son=2 (16 obs) right son=3 (34 obs)
  Primary splits:
      W  < 23.5   to the right, improve=0.6433475, (0 missing)
      M1 < 1000.5 to the left,  improve=0.6366829, (0 missing)
      M4 < 773    to the left,  improve=0.5796888, (0 missing)
      M2 < 935    to the left,  improve=0.5774694, (0 missing)
      M3 < 773    to the left,  improve=0.5712652, (0 missing)
  Surrogate splits:
      M3 < 773    to the left,  agree=0.96, adj=0.875, (0 split)
      M1 < 801    to the left,  agree=0.94, adj=0.812, (0 split)
      M4 < 687.5  to the left,  agree=0.94, adj=0.812, (0 split)
      M2 < 801    to the left,  agree=0.92, adj=0.750, (0 split)

Node number 2: 16 observations
  mean=682.75, MSE=15475.56 

Node number 3: 34 observations,    complexity param=0.1195333
  mean=1265.912, MSE=53046.61 
  left son=6 (24 obs) right son=7 (10 obs)
  Primary splits:
      M1 < 1384   to the left,  improve=0.38116560, (0 missing)
      M4 < 1317.5 to the right, improve=0.11826490, (0 missing)
      M2 < 1066   to the left,  improve=0.09048218, (0 missing)
      W  < 15.5   to the left,  improve=0.06636598, (0 missing)
      M3 < 1309.5 to the right, improve=0.05455563, (0 missing)
  Surrogate splits:
      M2 < 1468   to the left,  agree=0.794, adj=0.3, (0 split)
      M3 < 1682   to the left,  agree=0.765, adj=0.2, (0 split)

Node number 6: 24 observations,    complexity param=0.02607126
  mean=1174.125, MSE=36419.53 
  left son=12 (12 obs) right son=13 (12 obs)
  Primary splits:
      M4 < 1213   to the right, improve=0.17154490, (0 missing)
      M1 < 1023   to the left,  improve=0.08137834, (0 missing)
      M3 < 1291.5 to the right, improve=0.07846753, (0 missing)
      W  < 15.5   to the left,  improve=0.04983676, (0 missing)
      M2 < 1255.5 to the left,  improve=0.03317614, (0 missing)
  Surrogate splits:
      M3 < 965    to the right, agree=0.750, adj=0.500, (0 split)
      M2 < 1135   to the right, agree=0.708, adj=0.417, (0 split)
      W  < 16.5   to the left,  agree=0.708, adj=0.417, (0 split)
      M1 < 847.5  to the right, agree=0.583, adj=0.167, (0 split)

Node number 7: 10 observations
  mean=1486.2, MSE=24205.16 

Node number 12: 12 observations
  mean=1095.083, MSE=11433.24 

Node number 13: 12 observations
  mean=1253.167, MSE=48910.64 

> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch F~~~~~~~~~~~~~~~~~~~~~~~
> #Advancing model simplification through maximizing accuracy
> model8f<-update(model7, ~.-M1:M2:M3)
> summary(model8f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M4 + M1:M3:M4 + 
    M2:M3:M4 + M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + 
    M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-216.215  -64.661   -7.714   47.919  272.778 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -6.949e+03  5.831e+03  -1.192    0.247
M1           6.261e+00  1.169e+01   0.536    0.598
M2           6.353e+00  1.533e+01   0.414    0.683
M3           6.911e+00  1.273e+01   0.543    0.593
M4           2.381e+00  5.552e+00   0.429    0.672
W            2.142e+02  1.804e+02   1.187    0.248
I(M1^2)      2.783e-04  9.169e-04   0.303    0.765
I(M2^2)     -8.479e-04  1.343e-03  -0.631    0.535
I(M3^2)     -5.310e-04  1.847e-03  -0.287    0.777
I(M4^2)      4.425e-04  1.470e-03   0.301    0.766
M1:M2       -6.189e-03  8.106e-03  -0.764    0.454
M1:M3       -4.928e-03  1.228e-02  -0.401    0.692
M2:M3        3.437e-03  1.061e-02   0.324    0.749
M1:M4        3.931e-03  6.821e-03   0.576    0.571
M2:M4       -4.841e-03  1.097e-02  -0.441    0.664
M3:M4       -7.145e-03  8.580e-03  -0.833    0.414
M1:W        -2.238e-01  3.041e-01  -0.736    0.470
M2:W        -1.846e-01  4.249e-01  -0.435    0.668
M3:W        -2.572e-01  4.339e-01  -0.593    0.560
M4:W         7.944e-02  2.275e-01   0.349    0.730
M1:M2:M4     9.444e-07  4.640e-06   0.204    0.841
M1:M3:M4    -4.050e-09  5.347e-06  -0.001    0.999
M2:M3:M4     2.128e-06  5.321e-06   0.400    0.693
M1:M2:W      3.452e-04  2.314e-04   1.492    0.151
M1:M3:W      2.090e-04  4.129e-04   0.506    0.618
M2:M3:W     -2.103e-04  4.029e-04  -0.522    0.607
M1:M4:W     -3.401e-04  3.001e-04  -1.133    0.270
M2:M4:W      4.885e-05  6.141e-04   0.080    0.937
M3:M4:W      2.973e-04  4.511e-04   0.659    0.517

Residual standard error: 153.9 on 21 degrees of freedom
Multiple R-squared:  0.9136,    Adjusted R-squared:  0.7983 
F-statistic: 7.927 on 28 and 21 DF,  p-value: 4.016e-06

> evaluateModel(model8f)
[1] 23.21774
> model9f<-update(model8f, ~.-M1:M3:M4)
> summary(model9f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M1:M2:M4 + M2:M3:M4 + 
    M1:M2:W + M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-216.210  -64.672   -7.707   47.934  272.778 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -6.947e+03  5.306e+03  -1.309    0.204
M1           6.267e+00  8.491e+00   0.738    0.468
M2           6.344e+00  8.888e+00   0.714    0.483
M3           6.912e+00  1.229e+01   0.562    0.580
M4           2.380e+00  5.069e+00   0.469    0.643
W            2.141e+02  1.591e+02   1.346    0.192
I(M1^2)      2.781e-04  8.618e-04   0.323    0.750
I(M2^2)     -8.479e-04  1.312e-03  -0.646    0.525
I(M3^2)     -5.305e-04  1.709e-03  -0.310    0.759
I(M4^2)      4.428e-04  1.382e-03   0.320    0.752
M1:M2       -6.186e-03  6.777e-03  -0.913    0.371
M1:M3       -4.936e-03  4.534e-03  -1.089    0.288
M2:M3        3.443e-03  7.223e-03   0.477    0.638
M1:M4        3.929e-03  6.068e-03   0.647    0.524
M2:M4       -4.838e-03  9.922e-03  -0.488    0.631
M3:M4       -7.145e-03  8.383e-03  -0.852    0.403
M1:W        -2.240e-01  2.369e-01  -0.945    0.355
M2:W        -1.845e-01  3.422e-01  -0.539    0.595
M3:W        -2.572e-01  4.230e-01  -0.608    0.549
M4:W         7.950e-02  2.091e-01   0.380    0.708
M1:M2:M4     9.430e-07  4.135e-06   0.228    0.822
M2:M3:M4     2.125e-06  3.717e-06   0.572    0.573
M1:M2:W      3.452e-04  2.041e-04   1.691    0.105
M1:M3:W      2.093e-04  2.575e-04   0.813    0.425
M2:M3:W     -2.105e-04  3.255e-04  -0.647    0.525
M1:M4:W     -3.401e-04  2.830e-04  -1.202    0.242
M2:M4:W      4.901e-05  5.676e-04   0.086    0.932
M3:M4:W      2.972e-04  3.977e-04   0.747    0.463

Residual standard error: 150.3 on 22 degrees of freedom
Multiple R-squared:  0.9136,    Adjusted R-squared:  0.8075 
F-statistic: 8.612 on 27 and 22 DF,  p-value: 1.328e-06

> evaluateModel(model9f)
[1] 23.2141
> model10f<-update(model9f, ~.-M1:M2:M4)
> summary(model10f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M3:W + M1:M4:W + M2:M4:W + M3:M4:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-221.86  -68.51  -10.98   51.05  274.11 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.880e+03  5.187e+03  -1.326   0.1978  
M1           4.665e+00  4.666e+00   1.000   0.3279  
M2           5.504e+00  7.922e+00   0.695   0.4941  
M3           9.080e+00  7.632e+00   1.190   0.2463  
M4           2.311e+00  4.955e+00   0.466   0.6454  
W            2.202e+02  1.536e+02   1.434   0.1651  
I(M1^2)      2.674e-04  8.426e-04   0.317   0.7539  
I(M2^2)     -8.905e-04  1.271e-03  -0.700   0.4907  
I(M3^2)     -6.630e-04  1.573e-03  -0.421   0.6774  
I(M4^2)      3.689e-04  1.315e-03   0.280   0.7816  
M1:M2       -4.787e-03  2.823e-03  -1.696   0.1034  
M1:M3       -4.938e-03  4.439e-03  -1.112   0.2775  
M2:M3        2.304e-03  5.110e-03   0.451   0.6563  
M1:M4        4.890e-03  4.276e-03   1.143   0.2646  
M2:M4       -3.936e-03  8.910e-03  -0.442   0.6628  
M3:M4       -8.514e-03  5.729e-03  -1.486   0.1509  
M1:W        -1.979e-01  2.032e-01  -0.974   0.3402  
M2:W        -1.562e-01  3.123e-01  -0.500   0.6218  
M3:W        -3.196e-01  3.156e-01  -1.013   0.3218  
M4:W         7.223e-02  2.024e-01   0.357   0.7244  
M2:M3:M4     2.851e-06  1.881e-06   1.516   0.1433  
M1:M2:W      3.266e-04  1.832e-04   1.782   0.0879 .
M1:M3:W      2.010e-04  2.496e-04   0.805   0.4291  
M2:M3:W     -1.789e-04  2.885e-04  -0.620   0.5413  
M1:M4:W     -3.253e-04  2.697e-04  -1.206   0.2400  
M2:M4:W      3.612e-06  5.205e-04   0.007   0.9945  
M3:M4:W      3.325e-04  3.587e-04   0.927   0.3636  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147.2 on 23 degrees of freedom
Multiple R-squared:  0.9134,    Adjusted R-squared:  0.8154 
F-statistic: 9.325 on 26 and 23 DF,  p-value: 4.327e-07

> evaluateModel(model10f)
[1] 23.20306
> model11f<-update(model10f, ~.-M2:M3:W)
> summary(model11f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M1:M4:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-220.863  -72.074   -4.265   53.627  286.821 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.723e+03  4.941e+03  -1.563   0.1311  
M1           4.567e+00  4.603e+00   0.992   0.3311  
M2           6.385e+00  7.693e+00   0.830   0.4147  
M3           1.083e+01  6.998e+00   1.548   0.1348  
M4           1.642e+00  4.774e+00   0.344   0.7338  
W            2.456e+02  1.461e+02   1.681   0.1057  
I(M1^2)      2.596e-04  8.316e-04   0.312   0.7576  
I(M2^2)     -9.327e-04  1.253e-03  -0.744   0.4639  
I(M3^2)     -9.834e-04  1.467e-03  -0.670   0.5090  
I(M4^2)      3.724e-04  1.298e-03   0.287   0.7767  
M1:M2       -4.722e-03  2.785e-03  -1.696   0.1028  
M1:M3       -3.691e-03  3.907e-03  -0.945   0.3542  
M2:M3       -4.451e-04  2.509e-03  -0.177   0.8607  
M1:M4        3.492e-03  3.587e-03   0.973   0.3400  
M2:M4       -2.014e-03  8.246e-03  -0.244   0.8091  
M3:M4       -8.474e-03  5.655e-03  -1.498   0.1471  
M1:W        -1.990e-01  2.006e-01  -0.992   0.3311  
M2:W        -1.789e-01  3.062e-01  -0.584   0.5645  
M3:W        -3.926e-01  2.891e-01  -1.358   0.1871  
M4:W         1.219e-01  1.835e-01   0.664   0.5130  
M2:M3:M4     3.119e-06  1.807e-06   1.726   0.0971 .
M1:M2:W      3.176e-04  1.803e-04   1.762   0.0909 .
M1:M3:W      1.156e-04  2.055e-04   0.562   0.5792  
M1:M4:W     -2.166e-04  2.023e-04  -1.070   0.2951  
M2:M4:W     -1.608e-04  4.421e-04  -0.364   0.7192  
M3:M4:W      3.221e-04  3.537e-04   0.911   0.3715  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 145.3 on 24 degrees of freedom
Multiple R-squared:  0.9119,    Adjusted R-squared:  0.8201 
F-statistic: 9.938 on 25 and 24 DF,  p-value: 1.587e-07

> evaluateModel(model11f)
[1] 21.82282
> model12f<-update(model11f, ~.-M1:M4:W)
> summary(model12f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M2:W + 
    M1:M3:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-218.994  -66.216   -6.578   50.270  283.414 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.441e+03  4.949e+03  -1.504   0.1452  
M1           8.113e+00  3.206e+00   2.531   0.0180 *
M2           2.280e+00  6.688e+00   0.341   0.7360  
M3           9.393e+00  6.888e+00   1.364   0.1848  
M4           2.612e+00  4.700e+00   0.556   0.5833  
W            2.564e+02  1.462e+02   1.754   0.0917 .
I(M1^2)     -6.924e-05  7.750e-04  -0.089   0.9295  
I(M2^2)     -7.190e-04  1.241e-03  -0.580   0.5674  
I(M3^2)     -9.028e-04  1.469e-03  -0.614   0.5444  
I(M4^2)      1.927e-04  1.291e-03   0.149   0.8826  
M1:M2       -5.149e-03  2.764e-03  -1.863   0.0742 .
M1:M3       -2.351e-03  3.712e-03  -0.633   0.5322  
M2:M3       -8.574e-05  2.494e-03  -0.034   0.9728  
M1:M4       -1.905e-04  1.019e-03  -0.187   0.8533  
M2:M4        2.309e-03  7.210e-03   0.320   0.7514  
M3:M4       -8.972e-03  5.652e-03  -1.587   0.1250  
M1:W        -3.607e-01  1.323e-01  -2.727   0.0115 *
M2:W        -3.795e-03  2.596e-01  -0.015   0.9884  
M3:W        -3.618e-01  2.885e-01  -1.254   0.2214  
M4:W         4.814e-02  1.706e-01   0.282   0.7801  
M2:M3:M4     2.645e-06  1.757e-06   1.506   0.1447  
M1:M2:W      3.483e-04  1.785e-04   1.951   0.0623 .
M1:M3:W      4.247e-05  1.944e-04   0.218   0.8289  
M2:M4:W     -3.923e-04  3.867e-04  -1.014   0.3201  
M3:M4:W      3.989e-04  3.474e-04   1.148   0.2617  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 145.7 on 25 degrees of freedom
Multiple R-squared:  0.9077,    Adjusted R-squared:  0.8191 
F-statistic: 10.24 on 24 and 25 DF,  p-value: 8.041e-08

> evaluateModel(model12f)
[1] 21.65538
> model13f<-update(model12f, ~.-M1:M2:W)
> summary(model13f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M2 + M1:M3 + M2:M3 + M1:M4 + M2:M4 + 
    M3:M4 + M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M3:W + 
    M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-212.564  -68.353    2.119   63.201  276.743 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.643e+03  5.208e+03  -1.468   0.1542  
M1           6.942e+00  3.315e+00   2.094   0.0461 *
M2           5.075e+00  6.876e+00   0.738   0.4671  
M3           7.469e+00  7.176e+00   1.041   0.3075  
M4           4.197e+00  4.873e+00   0.861   0.3970  
W            2.434e+02  1.537e+02   1.583   0.1255  
I(M1^2)     -4.760e-06  8.151e-04  -0.006   0.9954  
I(M2^2)      3.139e-04  1.181e-03   0.266   0.7925  
I(M3^2)     -6.080e-05  1.478e-03  -0.041   0.9675  
I(M4^2)      4.311e-04  1.353e-03   0.319   0.7526  
M1:M2       -4.890e-04  1.464e-03  -0.334   0.7411  
M1:M3       -6.612e-03  3.160e-03  -2.093   0.0463 *
M2:M3       -1.762e-03  2.465e-03  -0.715   0.4810  
M1:M4        3.469e-04  1.033e-03   0.336   0.7397  
M2:M4       -7.057e-03  5.664e-03  -1.246   0.2239  
M3:M4       -2.800e-03  4.931e-03  -0.568   0.5750  
M1:W        -2.919e-01  1.342e-01  -2.175   0.0389 *
M2:W        -1.241e-01  2.654e-01  -0.467   0.6441  
M3:W        -2.277e-01  2.949e-01  -0.772   0.4471  
M4:W        -1.710e-02  1.761e-01  -0.097   0.9234  
M2:M3:M4     3.207e-06  1.824e-06   1.758   0.0905 .
M1:M3:W      3.232e-04  1.377e-04   2.348   0.0268 *
M2:M4:W      1.487e-04  2.838e-04   0.524   0.6047  
M3:M4:W     -7.203e-05  2.630e-04  -0.274   0.7863  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 153.4 on 26 degrees of freedom
Multiple R-squared:  0.8936,    Adjusted R-squared:  0.7996 
F-statistic: 9.499 on 23 and 26 DF,  p-value: 1.275e-07

> evaluateModel(model13f) #Wow! Huge improvement removing a near significant term
[1] 14.71046
> #Moving to 2-terms since all 4 3 terms positively impact accuracy
> model14f<-update(model13f, ~.-M1:M2)
> summary(model14f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + 
    M1:W + M2:W + M3:W + M4:W + M2:M3:M4 + M1:M3:W + M2:M4:W + 
    M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-215.936  -66.391   -1.409   70.497  277.592 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -7.539e+03  5.112e+03  -1.475   0.1518  
M1           6.986e+00  3.257e+00   2.145   0.0411 *
M2           4.844e+00  6.728e+00   0.720   0.4777  
M3           7.436e+00  7.056e+00   1.054   0.3013  
M4           4.129e+00  4.788e+00   0.862   0.3961  
W            2.368e+02  1.499e+02   1.579   0.1259  
I(M1^2)     -2.114e-04  5.218e-04  -0.405   0.6886  
I(M2^2)      3.684e-05  8.269e-04   0.045   0.9648  
I(M3^2)     -4.546e-05  1.453e-03  -0.031   0.9753  
I(M4^2)      4.529e-04  1.329e-03   0.341   0.7359  
M1:M3       -6.623e-03  3.107e-03  -2.131   0.0423 *
M2:M3       -1.693e-03  2.415e-03  -0.701   0.4894  
M1:M4        2.908e-04  1.002e-03   0.290   0.7740  
M2:M4       -6.913e-03  5.554e-03  -1.245   0.2239  
M3:M4       -2.794e-03  4.849e-03  -0.576   0.5692  
M1:W        -2.893e-01  1.318e-01  -2.196   0.0369 *
M2:W        -1.194e-01  2.606e-01  -0.458   0.6505  
M3:W        -2.208e-01  2.893e-01  -0.763   0.4521  
M4:W        -1.323e-02  1.728e-01  -0.077   0.9395  
M2:M3:M4     3.202e-06  1.794e-06   1.785   0.0855 .
M1:M3:W      3.194e-04  1.349e-04   2.367   0.0253 *
M2:M4:W      1.477e-04  2.791e-04   0.529   0.6008  
M3:M4:W     -7.878e-05  2.579e-04  -0.306   0.7623  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 150.8 on 27 degrees of freedom
Multiple R-squared:  0.8932,    Adjusted R-squared:  0.8062 
F-statistic: 10.26 on 22 and 27 DF,  p-value: 4.07e-08

> evaluateModel(model14f)
[1] 14.15192
> model15f<-update(model14f, ~.-M4:W)
> #summary(model15f)
> evaluateModel(model15f)
[1] 13.98115
> model16f<-update(model15f, ~.-M3:W)
> summary(model16f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M3:M4 + 
    M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-206.348  -61.554   -1.575   73.312  311.310 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -5.693e+03  3.612e+03  -1.576  0.12591   
M1           6.105e+00  2.575e+00   2.371  0.02458 * 
M2           7.294e+00  4.552e+00   1.602  0.11993   
M3           2.401e+00  2.733e+00   0.879  0.38671   
M4           3.475e+00  1.797e+00   1.934  0.06298 . 
W            1.714e+02  9.096e+01   1.884  0.06963 . 
I(M1^2)     -3.365e-04  4.828e-04  -0.697  0.49140   
I(M2^2)     -1.651e-04  7.514e-04  -0.220  0.82766   
I(M3^2)      3.856e-04  1.308e-03   0.295  0.77021   
I(M4^2)      6.872e-04  1.253e-03   0.548  0.58766   
M1:M3       -5.150e-03  1.919e-03  -2.684  0.01190 * 
M2:M3       -1.494e-03  2.201e-03  -0.679  0.50265   
M1:M4        1.296e-04  9.343e-04   0.139  0.89065   
M2:M4       -8.953e-03  3.807e-03  -2.352  0.02570 * 
M3:M4        2.412e-05  2.983e-03   0.008  0.99360   
M1:W        -2.449e-01  8.648e-02  -2.831  0.00833 **
M2:W        -2.601e-01  1.271e-01  -2.046  0.04996 * 
M2:M3:M4     2.818e-06  1.571e-06   1.793  0.08340 . 
M1:M3:W      2.628e-04  8.415e-05   3.123  0.00403 **
M2:M4:W      3.133e-04  1.220e-04   2.568  0.01566 * 
M3:M4:W     -2.589e-04  1.104e-04  -2.345  0.02610 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147.2 on 29 degrees of freedom
Multiple R-squared:  0.8908,    Adjusted R-squared:  0.8154 
F-statistic: 11.82 on 20 and 29 DF,  p-value: 4.48e-09

> evaluateModel(model16f)
[1] 12.16429
> model17f<-update(model16f, ~.-M3:M4)
> summary(model17f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + 
    M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-206.399  -61.465   -1.459   73.245  311.570 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -5.702e+03  3.359e+03  -1.698  0.09992 . 
M1           6.095e+00  2.207e+00   2.762  0.00972 **
M2           7.307e+00  4.188e+00   1.745  0.09127 . 
M3           2.415e+00  2.128e+00   1.135  0.26539   
M4           3.482e+00  1.589e+00   2.191  0.03639 * 
W            1.714e+02  8.934e+01   1.919  0.06460 . 
I(M1^2)     -3.349e-04  4.342e-04  -0.771  0.44661   
I(M2^2)     -1.647e-04  7.372e-04  -0.223  0.82476   
I(M3^2)      3.933e-04  8.868e-04   0.444  0.66058   
I(M4^2)      6.954e-04  7.166e-04   0.970  0.33963   
M1:M3       -5.145e-03  1.801e-03  -2.856  0.00771 **
M2:M3       -1.505e-03  1.649e-03  -0.913  0.36865   
M1:M4        1.308e-04  9.059e-04   0.144  0.88613   
M2:M4       -8.962e-03  3.586e-03  -2.499  0.01814 * 
M1:W        -2.445e-01  7.297e-02  -3.351  0.00219 **
M2:W        -2.603e-01  1.232e-01  -2.113  0.04307 * 
M2:M3:M4     2.825e-06  1.245e-06   2.268  0.03066 * 
M1:M3:W      2.625e-04  7.322e-05   3.585  0.00118 **
M2:M4:W      3.134e-04  1.193e-04   2.628  0.01342 * 
M3:M4:W     -2.589e-04  1.085e-04  -2.386  0.02355 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 144.7 on 30 degrees of freedom
Multiple R-squared:  0.8908,    Adjusted R-squared:  0.8216 
F-statistic: 12.88 on 19 and 30 DF,  p-value: 1.214e-09

> evaluateModel(model17f)
[1] 12.15317
> #Removal of terms negatively impacts accuacy now
> summary(model1)

Call:
lm(formula = M ~ M1 * M2 * M3 * M4 * W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-144.24  -54.00  -15.01   46.60  254.17 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)
(Intercept)    3.627e+04  4.744e+04   0.765    0.457
M1            -4.251e+01  3.921e+01  -1.084    0.297
M2            -4.977e+01  7.109e+01  -0.700    0.495
M3            -3.976e+01  5.174e+01  -0.768    0.455
M4            -3.078e+01  5.871e+01  -0.524    0.608
W             -1.594e+03  2.295e+03  -0.695    0.499
I(M1^2)        8.645e-04  1.487e-03   0.582    0.570
I(M2^2)        1.059e-03  2.018e-03   0.525    0.608
I(M3^2)        1.117e-03  2.384e-03   0.469    0.647
I(M4^2)        3.210e-03  2.271e-03   1.413    0.179
M1:M2          5.740e-02  5.729e-02   1.002    0.333
M1:M3          4.753e-02  5.045e-02   0.942    0.362
M2:M3          6.544e-02  5.926e-02   1.104    0.288
M1:M4          4.797e-02  4.940e-02   0.971    0.348
M2:M4          2.071e-02  7.425e-02   0.279    0.784
M3:M4          2.322e-02  5.084e-02   0.457    0.655
M1:W           2.416e+00  2.109e+00   1.146    0.271
M2:W           1.889e+00  3.390e+00   0.557    0.586
M3:W           1.944e+00  2.620e+00   0.742    0.470
M4:W           9.498e-01  2.910e+00   0.326    0.749
M1:M2:M3      -6.843e-05  4.646e-05  -1.473    0.163
M1:M2:M4      -4.483e-05  6.153e-05  -0.729    0.478
M1:M3:M4      -4.384e-05  4.776e-05  -0.918    0.374
M2:M3:M4      -3.160e-05  5.781e-05  -0.547    0.593
M1:M2:W       -2.822e-03  2.912e-03  -0.969    0.349
M1:M3:W       -2.753e-03  2.874e-03  -0.958    0.354
M2:M3:W       -2.863e-03  3.073e-03  -0.932    0.367
M1:M4:W       -2.446e-03  2.567e-03  -0.953    0.357
M2:M4:W       -1.298e-04  3.915e-03  -0.033    0.974
M3:M4:W       -8.125e-04  2.845e-03  -0.286    0.779
M1:M2:M3:M4    4.791e-08  4.497e-08   1.065    0.305
M1:M2:M3:W     3.492e-06  2.629e-06   1.328    0.205
M1:M2:M4:W     1.907e-06  3.214e-06   0.594    0.562
M1:M3:M4:W     2.205e-06  2.842e-06   0.776    0.451
M2:M3:M4:W     7.716e-07  3.209e-06   0.240    0.813
M1:M2:M3:M4:W -2.156e-09  2.581e-09  -0.835    0.418

Residual standard error: 165.8 on 14 degrees of freedom
Multiple R-squared:  0.9331,    Adjusted R-squared:  0.7658 
F-statistic: 5.577 on 35 and 14 DF,  p-value: 0.0006537

> model18f<-update(model17f, ~.+M2:M3:W)
> summary(model18f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + 
    M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W + M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-208.890  -67.595    0.729   76.468  306.193 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.145e+03  3.885e+03  -1.582   0.1245  
M1           5.420e+00  3.608e+00   1.502   0.1438  
M2           8.578e+00  6.816e+00   1.259   0.2182  
M3           2.604e+00  2.303e+00   1.131   0.2674  
M4           3.704e+00  1.865e+00   1.986   0.0565 .
W            1.825e+02  1.019e+02   1.790   0.0838 .
I(M1^2)     -3.059e-04  4.576e-04  -0.669   0.5091  
I(M2^2)     -2.552e-04  8.396e-04  -0.304   0.7633  
I(M3^2)      3.411e-04  9.272e-04   0.368   0.7156  
I(M4^2)      7.112e-04  7.312e-04   0.973   0.3388  
M1:M3       -4.653e-03  2.756e-03  -1.688   0.1020  
M2:M3       -2.253e-03  3.554e-03  -0.634   0.5310  
M1:M4        1.879e-04  9.510e-04   0.198   0.8448  
M2:M4       -9.381e-03  4.045e-03  -2.319   0.0276 *
M1:W        -2.138e-01  1.485e-01  -1.440   0.1607  
M2:W        -3.106e-01  2.451e-01  -1.267   0.2153  
M2:M3:M4     2.991e-06  1.444e-06   2.072   0.0473 *
M1:M3:W      2.332e-04  1.435e-04   1.625   0.1151  
M2:M4:W      3.212e-04  1.255e-04   2.560   0.0160 *
M3:M4:W     -2.711e-04  1.215e-04  -2.232   0.0335 *
M2:M3:W      4.148e-05  1.737e-04   0.239   0.8130  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147 on 29 degrees of freedom
Multiple R-squared:  0.891,     Adjusted R-squared:  0.8158 
F-statistic: 11.85 on 20 and 29 DF,  p-value: 4.363e-09

> evaluateModel(model18f)
[1] 12.14388
> model19f<-update(model18f, ~.+M1:M2:M4:W)
> summary(model19f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + 
    M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W + M2:M3:W + 
    M1:M2:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-208.556  -67.259    0.578   75.915  305.951 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -6.157e+03  3.984e+03  -1.545   0.1335  
M1           5.478e+00  4.423e+00   1.239   0.2258  
M2           8.531e+00  7.221e+00   1.181   0.2474  
M3           2.584e+00  2.503e+00   1.032   0.3108  
M4           3.717e+00  1.971e+00   1.886   0.0697 .
W            1.824e+02  1.037e+02   1.759   0.0896 .
I(M1^2)     -3.182e-04  6.979e-04  -0.456   0.6519  
I(M2^2)     -2.662e-04  9.735e-04  -0.273   0.7865  
I(M3^2)      3.366e-04  9.627e-04   0.350   0.7292  
I(M4^2)      7.049e-04  7.903e-04   0.892   0.3801  
M1:M3       -4.647e-03  2.815e-03  -1.651   0.1100  
M2:M3       -2.222e-03  3.849e-03  -0.577   0.5683  
M1:M4        1.550e-04  1.692e-03   0.092   0.9276  
M2:M4       -9.324e-03  4.767e-03  -1.956   0.0605 .
M1:W        -2.148e-01  1.570e-01  -1.368   0.1821  
M2:W        -3.080e-01  2.723e-01  -1.131   0.2675  
M2:M3:M4     2.974e-06  1.633e-06   1.821   0.0793 .
M1:M3:W      2.326e-04  1.479e-04   1.573   0.1270  
M2:M4:W      3.175e-04  2.012e-04   1.578   0.1257  
M3:M4:W     -2.692e-04  1.472e-04  -1.829   0.0781 .
M2:M3:W      4.087e-05  1.787e-04   0.229   0.8207  
M1:M2:M4:W   1.364e-09  5.769e-08   0.024   0.9813  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 149.6 on 28 degrees of freedom
Multiple R-squared:  0.891,     Adjusted R-squared:  0.8092 
F-statistic:  10.9 on 21 and 28 DF,  p-value: 1.544e-08

> evaluateModel(model19f)
[1] 12.13917
> #Addition of terms negatively impacts accuracy
> model20f<-update(model19f, ~.-M2:M3:W)
> summary(model20f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + 
    I(M3^2) + I(M4^2) + M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + 
    M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W + M1:M2:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-207.100  -60.875   -1.709   72.035  310.805 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -5.746e+03  3.497e+03  -1.643  0.11116   
M1           6.211e+00  3.003e+00   2.068  0.04763 * 
M2           7.238e+00  4.423e+00   1.637  0.11251   
M3           2.372e+00  2.287e+00   1.037  0.30825   
M4           3.520e+00  1.743e+00   2.019  0.05281 . 
W            1.717e+02  9.101e+01   1.887  0.06925 . 
I(M1^2)     -3.633e-04  6.585e-04  -0.552  0.58543   
I(M2^2)     -1.942e-04  9.060e-04  -0.214  0.83177   
I(M3^2)      3.807e-04  9.277e-04   0.410  0.68458   
I(M4^2)      6.809e-04  7.704e-04   0.884  0.38409   
M1:M3       -5.114e-03  1.909e-03  -2.679  0.01204 * 
M2:M3       -1.457e-03  1.872e-03  -0.778  0.44259   
M1:M4        5.439e-05  1.607e-03   0.034  0.97323   
M2:M4       -8.840e-03  4.202e-03  -2.104  0.04419 * 
M1:W        -2.458e-01  7.762e-02  -3.167  0.00361 **
M2:W        -2.558e-01  1.464e-01  -1.747  0.09120 . 
M2:M3:M4     2.791e-06  1.399e-06   1.994  0.05559 . 
M1:M3:W      2.602e-04  8.467e-05   3.073  0.00458 **
M2:M4:W      3.049e-04  1.903e-04   1.602  0.11995   
M3:M4:W     -2.548e-04  1.309e-04  -1.946  0.06140 . 
M1:M2:M4:W   3.261e-09  5.616e-08   0.058  0.95409   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 147.2 on 29 degrees of freedom
Multiple R-squared:  0.8908,    Adjusted R-squared:  0.8155 
F-statistic: 11.83 on 20 and 29 DF,  p-value: 4.473e-09

> evaluateModel(model20f)
[1] 12.12406
> model21f<-step(model20f)
Start:  AIC=513.92
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + M2:W + M2:M3:M4 + 
    M1:M3:W + M2:M4:W + M3:M4:W + M1:M2:M4:W

             Df Sum of Sq    RSS    AIC
- M1:M2:M4:W  1        73 628209 511.93
- I(M2^2)     1       995 629131 512.00
- I(M3^2)     1      3647 631782 512.21
- I(M1^2)     1      6591 634726 512.45
- I(M4^2)     1     16917 645053 513.25
<none>                    628136 513.92
- M3:M4:W     1     82023 710158 518.06
- M2:M3:M4    1     86152 714287 518.35
- M1:M3:W     1    204487 832623 526.02

Step:  AIC=511.93
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M3 + M2:M3 + M1:M4 + M2:M4 + M1:W + M2:W + M2:M3:M4 + 
    M1:M3:W + M2:M4:W + M3:M4:W

           Df Sum of Sq    RSS    AIC
- M1:M4     1       437 628645 509.96
- I(M2^2)   1      1045 629253 510.01
- I(M3^2)   1      4119 632328 510.26
- I(M1^2)   1     12455 640663 510.91
- I(M4^2)   1     19717 647926 511.48
<none>                  628209 511.93
- M2:M3:M4  1    107754 735963 517.85
- M3:M4:W   1    119205 747413 518.62
- M2:M4:W   1    144571 772780 520.29
- M1:M3:W   1    269166 897375 527.76

Step:  AIC=509.96
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + I(M4^2) + 
    M1:M3 + M2:M3 + M2:M4 + M1:W + M2:W + M2:M3:M4 + M1:M3:W + 
    M2:M4:W + M3:M4:W

           Df Sum of Sq    RSS    AIC
- I(M2^2)   1       822 629468 508.03
- I(M3^2)   1      4250 632896 508.30
- I(M1^2)   1     12230 640875 508.93
- I(M4^2)   1     19614 648259 509.50
<none>                  628645 509.96
- M2:M3:M4  1    117186 745832 516.51
- M3:M4:W   1    135052 763697 517.70
- M2:M4:W   1    158537 787183 519.21
- M1:M3:W   1    326860 955505 528.90

Step:  AIC=508.03
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M3^2) + I(M4^2) + M1:M3 + 
    M2:M3 + M2:M4 + M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + 
    M3:M4:W

           Df Sum of Sq    RSS    AIC
- I(M3^2)   1      8559 638027 506.71
- I(M1^2)   1     13531 642999 507.09
- I(M4^2)   1     20991 650459 507.67
<none>                  629468 508.03
- M2:M3:M4  1    116732 746200 514.54
- M3:M4:W   1    134297 763765 515.70
- M2:M4:W   1    157999 787467 517.23
- M1:M3:W   1    328885 958353 527.05

Step:  AIC=506.71
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + I(M4^2) + M1:M3 + M2:M3 + 
    M2:M4 + M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W

           Df Sum of Sq    RSS    AIC
- I(M4^2)   1     17073 655100 506.03
- I(M1^2)   1     20497 658524 506.29
<none>                  638027 506.71
- M3:M4:W   1    133369 771396 514.20
- M2:M4:W   1    151642 789669 515.37
- M2:M3:M4  1    155961 793988 515.64
- M1:M3:W   1    326453 964481 525.37

Step:  AIC=506.03
M ~ M1 + M2 + M3 + M4 + W + I(M1^2) + M1:M3 + M2:M3 + M2:M4 + 
    M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W

           Df Sum of Sq    RSS    AIC
- I(M1^2)   1     14913 670013 505.15
<none>                  655100 506.03
- M3:M4:W   1    122032 777132 512.57
- M2:M3:M4  1    143562 798662 513.93
- M2:M4:W   1    153844 808944 514.57
- M1:M3:W   1    313953 969053 523.60

Step:  AIC=505.15
M ~ M1 + M2 + M3 + M4 + W + M1:M3 + M2:M3 + M2:M4 + M1:W + M2:W + 
    M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W

           Df Sum of Sq    RSS    AIC
<none>                  670013 505.15
- M3:M4:W   1    107917 777929 510.62
- M2:M3:M4  1    134358 804370 512.29
- M2:M4:W   1    138953 808965 512.57
- M1:M3:W   1    301262 971275 521.72
> summary(model21f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M3 + M2:M3 + M2:M4 + 
    M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-216.130  -76.090   -6.611   58.736  305.238 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -4.019e+03  2.652e+03  -1.516 0.138521    
M1           4.506e+00  1.508e+00   2.989 0.005091 ** 
M2           5.519e+00  2.953e+00   1.869 0.070022 .  
M3           2.177e+00  1.562e+00   1.394 0.172216    
M4           3.752e+00  1.421e+00   2.641 0.012266 *  
W            1.054e+02  6.466e+01   1.630 0.112001    
M1:M3       -4.395e-03  1.242e-03  -3.538 0.001161 ** 
M2:M3       -1.581e-03  1.419e-03  -1.114 0.272750    
M2:M4       -7.134e-03  2.370e-03  -3.010 0.004826 ** 
M1:W        -1.932e-01  5.708e-02  -3.385 0.001771 ** 
M2:W        -1.799e-01  8.281e-02  -2.172 0.036690 *  
M2:M3:M4     2.706e-06  1.021e-06   2.649 0.012024 *  
M1:M3:W      2.218e-04  5.591e-05   3.967 0.000343 ***
M2:M4:W      2.133e-04  7.918e-05   2.694 0.010763 *  
M3:M4:W     -1.836e-04  7.731e-05  -2.374 0.023197 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 138.4 on 35 degrees of freedom
Multiple R-squared:  0.8835,    Adjusted R-squared:  0.8369 
F-statistic: 18.96 on 14 and 35 DF,  p-value: 2.655e-12

> evaluateModel(model21f)
[1] 11.52087
> plot(model20f)
> plot(model21f)
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~~~~~~~~Branch G~~~~~~~~~~~~~~~~~~~~~~~
> #From branch f, point 21 was identified as an outlier.
> model8g<-lm(model7$call, mooseData1, c(1:20,22:nrow(mooseData1)))
> evaluateModel(model8g)
[1] 35.15044
> summary(model8g)

Call:
lm(formula = model7$call, data = mooseData1, subset = c(1:20, 
    22:nrow(mooseData1)))

Residuals:
     Min       1Q   Median       3Q      Max 
-237.390  -71.767   -2.916   44.065  304.119 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -8.058e+03  7.086e+03  -1.137   0.2696  
M1           1.553e+01  1.420e+01   1.094   0.2877  
M2           6.173e+00  1.656e+01   0.373   0.7135  
M3          -2.726e+00  1.675e+01  -0.163   0.8724  
M4           5.073e+00  8.069e+00   0.629   0.5370  
W            2.705e+02  2.097e+02   1.290   0.2126  
I(M1^2)      2.266e-05  9.604e-04   0.024   0.9814  
I(M2^2)     -1.223e-03  1.398e-03  -0.875   0.3926  
I(M3^2)     -8.369e-04  2.028e-03  -0.413   0.6845  
I(M4^2)     -5.503e-04  1.811e-03  -0.304   0.7645  
M1:M2       -1.532e-02  1.133e-02  -1.353   0.1920  
M1:M3        6.896e-03  1.679e-02   0.411   0.6860  
M2:M3        2.192e-03  1.211e-02   0.181   0.8583  
M1:M4       -1.016e-02  1.453e-02  -0.699   0.4928  
M2:M4        6.663e-03  1.471e-02   0.453   0.6557  
M3:M4       -4.985e-03  8.885e-03  -0.561   0.5813  
M1:W        -3.439e-01  3.252e-01  -1.058   0.3035  
M2:W        -2.450e-01  4.519e-01  -0.542   0.5940  
M3:W        -8.255e-03  5.025e-01  -0.016   0.9871  
M4:W        -1.077e-01  3.033e-01  -0.355   0.7265  
M1:M2:M3     7.057e-07  3.326e-06   0.212   0.8342  
M1:M2:M4     4.564e-06  5.951e-06   0.767   0.4525  
M1:M3:M4     6.399e-07  5.486e-06   0.117   0.9084  
M2:M3:M4    -2.823e-06  6.838e-06  -0.413   0.6843  
M1:M2:W      6.721e-04  3.603e-04   1.865   0.0777 .
M1:M3:W     -7.906e-04  9.420e-04  -0.839   0.4118  
M2:M3:W      2.814e-04  5.799e-04   0.485   0.6331  
M1:M4:W      2.989e-04  6.199e-04   0.482   0.6353  
M2:M4:W     -6.737e-04  8.716e-04  -0.773   0.4490  
M3:M4:W      6.134e-04  5.324e-04   1.152   0.2635  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156 on 19 degrees of freedom
Multiple R-squared:  0.913,     Adjusted R-squared:  0.7802 
F-statistic: 6.877 on 29 and 19 DF,  p-value: 2.763e-05

> model9g<-update(model8g, ~.-M3:M4:W)
> evaluateModel(model9g)
[1] 25.65258
> model10g<-update(model9g, ~.-M1:M3:W)
> evaluateModel(model10g)
[1] 25.06903
> model11g<-update(model10g, ~.-M1:M2:W)
> evaluateModel(model11g)
[1] 19.17773
> model12g<-update(model11g, ~.-M1:M3:M4)
> evaluateModel(model12g)
[1] 18.01629
> model13g<-update(model12g, ~.-M4:W)
> evaluateModel(model13g)
[1] 17.81347
> model14g<-update(model13g, ~.-M2:W)
> evaluateModel(model14g)
[1] 16.67112
> model15g<-update(model14g, ~.-M2:M4)
> evaluateModel(model15g)
[1] 16.26123
> model16g<-update(model15g, ~.-M1:M3)
> evaluateModel(model16g)
[1] 15.61659
> model17g<-update(model16g, ~.-I(M4^2))
> evaluateModel(model17g)
[1] 14.59426
> model18g<-update(model17g, ~.-M2)
> evaluateModel(model18g)
[1] 12.71139
> model19g<-update(model18g, ~.-M1)
> evaluateModel(model19g)
[1] 12.60418
> #Removing values does not increase accuracy
> summary(model19g)

Call:
lm(formula = M ~ M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + 
    M1:M2 + M3:M2 + M1:M4 + M3:M4 + M1:W + M3:W + M1:M3:M2 + 
    M1:M4:M2 + M3:M4:M2 + M3:W:M2 + M1:M4:W + M4:W:M2, data = mooseData1, 
    subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
     Min       1Q   Median       3Q      Max 
-221.018  -85.325    1.315   54.515  300.591 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -2.444e+03  2.660e+03  -0.919  0.36560   
M3           7.787e+00  4.420e+00   1.762  0.08829 . 
M4           3.324e+00  1.508e+00   2.205  0.03529 * 
W            1.079e+02  8.388e+01   1.286  0.20816   
I(M1^2)     -3.170e-04  7.200e-04  -0.440  0.66293   
I(M2^2)     -3.908e-04  1.053e-03  -0.371  0.71311   
I(M3^2)     -5.483e-04  1.105e-03  -0.496  0.62334   
M1:M2        4.274e-03  2.013e-03   2.123  0.04214 * 
M3:M2       -5.318e-03  2.540e-03  -2.094  0.04483 * 
M4:M1       -2.701e-04  1.040e-03  -0.260  0.79679   
M3:M4       -5.674e-03  2.095e-03  -2.709  0.01105 * 
W:M1        -1.623e-01  6.265e-02  -2.591  0.01462 * 
M3:W        -2.246e-01  1.167e-01  -1.924  0.06387 . 
M3:M1:M2    -1.058e-06  6.996e-07  -1.513  0.14078   
M4:M1:M2    -2.543e-06  1.053e-06  -2.416  0.02201 * 
M3:M4:M2     4.752e-06  1.727e-06   2.752  0.00994 **
M3:W:M2      2.430e-04  1.035e-04   2.347  0.02569 * 
M4:W:M1      2.259e-04  9.408e-05   2.402  0.02273 * 
M4:W:M2     -2.097e-04  1.159e-04  -1.809  0.08042 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 149.8 on 30 degrees of freedom
Multiple R-squared:  0.8734,    Adjusted R-squared:  0.7974 
F-statistic:  11.5 on 18 and 30 DF,  p-value: 6.152e-09

> model20g<-update(model19g, ~.+M1:M2:M3:M4)
> evaluateModel(model20g)
[1] 12.51357
> model21g<-update(model20g, ~.+I(M4^2))
> evaluateModel(model21g)
[1] 12.44503
> summary(model21g)

Call:
lm(formula = M ~ M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + 
    I(M4^2) + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + M3:W + M3:M1:M2 + 
    M4:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + M3:M4:M1:M2, 
    data = mooseData1, subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
     Min       1Q   Median       3Q      Max 
-214.735  -80.268   -4.229   50.973  296.216 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -2.797e+03  3.031e+03  -0.923   0.3640  
M3           7.923e+00  4.838e+00   1.638   0.1127  
M4           3.528e+00  1.721e+00   2.050   0.0498 *
W            1.155e+02  9.177e+01   1.259   0.2184  
I(M1^2)     -2.357e-04  7.889e-04  -0.299   0.7673  
I(M2^2)     -4.309e-04  1.112e-03  -0.387   0.7015  
I(M3^2)     -4.596e-04  1.424e-03  -0.323   0.7493  
I(M4^2)      1.803e-04  1.209e-03   0.149   0.8825  
M1:M2        4.391e-03  2.125e-03   2.066   0.0482 *
M3:M2       -4.781e-03  3.299e-03  -1.449   0.1584  
M4:M1       -4.605e-04  1.238e-03  -0.372   0.7128  
M3:M4       -5.928e-03  3.265e-03  -1.815   0.0802 .
W:M1        -1.618e-01  6.497e-02  -2.490   0.0190 *
M3:W        -2.307e-01  1.238e-01  -1.863   0.0730 .
M3:M1:M2    -1.409e-06  1.339e-06  -1.052   0.3019  
M4:M1:M2    -2.614e-06  1.141e-06  -2.291   0.0297 *
M3:M4:M2     4.402e-06  2.174e-06   2.025   0.0525 .
M3:W:M2      2.388e-04  1.078e-04   2.216   0.0350 *
M4:W:M1      2.261e-04  9.762e-05   2.316   0.0281 *
M4:W:M2     -2.086e-04  1.198e-04  -1.742   0.0925 .
M3:M4:M1:M2  2.761e-10  8.856e-10   0.312   0.7575  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 154.8 on 28 degrees of freedom
Multiple R-squared:  0.8738,    Adjusted R-squared:  0.7837 
F-statistic: 9.697 on 20 and 28 DF,  p-value: 6.869e-08

> #Adding values does not increase accuracy
> model22g<-update(model21g, ~.-M4:M1:M2)
> evaluateModel(model22g)
[1] 11.65937
> #removing values does not increase accuracy
> summary(model22g)

Call:
lm(formula = M ~ M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + 
    I(M4^2) + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + M3:W + M3:M1:M2 + 
    M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + M3:M4:M1:M2, data = mooseData1, 
    subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
    Min      1Q  Median      3Q     Max 
-235.88  -79.99  -10.25   55.70  296.59 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept)  1.348e+03  2.605e+03   0.517    0.609
M3           8.513e-01  3.990e+00   0.213    0.833
M4           2.604e+00  1.791e+00   1.454    0.157
W           -1.410e+01  7.736e+01  -0.182    0.857
I(M1^2)      2.175e-04  8.178e-04   0.266    0.792
I(M2^2)     -6.040e-04  1.188e-03  -0.508    0.615
I(M3^2)     -9.517e-06  1.510e-03  -0.006    0.995
I(M4^2)     -6.342e-04  1.237e-03  -0.513    0.612
M1:M2        1.619e-03  1.871e-03   0.866    0.394
M3:M2       -1.537e-03  3.190e-03  -0.482    0.634
M4:M1       -1.518e-03  1.231e-03  -1.233    0.227
M3:M4       -1.493e-03  2.816e-03  -0.530    0.600
W:M1        -7.204e-02  5.550e-02  -1.298    0.205
M3:W        -8.456e-02  1.137e-01  -0.744    0.463
M3:M1:M2    -8.903e-07  1.414e-06  -0.630    0.534
M3:M4:M2     1.735e-06  1.966e-06   0.883    0.385
M3:W:M2      1.542e-04  1.084e-04   1.422    0.166
M4:W:M1      1.257e-04  9.340e-05   1.345    0.189
M4:W:M2     -1.303e-04  1.229e-04  -1.060    0.298
M3:M4:M1:M2 -9.814e-11  9.321e-10  -0.105    0.917

Residual standard error: 165.7 on 29 degrees of freedom
Multiple R-squared:  0.8502,    Adjusted R-squared:  0.752 
F-statistic: 8.661 on 19 and 29 DF,  p-value: 1.999e-07

> model23g<-update(model22g, ~.+M1:M3:M4)
> evaluateModel(model23g)
[1] 11.21828
> model24g<-update(model23g, ~.+M1:M3:W)
> evaluateModel(model24g)
[1] 10.64241
> #adding values does not increase accuracy
> summary(model24g)

Call:
lm(formula = M ~ M3 + M4 + W + I(M1^2) + I(M2^2) + I(M3^2) + 
    I(M4^2) + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + M3:W + M3:M1:M2 + 
    M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + M3:M4:M1 + M3:W:M1 + 
    M3:M4:M1:M2, data = mooseData1, subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
     Min       1Q   Median       3Q      Max 
-231.861  -92.799    8.914   76.567  284.290 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -1.515e+03  3.306e+03  -0.458   0.6505  
M3           7.069e+00  6.067e+00   1.165   0.2541  
M4           6.702e+00  3.458e+00   1.938   0.0631 .
W            2.490e+01  8.469e+01   0.294   0.7710  
I(M1^2)     -5.991e-05  8.433e-04  -0.071   0.9439  
I(M2^2)     -7.781e-04  1.198e-03  -0.650   0.5215  
I(M3^2)     -7.055e-04  1.647e-03  -0.428   0.6717  
I(M4^2)     -4.046e-04  1.301e-03  -0.311   0.7582  
M1:M2        3.300e-03  2.228e-03   1.481   0.1502  
M3:M2       -6.011e-03  4.781e-03  -1.257   0.2194  
M4:M1       -5.153e-03  2.866e-03  -1.798   0.0834 .
M3:M4       -7.847e-03  5.390e-03  -1.456   0.1569  
W:M1        -7.057e-02  6.498e-02  -1.086   0.2871  
M3:W        -1.701e-01  1.297e-01  -1.312   0.2005  
M3:M1:M2    -2.363e-07  1.702e-06  -0.139   0.8906  
M3:M4:M2     5.786e-06  3.512e-06   1.648   0.1110  
M3:W:M2      3.338e-04  1.825e-04   1.829   0.0784 .
M4:W:M1      2.643e-04  1.498e-04   1.764   0.0890 .
M4:W:M2     -2.899e-04  1.700e-04  -1.705   0.0997 .
M3:M4:M1     3.568e-06  2.545e-06   1.402   0.1723  
M3:W:M1     -1.204e-04  1.587e-04  -0.759   0.4546  
M3:M4:M1:M2 -2.013e-09  1.680e-09  -1.198   0.2414  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 165.8 on 27 degrees of freedom
Multiple R-squared:  0.8604,    Adjusted R-squared:  0.7518 
F-statistic: 7.925 on 21 and 27 DF,  p-value: 7.546e-07

> model25g<-update(model24g, ~.-I(M4^2))
> evaluateModel(model25g)
[1] 10.39001
> model26g<-update(model25g, ~.-I(M2^2))
> evaluateModel(model26g)
[1] 10.33556
> model27g<-update(model26g, ~.-I(M1^2))
> evaluateModel(model27g)
[1] 9.903901
> summary(model27g) #most accurate predicting model

Call:
lm(formula = M ~ M3 + M4 + W + I(M3^2) + M1:M2 + M3:M2 + M4:M1 + 
    M3:M4 + W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + 
    M4:W:M2 + M3:M4:M1 + M3:W:M1 + M3:M4:M1:M2, data = mooseData1, 
    subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
    Min      1Q  Median      3Q     Max 
-223.71  -90.23   15.67   59.22  324.67 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -1.519e+03  2.958e+03  -0.513   0.6114  
M3           8.028e+00  5.220e+00   1.538   0.1345  
M4           6.449e+00  3.216e+00   2.005   0.0540 .
W            2.064e+01  7.971e+01   0.259   0.7975  
I(M3^2)     -5.556e-05  1.135e-03  -0.049   0.9613  
M1:M2        2.762e-03  1.329e-03   2.079   0.0463 *
M3:M2       -7.990e-03  3.622e-03  -2.206   0.0352 *
M4:M1       -5.105e-03  2.623e-03  -1.946   0.0610 .
M3:M4       -9.021e-03  4.096e-03  -2.203   0.0354 *
W:M1        -6.482e-02  5.967e-02  -1.086   0.2860  
M3:W        -1.702e-01  1.213e-01  -1.404   0.1707  
M3:M1:M2     2.907e-07  1.416e-06   0.205   0.8387  
M3:M4:M2     6.420e-06  2.940e-06   2.184   0.0369 *
M3:W:M2      3.494e-04  1.689e-04   2.069   0.0473 *
M4:W:M1      2.822e-04  1.393e-04   2.025   0.0518 .
M4:W:M2     -3.033e-04  1.577e-04  -1.924   0.0639 .
M3:M4:M1     3.778e-06  2.330e-06   1.621   0.1155  
M3:W:M1     -1.426e-04  1.435e-04  -0.993   0.3284  
M3:M4:M1:M2 -2.362e-09  1.405e-09  -1.682   0.1030  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 159.2 on 30 degrees of freedom
Multiple R-squared:  0.8569,    Adjusted R-squared:  0.771 
F-statistic: 9.979 on 18 and 30 DF,  p-value: 3.36e-08

> #removing and adding values does not increase accuracy
> model28g<-step(model27g)
Start:  AIC=510.86
M ~ M3 + M4 + W + I(M3^2) + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + 
    M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + 
    M3:M4:M1 + M3:W:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- I(M3^2)      1        61 760743 508.86
- M3:W:M1      1     25024 785706 510.44
<none>                     760682 510.86
- M3:M4:M1:M2  1     71723 832405 513.27
- M4:W:M2      1     93822 854504 514.56
- M4:W:M1      1    104027 864709 515.14
- M3:W:M2      1    108533 869215 515.39

Step:  AIC=508.86
M ~ M3 + M4 + W + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + M3:W + 
    M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + M3:M4:M1 + 
    M3:W:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- M3:W:M1      1     25421 786164 508.47
<none>                     760743 508.86
- M3:M4:M1:M2  1     85474 846217 512.08
- M4:W:M1      1    147273 908016 515.53
- M3:W:M2      1    156099 916842 516.01
- M4:W:M2      1    158364 919107 516.13

Step:  AIC=508.47
M ~ M3 + M4 + W + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + M3:W + 
    M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + M3:M4:M1 + 
    M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
<none>                     786164 508.47
- M3:M4:M1:M2  1     61972 848136 510.19
- M4:W:M2      1    135800 921964 514.28
- M4:W:M1      1    151991 938155 515.13
- M3:W:M2      1    176243 962407 516.38
> summary(model28g)

Call:
lm(formula = M ~ M3 + M4 + W + M1:M2 + M3:M2 + M4:M1 + M3:M4 + 
    W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M4:W:M2 + 
    M3:M4:M1 + M3:M4:M1:M2, data = mooseData1, subset = c(1:20, 
    22:nrow(mooseData1)))

Residuals:
     Min       1Q   Median       3Q      Max 
-218.131 -103.392    8.913   70.744  314.953 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -9.757e+02  2.451e+03  -0.398   0.6932  
M3           5.821e+00  3.356e+00   1.734   0.0925 .
M4           5.572e+00  2.733e+00   2.039   0.0498 *
W            3.215e+01  6.658e+01   0.483   0.6325  
M1:M2        2.512e-03  1.223e-03   2.053   0.0483 *
M3:M2       -5.508e-03  2.327e-03  -2.366   0.0242 *
M4:M1       -3.987e-03  1.896e-03  -2.102   0.0435 *
M3:M4       -7.137e-03  3.160e-03  -2.259   0.0309 *
W:M1        -9.087e-02  4.917e-02  -1.848   0.0739 .
M3:W        -1.652e-01  9.553e-02  -1.730   0.0933 .
M3:M1:M2    -6.184e-07  1.069e-06  -0.578   0.5671  
M3:M4:M2     4.925e-06  2.007e-06   2.453   0.0198 *
M3:W:M2      2.394e-04  8.939e-05   2.678   0.0116 *
M4:W:M1      1.943e-04  7.814e-05   2.487   0.0183 *
M4:W:M2     -2.366e-04  1.006e-04  -2.351   0.0250 *
M3:M4:M1     2.547e-06  1.634e-06   1.559   0.1288  
M3:M4:M1:M2 -1.496e-09  9.417e-10  -1.588   0.1221  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 156.7 on 32 degrees of freedom
Multiple R-squared:  0.8521,    Adjusted R-squared:  0.7781 
F-statistic: 11.52 on 16 and 32 DF,  p-value: 4.513e-09

> evaluateModel(model28g) #stepped
[1] 11.63685
> #adding base values and trying step from 27g
> model29g<-update(model27g,~.+M1+M2)
> model30g<-step(model29g)
Start:  AIC=505.64
M ~ M3 + M4 + W + I(M3^2) + M1 + M2 + M1:M2 + M3:M2 + M4:M1 + 
    M3:M4 + W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + 
    M4:W:M2 + M3:M4:M1 + M3:W:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- M3:W:M1      1       0.0 630242 503.64
- M4:W:M2      1    4608.9 634851 504.00
- M4:W:M1      1    9518.0 639760 504.37
- I(M3^2)      1    9537.9 639780 504.38
- M3:M4:M1:M2  1   11444.5 641686 504.52
<none>                     630242 505.64
- M3:W:M2      1   29480.6 659722 505.88

Step:  AIC=503.64
M ~ M3 + M4 + W + I(M3^2) + M1 + M2 + M1:M2 + M3:M2 + M4:M1 + 
    M3:M4 + W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + 
    M4:W:M2 + M3:M4:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- M4:W:M2      1      6118 636359 502.11
- I(M3^2)      1      9572 639814 502.38
- M4:W:M1      1     14119 644361 502.73
- M3:M4:M1:M2  1     22045 652286 503.32
<none>                     630242 503.64
- M3:W:M2      1     59601 689843 506.07

Step:  AIC=502.11
M ~ M3 + M4 + W + I(M3^2) + M1 + M2 + M1:M2 + M3:M2 + M4:M1 + 
    M3:M4 + W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + 
    M3:M4:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- I(M3^2)      1      5278 641638 500.52
- M4:W:M1      1     16785 653144 501.39
<none>                     636359 502.11
- M3:M4:M1:M2  1     44084 680443 503.40
- M3:W:M2      1    177073 813433 512.14

Step:  AIC=500.52
M ~ M3 + M4 + W + M1 + M2 + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + 
    M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + M3:M4:M1 + 
    M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
- M4:W:M1      1     19026 660663 499.95
<none>                     641638 500.52
- M3:M4:M1:M2  1     40072 681710 501.49
- M3:W:M2      1    188617 830255 511.15

Step:  AIC=499.95
M ~ M3 + M4 + W + M1 + M2 + M1:M2 + M3:M2 + M4:M1 + M3:M4 + W:M1 + 
    M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M3:M4:M1 + M3:M4:M1:M2

              Df Sum of Sq    RSS    AIC
<none>                     660663 499.95
- M3:M4:M1:M2  1     28333 688997 500.01
- W:M1         1     48564 709227 501.43
- M3:W:M2      1    228011 888675 512.48
> evaluateModel(model30g) #highly inaccurate
[1] 20.86162
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~Comparisons Between Branches~~~~~~~~~~~~~~~~
> par(mfrow=c(2,2))
> #Looking at first 4
> plot(model1, main = "Starting Model") #Starting point
Warning messages:
1: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
2: In sqrt(crit * p * (1 - hh)/hh) : NaNs produced
> summary(model31a)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M3:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-276.70 -105.65  -24.06   89.36  373.47 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) 2092.09277  453.79241   4.610 3.59e-05 ***
M1             0.63013    0.14117   4.464 5.74e-05 ***
M2            -0.04916    0.16972  -0.290 0.773500    
M3            -1.37867    0.39646  -3.477 0.001171 ** 
M4            -0.10260    0.14398  -0.713 0.479955    
W            -81.69907   18.94616  -4.312 9.27e-05 ***
M3:W           0.08101    0.02074   3.906 0.000327 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 160.8 on 43 degrees of freedom
Multiple R-squared:  0.8066,    Adjusted R-squared:  0.7796 
F-statistic: 29.89 on 6 and 43 DF,  p-value: 7.99e-14

> plot(model31a, main = "Best Branch A") #Best branch A
> cbind(predict(model31a, pMooseData, interval="predict"),TM)
        fit      lwr      upr   TM
1  849.6973 454.5110 1244.884 1181
2  983.5427 607.1145 1359.971 1343
3 1287.4036 938.4734 1636.334 1073
4 1072.1956 703.9941 1440.397 1110
5  982.8330 598.3459 1367.320 1021
6 1095.1249 725.9067 1464.343 1472
7 1378.3615 992.0735 1764.650 1300
8 1324.4692 952.6094 1696.329 1297
> evaluateModel(model31a)
[1] 14.46154
> summary(model27b)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M1:W + M2:W + 
    M4:W + M1:M2:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-312.328  -85.154   -3.108   41.655  307.345 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.687e+02  1.496e+03  -0.246  0.80663   
M1           3.606e+00  1.370e+00   2.631  0.01211 * 
M2           3.406e+00  1.523e+00   2.237  0.03108 * 
M3          -9.126e-02  1.599e-01  -0.571  0.57144   
M4          -1.708e+00  5.103e-01  -3.346  0.00182 **
W            5.242e+01  5.906e+01   0.888  0.38014   
M1:M2       -3.448e-03  1.203e-03  -2.865  0.00668 **
M1:W        -1.672e-01  6.209e-02  -2.693  0.01038 * 
M2:W        -1.771e-01  6.829e-02  -2.593  0.01331 * 
M4:W         8.844e-02  2.965e-02   2.983  0.00491 **
M1:M2:W      1.941e-04  5.839e-05   3.324  0.00194 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 146 on 39 degrees of freedom
Multiple R-squared:  0.8555,    Adjusted R-squared:  0.8184 
F-statistic: 23.08 on 10 and 39 DF,  p-value: 2.24e-13

> plot(model27b, main = "Best Branch B") #Best branch B
> cbind(predict(model27b, pMooseData, interval="predict"),TM)
        fit      lwr      upr   TM
1  989.6914 627.0804 1352.302 1181
2  786.3576 367.8079 1204.907 1343
3 1034.8883 685.5401 1384.237 1073
4 1210.0914 838.6587 1581.524 1110
5 1141.8583 796.8836 1486.833 1021
6  937.9338 517.4008 1358.467 1472
7 1373.4300 973.0580 1773.802 1300
8 1053.6057 672.8526 1434.359 1297
> evaluateModel(model27b)
[1] 17.84363
> summary(model18c)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M2 + M2:M3 + M1:M4 + 
    M1:W + M2:W + M3:W + M4:W + M1:M2:W)

Residuals:
    Min      1Q  Median      3Q     Max 
-244.72  -79.47  -12.65   68.73  331.50 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.492e+02  1.527e+03   0.163 0.871337    
M1           6.069e+00  1.559e+00   3.892 0.000412 ***
M2           1.967e+00  1.554e+00   1.266 0.213694    
M3          -3.005e+00  1.008e+00  -2.980 0.005133 ** 
M4          -3.214e-01  9.274e-01  -0.347 0.730903    
W            4.249e+01  5.644e+01   0.753 0.456439    
M1:M2       -4.217e-03  1.198e-03  -3.518 0.001196 ** 
M2:M3        1.450e-03  4.913e-04   2.952 0.005528 ** 
M1:M4       -7.699e-04  4.763e-04  -1.616 0.114741    
M1:W        -2.396e-01  6.406e-02  -3.741 0.000637 ***
M2:W        -1.568e-01  6.570e-02  -2.387 0.022382 *  
M3:W         6.668e-02  3.464e-02   1.925 0.062178 .  
M4:W         6.069e-02  3.358e-02   1.808 0.079031 .  
M1:M2:W      2.161e-04  5.564e-05   3.883 0.000423 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 134.7 on 36 degrees of freedom
Multiple R-squared:  0.8864,    Adjusted R-squared:  0.8454 
F-statistic: 21.61 on 13 and 36 DF,  p-value: 3.629e-13

> plot(model18c, main = "Best Branch C") #Best Branch C
> cbind(predict(model18c, pMooseData, interval="predict"),TM)
        fit       lwr      upr   TM
1  799.4591  433.3548 1165.563 1181
2  708.7179  309.6337 1107.802 1343
3 1080.1653  747.6458 1412.685 1073
4 1064.3386  689.5933 1439.084 1110
5  954.0235  597.7587 1310.288 1021
6  996.1641  595.6068 1396.721 1472
7 1562.2692 1159.4535 1965.085 1300
8  952.9857  543.5865 1362.385 1297
> evaluateModel(model18c)
[1] 21.23761
> summary(model20d)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M2:M3 + M2:M4 + M3:M4 + 
    M1:W + M1:M2:M3 + M1:M2:W + M2:M3:W + M1:M4:W + M3:M4:W + 
    M1:M2:M3:M4 + M1:M2:M3:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-204.774  -72.682   -8.948   55.876  285.036 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.087e+03  2.046e+03  -1.020 0.315148    
M1           4.539e+00  9.971e-01   4.552 6.86e-05 ***
M2          -1.056e+00  1.641e+00  -0.644 0.524264    
M3          -8.576e-01  1.131e+00  -0.758 0.453712    
M4           3.636e+00  1.248e+00   2.913 0.006379 ** 
W            6.906e+01  4.460e+01   1.548 0.131052    
M2:M3        6.620e-03  1.503e-03   4.406 0.000105 ***
M2:M4       -2.096e-03  8.879e-04  -2.360 0.024326 *  
M3:M4       -3.411e-03  9.802e-04  -3.480 0.001432 ** 
M1:W        -1.449e-01  4.550e-02  -3.185 0.003159 ** 
M1:M2:M3    -4.762e-06  1.149e-06  -4.143 0.000224 ***
M1:M2:W      9.339e-05  5.248e-05   1.779 0.084380 .  
M2:M3:W     -2.253e-04  7.546e-05  -2.986 0.005296 ** 
M1:M4:W     -1.127e-04  4.363e-05  -2.584 0.014385 *  
M3:M4:W      1.505e-04  4.325e-05   3.481 0.001429 ** 
M1:M2:M3:M4  1.038e-09  3.761e-10   2.761 0.009335 ** 
M1:M2:M3:W   1.502e-07  5.163e-08   2.910 0.006423 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 127.8 on 33 degrees of freedom
Multiple R-squared:  0.9063,    Adjusted R-squared:  0.8609 
F-statistic: 19.95 on 16 and 33 DF,  p-value: 1.65e-12

> plot(model20d, main = "Best Branch D") #End branch D
> cbind(predict(model20d, pMooseData, interval="prediction"),TM)
        fit       lwr      upr   TM
1  883.8093  463.9424 1303.676 1181
2  642.6227  187.1263 1098.119 1343
3 1150.3211  809.6899 1490.952 1073
4 1230.7694  813.5044 1648.034 1110
5  989.0335  624.8828 1353.184 1021
6 1111.4399  709.5561 1513.324 1472
7 1481.5132 1091.4029 1871.624 1300
8 1184.2403  756.0505 1612.430 1297
> evaluateModel(model20d)
[1] 18.21033
> summary(model21f)

Call:
lm(formula = M ~ M1 + M2 + M3 + M4 + W + M1:M3 + M2:M3 + M2:M4 + 
    M1:W + M2:W + M2:M3:M4 + M1:M3:W + M2:M4:W + M3:M4:W)

Residuals:
     Min       1Q   Median       3Q      Max 
-216.130  -76.090   -6.611   58.736  305.238 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -4.019e+03  2.652e+03  -1.516 0.138521    
M1           4.506e+00  1.508e+00   2.989 0.005091 ** 
M2           5.519e+00  2.953e+00   1.869 0.070022 .  
M3           2.177e+00  1.562e+00   1.394 0.172216    
M4           3.752e+00  1.421e+00   2.641 0.012266 *  
W            1.054e+02  6.466e+01   1.630 0.112001    
M1:M3       -4.395e-03  1.242e-03  -3.538 0.001161 ** 
M2:M3       -1.581e-03  1.419e-03  -1.114 0.272750    
M2:M4       -7.134e-03  2.370e-03  -3.010 0.004826 ** 
M1:W        -1.932e-01  5.708e-02  -3.385 0.001771 ** 
M2:W        -1.799e-01  8.281e-02  -2.172 0.036690 *  
M2:M3:M4     2.706e-06  1.021e-06   2.649 0.012024 *  
M1:M3:W      2.218e-04  5.591e-05   3.967 0.000343 ***
M2:M4:W      2.133e-04  7.918e-05   2.694 0.010763 *  
M3:M4:W     -1.836e-04  7.731e-05  -2.374 0.023197 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 138.4 on 35 degrees of freedom
Multiple R-squared:  0.8835,    Adjusted R-squared:  0.8369 
F-statistic: 18.96 on 14 and 35 DF,  p-value: 2.655e-12

> plot(model21f, main = "Best Branch F") #2nd most accurate model
> cbind(predict(model21f, pMooseData, interval="prediction"),TM)
        fit      lwr      upr   TM
1  964.1936 526.0592 1402.328 1181
2  935.0814 454.6705 1415.492 1343
3 1088.4797 731.7547 1445.205 1073
4 1139.3299 754.1603 1524.500 1110
5 1057.0558 644.2883 1469.823 1021
6 1108.4992 674.6400 1542.358 1472
7 1282.8186 870.6948 1694.942 1300
8 1169.8549 716.0226 1623.687 1297
> evaluateModel(model21f)
[1] 11.52087
> summary(model27g)

Call:
lm(formula = M ~ M3 + M4 + W + I(M3^2) + M1:M2 + M3:M2 + M4:M1 + 
    M3:M4 + W:M1 + M3:W + M3:M1:M2 + M3:M4:M2 + M3:W:M2 + M4:W:M1 + 
    M4:W:M2 + M3:M4:M1 + M3:W:M1 + M3:M4:M1:M2, data = mooseData1, 
    subset = c(1:20, 22:nrow(mooseData1)))

Residuals:
    Min      1Q  Median      3Q     Max 
-223.71  -90.23   15.67   59.22  324.67 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -1.519e+03  2.958e+03  -0.513   0.6114  
M3           8.028e+00  5.220e+00   1.538   0.1345  
M4           6.449e+00  3.216e+00   2.005   0.0540 .
W            2.064e+01  7.971e+01   0.259   0.7975  
I(M3^2)     -5.556e-05  1.135e-03  -0.049   0.9613  
M1:M2        2.762e-03  1.329e-03   2.079   0.0463 *
M3:M2       -7.990e-03  3.622e-03  -2.206   0.0352 *
M4:M1       -5.105e-03  2.623e-03  -1.946   0.0610 .
M3:M4       -9.021e-03  4.096e-03  -2.203   0.0354 *
W:M1        -6.482e-02  5.967e-02  -1.086   0.2860  
M3:W        -1.702e-01  1.213e-01  -1.404   0.1707  
M3:M1:M2     2.907e-07  1.416e-06   0.205   0.8387  
M3:M4:M2     6.420e-06  2.940e-06   2.184   0.0369 *
M3:W:M2      3.494e-04  1.689e-04   2.069   0.0473 *
M4:W:M1      2.822e-04  1.393e-04   2.025   0.0518 .
M4:W:M2     -3.033e-04  1.577e-04  -1.924   0.0639 .
M3:M4:M1     3.778e-06  2.330e-06   1.621   0.1155  
M3:W:M1     -1.426e-04  1.435e-04  -0.993   0.3284  
M3:M4:M1:M2 -2.362e-09  1.405e-09  -1.682   0.1030  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 159.2 on 30 degrees of freedom
Multiple R-squared:  0.8569,    Adjusted R-squared:  0.771 
F-statistic: 9.979 on 18 and 30 DF,  p-value: 3.36e-08

> plot(model27g, main="Best Branch G") #most accurate model
> cbind(predict(model27g, pMooseData, interval="prediction"),TM)
        fit      lwr      upr   TM
1  928.0964 441.7144 1414.478 1181
2  962.3696 421.2222 1503.517 1343
3 1188.5486 747.1041 1629.993 1073
4 1150.6660 632.3347 1668.997 1110
5 1105.1221 628.6357 1581.608 1021
6 1427.3133 794.8074 2059.819 1472
7 1293.3696 708.9221 1877.817 1300
8 1254.7475 710.4027 1799.092 1297
> evaluateModel(model27g)
[1] 9.903901
> summary(treeModel)
Call:
rpart(formula = M ~ M1 + M2 + M3 + M4 + W, data = mooseData1)
  n= 50 

          CP nsplit rel error    xerror      xstd
1 0.64334747      0 1.0000000 1.0658596 0.1476987
2 0.11953330      1 0.3566525 0.5697500 0.1356667
3 0.02607126      2 0.2371192 0.4575037 0.1288592
4 0.01000000      3 0.2110480 0.4536590 0.1331513

Variable importance
 W M1 M3 M4 M2 
22 22 20 18 18 

Node number 1: 50 observations,    complexity param=0.6433475
  mean=1079.3, MSE=115024.8 
  left son=2 (16 obs) right son=3 (34 obs)
  Primary splits:
      W  < 23.5   to the right, improve=0.6433475, (0 missing)
      M1 < 1000.5 to the left,  improve=0.6366829, (0 missing)
      M4 < 773    to the left,  improve=0.5796888, (0 missing)
      M2 < 935    to the left,  improve=0.5774694, (0 missing)
      M3 < 773    to the left,  improve=0.5712652, (0 missing)
  Surrogate splits:
      M3 < 773    to the left,  agree=0.96, adj=0.875, (0 split)
      M1 < 801    to the left,  agree=0.94, adj=0.812, (0 split)
      M4 < 687.5  to the left,  agree=0.94, adj=0.812, (0 split)
      M2 < 801    to the left,  agree=0.92, adj=0.750, (0 split)

Node number 2: 16 observations
  mean=682.75, MSE=15475.56 

Node number 3: 34 observations,    complexity param=0.1195333
  mean=1265.912, MSE=53046.61 
  left son=6 (24 obs) right son=7 (10 obs)
  Primary splits:
      M1 < 1384   to the left,  improve=0.38116560, (0 missing)
      M4 < 1317.5 to the right, improve=0.11826490, (0 missing)
      M2 < 1066   to the left,  improve=0.09048218, (0 missing)
      W  < 15.5   to the left,  improve=0.06636598, (0 missing)
      M3 < 1309.5 to the right, improve=0.05455563, (0 missing)
  Surrogate splits:
      M2 < 1468   to the left,  agree=0.794, adj=0.3, (0 split)
      M3 < 1682   to the left,  agree=0.765, adj=0.2, (0 split)

Node number 6: 24 observations,    complexity param=0.02607126
  mean=1174.125, MSE=36419.53 
  left son=12 (12 obs) right son=13 (12 obs)
  Primary splits:
      M4 < 1213   to the right, improve=0.17154490, (0 missing)
      M1 < 1023   to the left,  improve=0.08137834, (0 missing)
      M3 < 1291.5 to the right, improve=0.07846753, (0 missing)
      W  < 15.5   to the left,  improve=0.04983676, (0 missing)
      M2 < 1255.5 to the left,  improve=0.03317614, (0 missing)
  Surrogate splits:
      M3 < 965    to the right, agree=0.750, adj=0.500, (0 split)
      M2 < 1135   to the right, agree=0.708, adj=0.417, (0 split)
      W  < 16.5   to the left,  agree=0.708, adj=0.417, (0 split)
      M1 < 847.5  to the right, agree=0.583, adj=0.167, (0 split)

Node number 7: 10 observations
  mean=1486.2, MSE=24205.16 

Node number 12: 12 observations
  mean=1095.083, MSE=11433.24 

Node number 13: 12 observations
  mean=1253.167, MSE=48910.64 

> par(mfrow = c(1, 1)) #return plot layout to default
> rpart.plot(treeModel, main="Recursive Tree Model") #best branch E
> cbind(predict(treeModel, pMooseData, interval="prediction"), TM)
             TM
1 1095.083 1181
2 1095.083 1343
3 1095.083 1073
4 1253.167 1110
5 1253.167 1021
6 1095.083 1472
7 1486.200 1300
8 1253.167 1297
> evaluateModel(treeModel)
[1] 13.3423
> par(mfrow=c(2,2))
> pairs(mooseData1,panel=panel.smooth)
> library(tree)
> model =tree(M~.,data=mooseData1)
> par(mfrow=c(1,1))
> plot(model, main="Tree Model")
> text(model)
> cbind(predict(model, pMooseData),TM)
             TM
1 1151.000 1181
2 1151.000 1343
3 1151.000 1073
4 1329.143 1110
5 1151.000 1021
6 1151.000 1472
7 1486.200 1300
8 1329.143 1297
> evaluateModel(model)
[1] 11.89869
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #~~~~~~~~~~~~~~~~~~Accuracy of Models~~~~~~~~~~~~~~~~~~~~
> 
> evaluateModel(model)
[1] 11.89869
> evaluateModel(model1)
[1] 33.75435
> evaluateModel(model31a)
[1] 14.46154
> evaluateModel(model27b)
[1] 17.84363
> evaluateModel(model18c)
[1] 21.23761
> evaluateModel(model10d)
[1] 28.82661
> evaluateModel(model20d)
[1] 18.21033
> evaluateModel(model24f)
[1] 11.36426
> evaluateModel(model25f)
[1] 11.52087
> evaluateModel(treeModel)
[1] 13.3423
> 
